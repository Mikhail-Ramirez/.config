/*
 RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/domReady for details

 lodash 4.5.1 (Custom Build) lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
 Build: `lodash -o ./dist/lodash.js`
 MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors */
define("third_party/domready/domReady",[],function(){function f(){if(!q){q=!0;l&&clearInterval(l);var a=m;if(q&&a.length){m=[];var c;for(c=0;c<a.length;c+=1)a[c](t)}}}function c(a){q?a(t):m.push(a);return c}var h,a,l,n="undefined"!==typeof window&&window.document,q=!n,t=n?document:null,m=[];if(n){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f);a=document.createElement("div");
try{h=null===window.frameElement}catch(v){}a.doScroll&&h&&window.external&&(l=setInterval(function(){try{a.doScroll(),f()}catch(c){}},30))}"complete"===document.readyState&&f()}c.version="2.0.1";c.load=function(a,f,m,h){h.isBuild?m(null):c(m)};return c});
(function(){function f(c){var f=null;if(this.id===c)return this;if(this.hasChildNodes())for(var a=0,l=this.childNodes.length;a<l&&(this.childNodes[a].nodeType!==Node.ELEMENT_NODE||!(f=this.childNodes[a].getElementById(c))||f.id!==c);a++);return f}Element.prototype.clear=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);return this};Element.prototype.removeElm=function(){return this.parentNode?(this.parentNode.removeChild(this),this):null};Function.prototype.bake=
function(c){var f=this,a=[].slice.call(arguments,1);return function(){return f.apply(c,a.concat([].slice.call(arguments,0)))}};Element.prototype.getElementById=f;DocumentFragment.prototype.getElementById=f})();define("qowtRoot/lib/framework/framework",function(){});
(function(){function f(e,g){return e.set(g[0],g[1]),e}function c(e,g){return e.add(g),e}function h(e,g,a){switch(a.length){case 0:return e.call(g);case 1:return e.call(g,a[0]);case 2:return e.call(g,a[0],a[1]);case 3:return e.call(g,a[0],a[1],a[2])}return e.apply(g,a)}function a(e,g,a,c){for(var f=-1,m=e.length;++f<m;){var h=e[f];g(c,h,a(h),e)}return c}function l(e,g){for(var a=-1,c=e.length;++a<c&&!1!==g(e[a],a,e););return e}function n(e,g){for(var a=-1,c=e.length;++a<c;)if(!g(e[a],a,e))return!1;
return!0}function q(e,g){for(var a=-1,c=e.length,f=-1,m=[];++a<c;){var h=e[a];g(h,a,e)&&(m[++f]=h)}return m}function t(e,g){return!!e.length&&-1<B(e,g,0)}function m(e,g,a){for(var c=-1,f=e.length;++c<f;)if(a(g,e[c]))return!0;return!1}function v(e,g){for(var a=-1,c=e.length,f=Array(c);++a<c;)f[a]=g(e[a],a,e);return f}function r(e,g){for(var a=-1,c=g.length,f=e.length;++a<c;)e[f+a]=g[a];return e}function w(e,g,a,c){var f=-1,m=e.length;for(c&&m&&(a=e[++f]);++f<m;)a=g(a,e[f],f,e);return a}function K(e,
g,a,c){var f=e.length;for(c&&f&&(a=e[--f]);f--;)a=g(a,e[f],f,e);return a}function I(e,g){for(var a=-1,c=e.length;++a<c;)if(g(e[a],a,e))return!0;return!1}function D(e,g,a){for(var c=-1,f=e.length;++c<f;){var m=e[c],h=g(m);if(null!=h&&(l===p?h===h:a(h,l)))var l=h,n=m}return n}function x(e,g,a,c){var f;return a(e,function(e,a,m){return g(e,a,m)?(f=c?a:e,!1):void 0}),f}function y(e,g,a){for(var c=e.length,f=a?c:-1;a?f--:++f<c;)if(g(e[f],f,e))return f;return-1}function B(e,g,a){if(g!==g)return ja(e,a);
--a;for(var c=e.length;++a<c;)if(e[a]===g)return a;return-1}function M(e,g,a,c,f){return f(e,function(e,f,m){a=c?(c=!1,e):g(a,e,f,m)}),a}function fa(e,g){var a=e.length;for(e.sort(g);a--;)e[a]=e[a].c;return e}function X(e,g){for(var a,c=-1,f=e.length;++c<f;){var m=g(e[c]);m!==p&&(a=a===p?m:a+m)}return a}function P(e,g){for(var a=-1,c=Array(e);++a<e;)c[a]=g(a);return c}function N(e,g){return v(g,function(g){return[g,e[g]]})}function Z(e){return function(g){return e(g)}}function T(e,g){return v(g,function(g){return e[g]})}
function R(e,g){for(var a=-1,c=e.length;++a<c&&-1<B(g,e[a],0););return a}function H(e,g){for(var a=e.length;a--&&-1<B(g,e[a],0););return a}function U(e){return e&&e.Object===Object?e:null}function pa(e,g){if(e!==g){var a=null===e,c=e===p,f=e===e,m=null===g,h=g===p,l=g===g;if(e>g&&!m||!f||a&&!h&&l||c&&l)return 1;if(g>e&&!a||!l||m&&!c&&f||h&&f)return-1}return 0}function Q(e){return Ta[e]}function Ka(e){return ya[e]}function e(e){return"\\"+Za[e]}function ja(e,g,a){var c=e.length;for(g+=a?0:-1;a?g--:
++g<c;){var f=e[g];if(f!==f)return g}return-1}function qa(e){var g=!1;if(null!=e&&"function"!=typeof e.toString)try{g=!!(e+"")}catch(a){}return g}function za(e,g){return e="number"==typeof e||Bb.test(e)?+e:-1,-1<e&&0==e%1&&(null==g?9007199254740991:g)>e}function kb(e){for(var g,a=[];!(g=e.next()).done;)a.push(g.value);return a}function Ua(e){var g=-1,a=Array(e.size);return e.forEach(function(e,c){a[++g]=[c,e]}),a}function Fa(e,g){for(var a=-1,c=e.length,f=-1,m=[];++a<c;){var h=e[a];(h===g||"__lodash_placeholder__"===
h)&&(e[a]="__lodash_placeholder__",m[++f]=a)}return m}function lb(e){var g=-1,a=Array(e.size);return e.forEach(function(e){a[++g]=e}),a}function $a(e){if(!e||!Va.test(e))return e.length;for(var g=na.lastIndex=0;na.test(e);)g++;return g}function pc(e){return ba[e]}function Cb(L){function g(b){if(ca(b)&&!E(b)&&!(b instanceof F)){if(b instanceof ra)return b;if(aa.call(b,"__wrapped__"))return wd(b)}return new ra(b)}function U(){}function ra(b,d){this.__wrapped__=b;this.__actions__=[];this.__chain__=!!d;
this.__index__=0;this.__values__=p}function F(b){this.__wrapped__=b;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function W(){}function Sa(b){var d=-1,k=b?b.length:0;for(this.clear();++d<k;){var e=b[d];this.set(e[0],e[1])}}function Y(b){var d=-1,k=b?b.length:0;for(this.__data__=new Sa;++d<k;)this.push(b[d])}function ea(b,d){var k=b.__data__;return mb(d)?(k=k.__data__,"__lodash_hash_undefined__"===("string"==typeof d?
k.string:k.hash)[d]):k.has(d)}function ba(b){var d=-1,k=b?b.length:0;for(this.clear();++d<k;){var e=b[d];this.set(e[0],e[1])}}function xa(b,d){var k=ya(b,d);return 0>k?!1:(k==b.length-1?b.pop():Rb.call(b,k,1),!0)}function Ta(b,d){var k=ya(b,d);return 0>k?p:b[k][1]}function ya(b,d){for(var k=b.length;k--;)if(La(b[k][0],d))return k;return-1}function Ya(b,d,k){var e=ya(b,d);0>e?b.push([d,k]):b[e][1]=k}function Ra(b,d,k,e){return b===p||La(b,nb[k])&&!aa.call(e,k)?d:b}function Za(b,d,k){(k===p||La(b[d],
k))&&("number"!=typeof d||k!==p||d in b)||(b[d]=k)}function Sb(b,d,k){var e=b[d];aa.call(b,d)&&La(e,k)&&(k!==p||d in b)||(b[d]=k)}function Bb(b,d,k,e){return Ma(b,function(b,g,a){d(e,b,k(b),a)}),e}function xd(b,d){return b&&Db(d,ia(d),b)}function qc(b,d){for(var k=-1,e=null==b,g=d.length,a=Array(g);++k<g;)a[k]=e?p:Eb(b,d[k]);return a}function rc(b){return da(b)?b:[]}function ab(b){return"function"==typeof b?b:Aa}function bb(b){return E(b)?b:yd(b)}function ob(b,d,k){return b===b&&(k!==p&&(b=b>k?k:
b),d!==p&&(b=d>b?d:b)),b}function Ba(b,d,k,e,g,a){var c;if(k&&(c=g?k(b,e,g,a):k(b)),c!==p)return c;if(!V(b))return b;if(e=E(b)){if(c=Xe(b),!d)return ka(b,c)}else{var f=Ca(b),m="[object Function]"==f||"[object GeneratorFunction]"==f;if(zd(b))return Ye(b,d);if("[object Object]"==f||"[object Arguments]"==f||m&&!g){if(qa(b))return g?b:{};if(c=Ze(m?{}:b),!d)return Ad(b,xd(c,b))}else{if(!O[f])return g?b:{};c=$e(b,f,d)}}return a||(a=new ba),(g=a.get(b))?g:(a.set(b,c),(e?l:Da)(b,function(e,g){Sb(c,g,Ba(e,
d,k,g,b,a))}),e?c:Ad(b,c))}function af(b){var d=ia(b),k=d.length;return function(e){if(null==e)return!k;for(var g=k;g--;){var a=d[g],c=b[a],f=e[a];if(f===p&&!(a in Object(e))||!c(f))return!1}return!0}}function pb(b){return V(b)?bf(b):{}}function Bd(b,d,k){if("function"!=typeof b)throw new sa("Expected a function");return Tb(function(){b.apply(p,k)},d)}function cb(b,d,k,e){var g=-1,a=t,c=!0,f=b.length,h=[],l=d.length;if(!f)return h;k&&(d=v(d,Z(k)));e?(a=m,c=!1):200<=d.length&&(a=ea,c=!1,d=new Y(d));
a:for(;++g<f;){var n=b[g],u=k?k(n):n;if(c&&u===u){for(var q=l;q--;)if(d[q]===u)continue a;h.push(n)}else a(d,u,e)||h.push(n)}return h}function cf(b,d){var k=!0;return Ma(b,function(b,e,g){return k=!!d(b,e,g)}),k}function Cd(b,d){var k=[];return Ma(b,function(b,e,g){d(b,e,g)&&k.push(b)}),k}function S(b,d,k,e){e||(e=[]);for(var g=-1,a=b.length;++g<a;){var c=b[g];0<d&&da(c)&&(k||E(c)||db(c))?1<d?S(c,d-1,k,e):r(e,c):k||(e[e.length]=c)}return e}function df(b,d){return null==b?b:sc(b,d,ta)}function Da(b,
d){return b&&sc(b,d,ia)}function tc(b,d){return b&&Dd(b,d,ia)}function Ub(b,d){return q(d,function(d){return ua(b[d])})}function uc(b,d){d=Na(d,b)?[d+""]:bb(d);for(var k=0,e=d.length;null!=b&&e>k;)b=b[d[k++]];return k&&k==e?b:p}function vc(b,d){return aa.call(b,d)||"object"==typeof b&&d in b&&null===Vb(b)}function ef(b,d){return d in Object(b)}function wc(b,d,k){for(var e=k?m:t,g=b.length,a=g,c=Array(g),f=[];a--;){var h=b[a];a&&d&&(h=v(h,Z(d)));c[a]=k||!d&&120>h.length?p:new Y(a&&h)}var h=b[0],l=
-1,n=h.length,u=c[0];a:for(;++l<n;){var q=h[l],r=d?d(q):q;if(u?!ea(u,r):!e(f,r,k)){for(a=g;--a;){var w=c[a];if(w?!ea(w,r):!e(b[a],r,k))continue a}u&&u.push(r);f.push(q)}}return f}function ff(b,d,k,e){return Da(b,function(b,g,a){d(e,k(b),g,a)}),e}function Fb(b,d,k){return Na(d,b)||(d=bb(d),b=Gb(b,d),d=la(d)),d=null==b?b:b[d],null==d?p:h(d,b,k)}function eb(b,d,k,e,g){if(b===d)return!0;if(null==b||null==d||!V(b)&&!ca(d))return b!==b&&d!==d;var a=E(b),c=E(d),f="[object Array]",m="[object Array]";a||(f=
Ca(b),"[object Arguments]"==f?f="[object Object]":"[object Object]"!=f&&(a=qb(b)));c||(m=Ca(d),"[object Arguments]"==m?m="[object Object]":"[object Object]"!=m&&qb(d));var h="[object Object]"==f&&!qa(b),c="[object Object]"==m&&!qa(d),m=f==m;!m||a||h?2&e||(f=h&&aa.call(b,"__wrapped__"),c=c&&aa.call(d,"__wrapped__"),!f&&!c)?m?(g||(g=new ba),b=(a?gf:hf)(b,d,eb,k,e,g)):b=!1:b=eb(f?b.value():b,c?d.value():d,k,e,g):b=jf(b,d,f,eb,k,e);return b}function xc(b,d,k,e){var g=k.length,a=g,c=!e;if(null==b)return!a;
for(b=Object(b);g--;){var f=k[g];if(c&&f[2]?f[1]!==b[f[0]]:!(f[0]in b))return!1}for(;++g<a;){var f=k[g],m=f[0],h=b[m],l=f[1];if(c&&f[2]){if(h===p&&!(m in b))return!1}else if(f=new ba,m=e?e(h,l,m,b,d,f):p,m===p?!eb(l,h,e,3,f):!m)return!1}return!0}function Ed(b){var d=typeof b;return"function"==d?b:null==b?Aa:"object"==d?E(b)?Fd(b[0],b[1]):Gd(b):Hd(b)}function Id(b){b=null==b?b:Object(b);var d,k=[];for(d in b)k.push(d);return k}function Jd(b,d){var k=-1,e=va(b)?Array(b.length):[];return Ma(b,function(b,
g,a){e[++k]=d(b,g,a)}),e}function Gd(b){var d=yc(b);if(1==d.length&&d[0][2]){var k=d[0][0],e=d[0][1];return function(b){return null==b?!1:b[k]===e&&(e!==p||k in Object(b))}}return function(k){return k===b||xc(k,b,d)}}function Fd(b,d){return function(k){var e=Eb(k,b);return e===p&&e===d?Kd(k,b):eb(d,e,p,3)}}function Wb(b,d,k,e,g){if(b!==d){var a=E(d)||qb(d)?p:ta(d);l(a||d,function(c,f){if(a&&(f=c,c=d[f]),V(c)){g||(g=new ba);var m=f,h=g,l=b[m],n=d[m],u=h.get(n);if(!u){var u=e?e(l,n,m+"",b,d,h):p,q=
u===p;q&&(u=n,E(n)||qb(n)?E(l)?u=l:da(l)?u=ka(l):(q=!1,u=Ba(n,!0)):zc(n)||db(n)?db(l)?u=Ld(l):!V(l)||k&&ua(l)?(q=!1,u=Ba(n,!0)):u=l:q=!1);h.set(n,u);q&&Wb(u,n,k,e,h)}Za(b,m,u)}else m=e?e(b[f],c,f+"",b,d,g):p,m===p&&(m=c),Za(b,f,m)})}}function Md(b,d,k){var e=-1,g=A();return d=v(d.length?d:Array(1),function(b){return g(b)}),b=Jd(b,function(b,k,g){return{a:v(d,function(d){return d(b)}),b:++e,c:b}}),fa(b,function(b,d){var e;a:{e=-1;for(var g=b.a,a=d.a,We=g.length,c=k.length;++e<We;){var f=pa(g[e],a[e]);
if(f){if(e>=c){e=f;break a}e=f*("desc"==k[e]?-1:1);break a}}e=b.b-d.b}return e})}function Nd(b,d){return b=Object(b),w(d,function(d,e){return e in b&&(d[e]=b[e]),d},{})}function Od(b,d){var k={};return df(b,function(b,e){d(b,e)&&(k[e]=b)}),k}function Ac(b){return function(d){return null==d?p:d[b]}}function kf(b){return function(d){return uc(d,b)}}function Pd(b,d,k){var e=-1,g=d.length,a=b;for(k&&(a=v(b,function(b){return k(b)}));++e<g;)for(var c=0,f=d[e],f=k?k(f):f;-1<(c=B(a,f,c));)a!==b&&Rb.call(a,
c,1),Rb.call(b,c,1);return b}function Qd(b,d){for(var k=b?d.length:0,e=k-1;k--;){var g=d[k];if(e==k||g!=a){var a=g;if(za(g))Rb.call(b,g,1);else if(Na(g,b))delete b[g];else{var g=bb(g),c=Gb(b,g);null!=c&&delete c[la(g)]}}}return b}function Bc(b,d){return b+Xb(Rd()*(d-b+1))}function Cc(b,d,k,e){d=Na(d,b)?[d+""]:bb(d);for(var g=-1,a=d.length,c=a-1,f=b;null!=f&&++g<a;){var m=d[g];if(V(f)){var h=k;if(g!=c){var l=f[m],h=e?e(l,m,f):p;h===p&&(h=null==l?za(d[g+1])?[]:{}:l)}Sb(f,m,h)}f=f[m]}return b}function Oa(b,
d,k){var e=-1,g=b.length;0>d&&(d=-d>g?0:g+d);k=k>g?g:k;0>k&&(k+=g);g=d>k?0:k-d>>>0;d>>>=0;for(k=Array(g);++e<g;)k[e]=b[e+d];return k}function lf(b,d){var k;return Ma(b,function(b,e,g){return k=d(b,e,g),!k}),!!k}function Yb(b,d,k){var e=0,g=b?b.length:e;if("number"==typeof d&&d===d&&2147483647>=g){for(;g>e;){var a=e+g>>>1,c=b[a];(k?d>=c:d>c)&&null!==c?e=a+1:g=a}return g}return Dc(b,d,Aa,k)}function Dc(b,d,k,e){d=k(d);for(var g=0,a=b?b.length:0,c=d!==d,f=null===d,m=d===p;a>g;){var h=Xb((g+a)/2),l=k(b[h]),
n=l!==p,u=l===l;(c?u||e:f?u&&n&&(e||null!=l):m?u&&(e||n):null==l?0:e?d>=l:d>l)?g=h+1:a=h}return wa(a,4294967294)}function Sd(b,d){for(var k=0,e=b.length,g=b[0],a=d?d(g):g,c=a,f=0,m=[g];++k<e;)g=b[k],a=d?d(g):g,La(a,c)||(c=a,m[++f]=g);return m}function fb(b,d,k){var e=-1,g=t,a=b.length,c=!0,f=[],h=f;if(k)c=!1,g=m;else if(200>a)h=d?[]:f;else{if(g=d?null:mf(b))return lb(g);c=!1;g=ea;h=new Y}a:for(;++e<a;){var l=b[e],n=d?d(l):l;if(c&&n===n){for(var u=h.length;u--;)if(h[u]===n)continue a;d&&h.push(n);
f.push(l)}else g(h,n,k)||(h!==f&&h.push(n),f.push(l))}return f}function Zb(b,d,k,e){for(var g=b.length,a=e?g:-1;(e?a--:++a<g)&&d(b[a],a,b););return k?Oa(b,e?0:a,e?a+1:g):Oa(b,e?a+1:0,e?g:a)}function Td(b,d){var k=b;return k instanceof F&&(k=k.value()),w(d,function(b,d){return d.func.apply(d.thisArg,r([b],d.args))},k)}function Ec(b,d,k){for(var e=-1,g=b.length;++e<g;)var a=a?r(cb(a,b[e],d,k),cb(b[e],a,d,k)):b[e];return a&&a.length?fb(a,d,k):[]}function Ud(b,d,k){for(var e=-1,g=b.length,a=d.length,
c={};++e<g;)k(c,b[e],a>e?d[e]:p);return c}function Ye(b,d){if(d)return b.slice();var k=new b.constructor(b.length);return b.copy(k),k}function Vd(b){var d=new b.constructor(b.byteLength);return(new $b(d)).set(new $b(b)),d}function Wd(b,d,k,e){var g=-1,a=b.length,c=k.length,f=-1,m=d.length,h=ga(a-c,0),l=Array(m+h);for(e=!e;++f<m;)l[f]=d[f];for(;++g<c;)(e||a>g)&&(l[k[g]]=b[g]);for(;h--;)l[f++]=b[g++];return l}function Xd(b,d,k,e){var g=-1,a=b.length,c=-1,f=k.length,m=-1,h=d.length,l=ga(a-f,0),n=Array(l+
h);for(e=!e;++g<l;)n[g]=b[g];for(l=g;++m<h;)n[l+m]=d[m];for(;++c<f;)(e||a>g)&&(n[l+k[c]]=b[g++]);return n}function ka(b,d){var k=-1,e=b.length;for(d||(d=Array(e));++k<e;)d[k]=b[k];return d}function Db(b,d,k){return Fc(b,d,k)}function Fc(b,d,k,e){k||(k={});for(var g=-1,a=d.length;++g<a;){var c=d[g],f=e?e(k[c],b[c],c,k,b):b[c];Sb(k,c,f)}return k}function Ad(b,d){return Db(b,nf(b),d)}function ac(b,d){return function(k,e){var g=E(k)?a:Bb,c=d?d():{};return g(k,b,A(e),c)}}function rb(b){return z(function(d,
k){var e=-1,g=k.length,a=1<g?k[g-1]:p,c=2<g?k[2]:p,a="function"==typeof a?(g--,a):p;c&&Ga(k[0],k[1],c)&&(a=3>g?p:a,g=1);for(d=Object(d);++e<g;)(c=k[e])&&b(d,c,e,a);return d})}function Yd(b,d){return function(k,e){if(null==k)return k;if(!va(k))return b(k,e);for(var g=k.length,a=d?g:-1,c=Object(k);(d?a--:++a<g)&&!1!==e(c[a],a,c););return k}}function Zd(b){return function(d,k,e){var g=-1,a=Object(d);e=e(d);for(var c=e.length;c--;){var f=e[b?c:++g];if(!1===k(a[f],f,a))break}return d}}function of(b,d,
k){function e(){return(this&&this!==oa&&this instanceof e?a:b).apply(g?k:this,arguments)}var g=1&d,a=Hb(b);return e}function $d(b){return function(d){d=J(d);var k=Va.test(d)?d.match(na):p,e=k?k[0]:d.charAt(0);return d=k?k.slice(1).join(""):d.slice(1),e[b]()+d}}function sb(b){return function(d){return w(ae(be(d)),b,"")}}function Hb(b){return function(){var d=arguments;switch(d.length){case 0:return new b;case 1:return new b(d[0]);case 2:return new b(d[0],d[1]);case 3:return new b(d[0],d[1],d[2]);case 4:return new b(d[0],
d[1],d[2],d[3]);case 5:return new b(d[0],d[1],d[2],d[3],d[4]);case 6:return new b(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new b(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var k=pb(b.prototype),d=b.apply(k,d);return V(d)?d:k}}function pf(b,d,k){function e(){for(var a=arguments.length,c=Array(a),f=a,m=tb(e);f--;)c[f]=arguments[f];return f=3>a&&c[0]!==m&&c[a-1]!==m?[]:Fa(c,m),a-=f.length,k>a?ce(b,d,bc,e.placeholder,p,c,f,p,p,k-a):h(this&&this!==oa&&this instanceof e?g:b,this,c)}var g=Hb(b);return e}function de(b){return z(function(d){d=
S(d,1);var k=d.length,e=k,g=ra.prototype.thru;for(b&&d.reverse();e--;){var a=d[e];if("function"!=typeof a)throw new sa("Expected a function");if(g&&!c&&"wrapper"==cc(a))var c=new ra([],!0)}for(e=c?e:k;++e<k;)var a=d[e],g=cc(a),f="wrapper"==g?Gc(a):p,c=f&&Hc(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?c[cc(f[0])].apply(c,f[3]):1==a.length&&Hc(a)?c[g]():c.thru(a);return function(){var b=arguments,e=b[0];if(c&&1==b.length&&E(e)&&200<=e.length)return c.plant(e).value();for(var g=0,b=k?d[g].apply(this,b):
e;++g<k;)b=d[g].call(this,b);return b}})}function bc(b,d,k,e,g,a,c,f,m,h){function l(){for(var w=arguments.length,ja=w,H=Array(w);ja--;)H[ja]=arguments[ja];if(r){var L,M=tb(l),ja=H.length;for(L=0;ja--;)H[ja]===M&&L++}if(e&&(H=Wd(H,e,g,r)),a&&(H=Xd(H,a,c,r)),w-=L,r&&h>w)return M=Fa(H,M),ce(b,d,bc,l.placeholder,k,H,M,f,m,h-w);if(M=u?k:this,ja=q?M[b]:b,w=H.length,f){L=H.length;for(var B=wa(f.length,L),qa=ka(H);B--;){var P=f[B];H[B]=za(P,L)?qa[P]:p}}else v&&1<w&&H.reverse();return n&&w>m&&(H.length=m),
this&&this!==oa&&this instanceof l&&(ja=t||Hb(ja)),ja.apply(M,H)}var n=128&d,u=1&d,q=2&d,r=24&d,v=512&d,t=q?p:Hb(b);return l}function ee(b,d){return function(k,e){return ff(k,b,d(e),{})}}function Ic(b){return z(function(d){return d=v(S(d,1),A()),z(function(k){var e=this;return b(d,function(b){return h(b,e,k)})})})}function dc(b,d,k){return d=G(d),b=$a(b),d&&d>b?(d-=b,k=k===p?" ":k+"",b=fe(k,ec(d/$a(k))),Va.test(k)?b.match(na).slice(0,d).join(""):b.slice(0,d)):""}function qf(b,d,k,e){function g(){for(var d=
-1,f=arguments.length,m=-1,l=e.length,n=Array(l+f),u=this&&this!==oa&&this instanceof g?c:b;++m<l;)n[m]=e[m];for(;f--;)n[m++]=arguments[++d];return h(u,a?k:this,n)}var a=1&d,c=Hb(b);return g}function ge(b){return function(d,k,e){e&&"number"!=typeof e&&Ga(d,k,e)&&(k=e=p);d=ha(d);d=d===d?d:0;k===p?(k=d,d=0):k=ha(k)||0;e=e===p?k>d?1:-1:ha(e)||0;var g=-1;k=ga(ec((k-d)/(e||1)),0);for(var a=Array(k);k--;)a[b?k:++g]=d,d+=e;return a}}function ce(b,d,k,e,g,a,c,f,m,h){var l=8&d;f=f?ka(f):p;var n=l?c:p;c=l?
p:c;var u=l?a:p;return a=l?p:a,d=(d|(l?32:64))&~(l?64:32),4&d||(d&=-4),d=[b,d,g,u,n,a,c,f,m,h],k=k.apply(p,d),Hc(b)&&he(k,d),k.placeholder=e,k}function Jc(b){var d=ub[b];return function(b,e){if(b=ha(b),e=G(e)){var g=(J(b)+"e").split("e"),g=d(g[0]+"e"+(+g[1]+e)),g=(J(g)+"e").split("e");return+(g[0]+"e"+(+g[1]-e))}return d(b)}}function Pa(b,d,k,e,g,a,c,f){var m=2&d;if(!m&&"function"!=typeof b)throw new sa("Expected a function");var h=e?e.length:0;if(h||(d&=-97,e=g=p),c=c===p?c:ga(G(c),0),f=f===p?f:
G(f),h-=g?g.length:0,64&d){var l=e,n=g;e=g=p}var u=m?p:Gc(b);return a=[b,d,k,e,g,l,n,a,c,f],u&&(k=a[1],b=u[1],d=k|b,e=128==b&&8==k||128==b&&256==k&&u[8]>=a[7].length||384==b&&u[8]>=u[7].length&&8==k,131>d||e)&&(1&b&&(a[2]=u[2],d|=1&k?0:4),(k=u[3])&&(e=a[3],a[3]=e?Wd(e,k,u[4]):ka(k),a[4]=e?Fa(a[3],"__lodash_placeholder__"):ka(u[4])),(k=u[5])&&(e=a[5],a[5]=e?Xd(e,k,u[6]):ka(k),a[6]=e?Fa(a[5],"__lodash_placeholder__"):ka(u[6])),(k=u[7])&&(a[7]=ka(k)),128&b&&(a[8]=null==a[8]?u[8]:wa(a[8],u[8])),null==
a[9]&&(a[9]=u[9]),a[0]=u[0],a[1]=d),b=a[0],d=a[1],k=a[2],e=a[3],g=a[4],f=a[9]=null==a[9]?m?0:b.length:ga(a[9]-h,0),!f&&24&d&&(d&=-25),m=d&&1!=d?8==d||16==d?pf(b,d,f):32!=d&&33!=d||g.length?bc.apply(p,a):qf(b,d,k,e):of(b,d,k),(u?ie:he)(m,a)}function gf(b,d,k,e,g,a){var c=-1,f=2&g,m=1&g,h=b.length,l=d.length;if(!(h==l||f&&l>h))return!1;if(l=a.get(b))return l==d;l=!0;for(a.set(b,d);++c<h;){var n=b[c],u=d[c];if(e)var q=f?e(u,n,c,d,b,a):e(n,u,c,b,d,a);if(q!==p){if(q)continue;l=!1;break}if(m){if(!I(d,function(b){return n===
b||k(n,b,e,g,a)})){l=!1;break}}else if(n!==u&&!k(n,u,e,g,a)){l=!1;break}}return a["delete"](b),l}function jf(b,d,k,e,g,a){switch(k){case "[object ArrayBuffer]":if(b.byteLength!=d.byteLength||!e(new $b(b),new $b(d)))break;return!0;case "[object Boolean]":case "[object Date]":return+b==+d;case "[object Error]":return b.name==d.name&&b.message==d.message;case "[object Number]":return b!=+b?d!=+d:b==+d;case "[object RegExp]":case "[object String]":return b==d+"";case "[object Map]":var c=Ua;case "[object Set]":return c||
(c=lb),(2&a||b.size==d.size)&&e(c(b),c(d),g,1|a);case "[object Symbol]":return!!Qa&&Kc.call(b)==Kc.call(d)}return!1}function hf(b,d,k,e,g,a){var c=2&g,f=ia(b),m=f.length,h=ia(d).length;if(m!=h&&!c)return!1;for(var l=m;l--;){var n=f[l];if(!(c?n in d:vc(d,n)))return!1}if(h=a.get(b))return h==d;h=!0;a.set(b,d);for(var u=c;++l<m;){var n=f[l],q=b[n],r=d[n];if(e)var v=c?e(r,q,n,d,b,a):e(q,r,n,b,d,a);if(v===p?q!==r&&!k(q,r,e,g,a):!v){h=!1;break}u||(u="constructor"==n)}return h&&!u&&(k=b.constructor,e=d.constructor,
k!=e&&"constructor"in b&&"constructor"in d&&!("function"==typeof k&&k instanceof k&&"function"==typeof e&&e instanceof e)&&(h=!1)),a["delete"](b),h}function cc(b){for(var d=b.name+"",k=Ib[d],e=aa.call(Ib,d)?k.length:0;e--;){var g=k[e],a=g.func;if(null==a||a==b)return g.name}return d}function A(){var b=g.iteratee||Lc,b=b===Lc?Ed:b;return arguments.length?b(arguments[0],arguments[1]):b}function yc(b){b=je(b);for(var d=b.length;d--;){var k,e=b[d];k=b[d][1];k=k===k&&!V(k);e[2]=k}return b}function fc(b,
d){var k=null==b?p:b[d];return ke(k)?k:p}function tb(b){return(aa.call(g,"placeholder")?g:b).placeholder}function Ca(b){return ma.call(b)}function le(b,d,k){if(null==b)return!1;var e=k(b,d);return e||Na(d)||(d=bb(d),b=Gb(b,d),null!=b&&(d=la(d),e=k(b,d))),k=b?b.length:p,e||!!k&&Jb(k)&&za(d,k)&&(E(b)||gb(b)||db(b))}function Xe(b){var d=b.length,k=b.constructor(d);return d&&"string"==typeof b[0]&&aa.call(b,"index")&&(k.index=b.index,k.input=b.input),k}function Ze(b){return ua(b.constructor)&&!Mc(b)?
pb(Vb(b)):{}}function $e(b,d,k){var e=b.constructor;switch(d){case "[object ArrayBuffer]":return Vd(b);case "[object Boolean]":case "[object Date]":return new e(+b);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return d=b.buffer,k=k?Vd(d):d,new b.constructor(k,b.byteOffset,b.length);case "[object Map]":return k=
b.constructor,w(Ua(b),f,new k);case "[object Number]":case "[object String]":return new e(b);case "[object RegExp]":return k=new b.constructor(b.source,gc.exec(b)),k.lastIndex=b.lastIndex,k;case "[object Set]":return k=b.constructor,w(lb(b),c,new k);case "[object Symbol]":return Qa?Object(Kc.call(b)):{}}}function me(b){var d=b?b.length:p;return Jb(d)&&(E(b)||gb(b)||db(b))?P(d,String):null}function Ga(b,d,k){if(!V(k))return!1;var e=typeof d;return("number"==e?va(k)&&za(d,k.length):"string"==e&&d in
k)?La(k[d],b):!1}function Na(b,d){return"number"==typeof b?!0:!E(b)&&(Nc.test(b)||!vb.test(b)||null!=d&&b in Object(d))}function mb(b){var d=typeof b;return"number"==d||"boolean"==d||"string"==d&&"__proto__"!=b||null==b}function Hc(b){var d=cc(b),k=g[d];return"function"==typeof k&&d in F.prototype?b===k?!0:(d=Gc(k),!!d&&b===d[0]):!1}function Mc(b){var d=b&&b.constructor,d=ua(d)&&d.prototype||nb;return b===d}function ne(b,d,k,e,g,a){return V(b)&&V(d)&&(a.set(d,b),Wb(b,d,p,ne,a)),b}function Gb(b,d){return 1==
d.length?b:Eb(b,Oa(d,0,-1))}function yd(b){var d=[];return J(b).replace(hc,function(b,e,g,a){d.push(g?a.replace(Oc,"$1"):e||b)}),d}function wd(b){if(b instanceof F)return b.clone();var d=new ra(b.__wrapped__,b.__chain__);return d.__actions__=ka(b.__actions__),d.__index__=b.__index__,d.__values__=b.__values__,d}function oe(b,d,k){var e=b?b.length:0;return e?(d=k||d===p?1:G(d),Oa(b,0>d?0:d,e)):[]}function pe(b,d,k){var e=b?b.length:0;return e?(d=k||d===p?1:G(d),d=e-d,Oa(b,0,0>d?0:d)):[]}function qe(b){return b?
b[0]:p}function la(b){var d=b?b.length:0;return d?b[d-1]:p}function re(b,d){return b&&b.length&&d&&d.length?Pd(b,d):b}function Pc(b){return b?rf.call(b):b}function Qc(b){if(!b||!b.length)return[];var d=0;return b=q(b,function(b){return da(b)?(d=ga(b.length,d),!0):void 0}),P(d,function(d){return v(b,Ac(d))})}function se(b,d){if(!b||!b.length)return[];var k=Qc(b);return null==d?k:v(k,function(b){return h(d,p,b)})}function te(b){return b=g(b),b.__chain__=!0,b}function ic(b,d){return d(b)}function sf(){return this}
function ue(b,d){return"function"==typeof d&&E(b)?l(b,d):Ma(b,ab(d))}function ve(b,d){var k;if("function"==typeof d&&E(b)){for(k=b.length;k--&&!1!==d(b[k],k,b););k=b}else k=Rc(b,ab(d));return k}function we(b,d){return(E(b)?v:Jd)(b,A(d,3))}function xe(b,d){var k=-1,e=Sc(b),g=e.length,a=g-1;for(d=ob(G(d),0,g);++k<d;){var g=Bc(k,a),c=e[g];e[g]=e[k];e[k]=c}return e.length=d,e}function ye(b,d,k){return d=k?p:d,d=b&&null==d?b.length:d,Pa(b,128,p,p,p,p,d)}function ze(b,d){var k;if("function"!=typeof d)throw new sa("Expected a function");
return b=G(b),function(){return 0<--b&&(k=d.apply(this,arguments)),1>=b&&(d=p),k}}function Ae(b,d,k){return d=k?p:d,b=Pa(b,8,p,p,p,p,p,d),b.placeholder=Ae.placeholder,b}function Be(b,d,k){return d=k?p:d,b=Pa(b,16,p,p,p,p,p,d),b.placeholder=Be.placeholder,b}function Ce(b,d,k){function e(){q&&Kb(q);h&&Kb(h);v=0;m=h=u=q=r=p}function g(d,k){k&&Kb(k);h=q=r=p;d&&(v=Lb(),l=b.apply(u,m),q||h||(m=u=p))}function a(){var b=d-(Lb()-n);0>=b||b>d?g(r,h):q=Tb(a,b)}function c(){g(H,q)}function f(){if(m=arguments,
n=Lb(),u=this,r=H&&(q||!w),!1===t)var k=w&&!q;else{v||h||w||(v=n);var e=t-(n-v),g=(0>=e||e>t)&&(w||h);g?(h&&(h=Kb(h)),v=n,l=b.apply(u,m)):h||(h=Tb(c,e))}return g&&q?q=Kb(q):q||d===t||(q=Tb(a,d)),k&&(g=!0,l=b.apply(u,m)),!g||q||h||(m=u=p),l}var m,h,l,n,u,q,r,v=0,w=!1,t=!1,H=!0;if("function"!=typeof b)throw new sa("Expected a function");return d=ha(d)||0,V(k)&&(w=!!k.leading,t="maxWait"in k&&ga(ha(k.maxWait)||0,d),H="trailing"in k?!!k.trailing:H),f.cancel=e,f.flush=function(){return(q&&r||h&&H)&&(l=
b.apply(u,m)),e(),l},f}function Tc(b,d){if("function"!=typeof b||d&&"function"!=typeof d)throw new sa("Expected a function");var k=function(){var e=arguments,g=d?d.apply(this,e):e[0],a=k.cache;return a.has(g)?a.get(g):(e=b.apply(this,e),k.cache=a.set(g,e),e)};return k.cache=new Tc.Cache,k}function z(b,d){if("function"!=typeof b)throw new sa("Expected a function");return d=ga(d===p?b.length-1:G(d),0),function(){for(var k=arguments,e=-1,g=ga(k.length-d,0),a=Array(g);++e<g;)a[e]=k[d+e];switch(d){case 0:return b.call(this,
a);case 1:return b.call(this,k[0],a);case 2:return b.call(this,k[0],k[1],a)}g=Array(d+1);for(e=-1;++e<d;)g[e]=k[e];return g[d]=a,h(b,this,g)}}function La(b,d){return b===d||b!==b&&d!==d}function Uc(b,d){return b>d}function db(b){return da(b)&&aa.call(b,"callee")&&(!De.call(b,"callee")||"[object Arguments]"==ma.call(b))}function va(b){return null!=b&&!("function"==typeof b&&ua(b))&&Jb(tf(b))}function da(b){return ca(b)&&va(b)}function Vc(b){return ca(b)?"[object Error]"==ma.call(b)||"string"==typeof b.message&&
"string"==typeof b.name:!1}function ua(b){return b=V(b)?ma.call(b):"","[object Function]"==b||"[object GeneratorFunction]"==b}function Ee(b){return"number"==typeof b&&b==G(b)}function Jb(b){return"number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b}function V(b){var d=typeof b;return!!b&&("object"==d||"function"==d)}function ca(b){return!!b&&"object"==typeof b}function ke(b){return null==b?!1:ua(b)?Fe.test(Wa.call(b)):ca(b)&&(qa(b)?Fe:Wc).test(b)}function Ge(b){return"number"==typeof b||ca(b)&&"[object Number]"==
ma.call(b)}function zc(b){return!ca(b)||"[object Object]"!=ma.call(b)||qa(b)?!1:(b=Vb(b),null===b?!0:(b=b.constructor,"function"==typeof b&&b instanceof b&&Wa.call(b)==uf))}function He(b){return V(b)&&"[object RegExp]"==ma.call(b)}function gb(b){return"string"==typeof b||!E(b)&&ca(b)&&"[object String]"==ma.call(b)}function Ie(b){return"symbol"==typeof b||ca(b)&&"[object Symbol]"==ma.call(b)}function qb(b){return ca(b)&&Jb(b.length)&&!!C[ma.call(b)]}function Xc(b,d){return d>b}function Sc(b){if(!b)return[];
if(va(b))return gb(b)?b.match(na):ka(b);if(hb&&b[hb])return kb(b[hb]());var d=Ca(b);return("[object Map]"==d?Ua:"[object Set]"==d?lb:jc)(b)}function G(b){if(!b)return 0===b?b:0;if(b=ha(b),b===wb||b===-wb)return 1.7976931348623157E308*(0>b?-1:1);var d=b%1;return b===b?d?b-d:b:0}function Je(b){return b?ob(G(b),0,4294967295):0}function ha(b){if(V(b)&&(b=ua(b.valueOf)?b.valueOf():b,b=V(b)?b+"":b),"string"!=typeof b)return 0===b?b:+b;b=b.replace(xb,"");var d=Ha.test(b);return d||Ea.test(b)?Ia(b.slice(2),
d?2:8):Yc.test(b)?Zc:+b}function Ld(b){return Db(b,ta(b))}function J(b){if("string"==typeof b)return b;if(null==b)return"";if(Ie(b))return Qa?vf.call(b):"";var d=b+"";return"0"==d&&1/b==-wb?"-0":d}function Eb(b,d,k){return b=null==b?p:uc(b,d),b===p?k:b}function Ke(b,d){return le(b,d,vc)}function Kd(b,d){return le(b,d,ef)}function ia(b){var d=Mc(b);if(!d&&!va(b))return wf(Object(b));var k,e=me(b),g=!!e,e=e||[],a=e.length;for(k in b)!vc(b,k)||g&&("length"==k||za(k,a))||d&&"constructor"==k||e.push(k);
return e}function ta(b){for(var d=-1,e=Mc(b),g=Id(b),a=g.length,c=me(b),f=!!c,c=c||[],m=c.length;++d<a;){var h=g[d];f&&("length"==h||za(h,m))||"constructor"==h&&(e||!aa.call(b,h))||c.push(h)}return c}function je(b){return N(b,ia(b))}function jc(b){return b?T(b,ia(b)):[]}function $c(b){return Le(J(b).toLowerCase())}function be(b){return(b=J(b))&&b.replace(Mb,Q).replace(ad,"")}function fe(b,d){b=J(b);d=G(d);var e="";if(!b||1>d||9007199254740991<d)return e;do d%2&&(e+=b),d=Xb(d/2),b+=b;while(d);return e}
function ae(b,d,e){return b=J(b),d=e?p:d,d===p&&(d=kc.test(b)?bd:cd),b.match(d)||[]}function dd(b){return function(){return b}}function Aa(b){return b}function Lc(b){return Ed("function"==typeof b?b:Ba(b,!0))}function ed(b,d,e){var g=ia(d),a=Ub(d,g);null!=e||V(d)&&(a.length||!g.length)||(e=d,d=b,b=this,a=Ub(d,ia(d)));var c=V(e)&&"chain"in e?e.chain:!0,f=ua(b);return l(a,function(e){var k=d[e];b[e]=k;f&&(b.prototype[e]=function(){var d=this.__chain__;if(c||d){var e=b(this.__wrapped__);return(e.__actions__=
ka(this.__actions__)).push({func:k,args:arguments,thisArg:b}),e.__chain__=d,e}return k.apply(b,r([this.value()],arguments))})}),b}function fd(){}function Hd(b){return Na(b)?Ac(b):kf(b)}function Me(b){return b&&b.length?X(b,Aa):0}L=L?u.defaults({},L,u.pick(oa,gd)):oa;var xf=L.Date,yf=L.Error,ub=L.Math,hd=L.RegExp,sa=L.TypeError,lc=L.Array.prototype,nb=L.Object.prototype,Wa=L.Function.prototype.toString,aa=nb.hasOwnProperty,zf=0,uf=Wa.call(Object),ma=nb.toString,Af=oa._,Fe=hd("^"+Wa.call(aa).replace(Nb,
"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ne=Xa?L.Buffer:p,Oe=L.Reflect,Qa=L.Symbol,$b=L.Uint8Array,Kb=L.clearTimeout,Pe=Oe?Oe.enumerate:p,Vb=Object.getPrototypeOf,Bf=Object.getOwnPropertySymbols,hb="symbol"==typeof(hb=Qa&&Qa.iterator)?hb:p,bf=Object.create,De=nb.propertyIsEnumerable,Tb=L.setTimeout,Rb=lc.splice,ec=ub.ceil,Xb=ub.floor,Cf=L.isFinite,Df=lc.join,wf=Object.keys,ga=ub.max,wa=ub.min,Ef=L.parseInt,Rd=ub.random,rf=lc.reverse,Ja=fc(L,"Map"),ib=
fc(L,"Set"),yb=fc(L,"WeakMap"),zb=fc(Object,"create"),mc=yb&&new yb,Ff=Ja?Wa.call(Ja):"",Gf=ib?Wa.call(ib):"",Hf=yb?Wa.call(yb):"",Qe=Qa?Qa.prototype:p,Kc=Qa?Qe.valueOf:p,vf=Qa?Qe.toString:p,Ib={};g.templateSettings={escape:id,evaluate:jd,interpolate:nc,variable:"",imports:{_:g}};var Ma=Yd(Da),Rc=Yd(tc,!0),sc=Zd(),Dd=Zd(!0);Pe&&!De.call({valueOf:1},"valueOf")&&(Id=function(b){return kb(Pe(b))});var ie=mc?function(b,d){return mc.set(b,d),b}:Aa,mf=ib&&2===(new ib([1,2])).size?function(b){return new ib(b)}:
fd,Gc=mc?function(b){return mc.get(b)}:fd,tf=Ac("length"),nf=Bf||function(){return[]};(Ja&&"[object Map]"!=Ca(new Ja)||ib&&"[object Set]"!=Ca(new ib)||yb&&"[object WeakMap]"!=Ca(new yb))&&(Ca=function(b){var d=ma.call(b);if(b="[object Object]"==d?b.constructor:null,b="function"==typeof b?Wa.call(b):"")switch(b){case Ff:return"[object Map]";case Gf:return"[object Set]";case Hf:return"[object WeakMap]"}return d});var he=function(){var b=0,d=0;return function(e,g){var a=Lb(),c=16-(a-d);if(d=a,0<c){if(150<=
++b)return e}else b=0;return ie(e,g)}}(),If=z(function(b,d){E(b)||(b=null==b?[]:[Object(b)]);d=S(d,1);for(var e=b,g=d,a=-1,c=e.length,f=-1,m=g.length,h=Array(c+m);++a<c;)h[a]=e[a];for(;++f<m;)h[a++]=g[f];return h}),Jf=z(function(b,d){return da(b)?cb(b,S(d,1,!0)):[]}),Kf=z(function(b,d){var e=la(d);return da(e)&&(e=p),da(b)?cb(b,S(d,1,!0),A(e)):[]}),Lf=z(function(b,d){var e=la(d);return da(e)&&(e=p),da(b)?cb(b,S(d,1,!0),p,e):[]}),Mf=z(function(b){var d=v(b,rc);return d.length&&d[0]===b[0]?wc(d):[]}),
Nf=z(function(b){var d=la(b),e=v(b,rc);return d===la(e)?d=p:e.pop(),e.length&&e[0]===b[0]?wc(e,A(d)):[]}),Of=z(function(b){var d=la(b),e=v(b,rc);return d===la(e)?d=p:e.pop(),e.length&&e[0]===b[0]?wc(e,p,d):[]}),Pf=z(re),Qf=z(function(b,d){d=v(S(d,1),String);var e=qc(b,d);return Qd(b,d.sort(pa)),e}),Rf=z(function(b){return fb(S(b,1,!0))}),Sf=z(function(b){var d=la(b);return da(d)&&(d=p),fb(S(b,1,!0),A(d))}),Tf=z(function(b){var d=la(b);return da(d)&&(d=p),fb(S(b,1,!0),p,d)}),Uf=z(function(b,d){return da(b)?
cb(b,d):[]}),Vf=z(function(b){return Ec(q(b,da))}),Wf=z(function(b){var d=la(b);return da(d)&&(d=p),Ec(q(b,da),A(d))}),Xf=z(function(b){var d=la(b);return da(d)&&(d=p),Ec(q(b,da),p,d)}),Yf=z(Qc),Zf=z(function(b){var d=b.length,d=1<d?b[d-1]:p,d="function"==typeof d?(b.pop(),d):p;return se(b,d)}),$f=z(function(b){b=S(b,1);var d=b.length,e=d?b[0]:0,g=this.__wrapped__,a=function(d){return qc(d,b)};return 1>=d&&!this.__actions__.length&&g instanceof F&&za(e)?(g=g.slice(e,+e+(d?1:0)),g.__actions__.push({func:ic,
args:[a],thisArg:p}),(new ra(g,this.__chain__)).thru(function(b){return d&&!b.length&&b.push(p),b})):this.thru(a)}),ag=ac(function(b,d,e){aa.call(b,e)?++b[e]:b[e]=1}),bg=ac(function(b,d,e){aa.call(b,e)?b[e].push(d):b[e]=[d]}),cg=z(function(b,d,e){var g=-1,a="function"==typeof d,c=Na(d),f=va(b)?Array(b.length):[];return Ma(b,function(b){var m=a?d:c&&null!=b?b[d]:p;f[++g]=m?h(m,b,e):Fb(b,d,e)}),f}),dg=ac(function(b,d,e){b[e]=d}),eg=ac(function(b,d,e){b[e?0:1].push(d)},function(){return[[],[]]}),fg=
z(function(b,d){if(null==b)return[];var e=d.length;return 1<e&&Ga(b,d[0],d[1])?d=[]:2<e&&Ga(d[0],d[1],d[2])&&(d.length=1),Md(b,S(d,1),[])}),Lb=xf.now,kd=z(function(b,d,e){var g=1;if(e.length)var a=Fa(e,tb(kd)),g=32|g;return Pa(b,g,d,e,a)}),Re=z(function(b,d,e){var g=3;if(e.length)var a=Fa(e,tb(Re)),g=32|g;return Pa(d,g,b,e,a)}),gg=z(function(b,d){return Bd(b,1,d)}),hg=z(function(b,d,e){return Bd(b,ha(d)||0,e)}),ig=z(function(b,d){d=v(S(d,1),A());var e=d.length;return z(function(g){for(var a=-1,c=
wa(g.length,e);++a<c;)g[a]=d[a].call(this,g[a]);return h(b,this,g)})}),ld=z(function(b,d){var e=Fa(d,tb(ld));return Pa(b,32,p,d,e)}),Se=z(function(b,d){var e=Fa(d,tb(Se));return Pa(b,64,p,d,e)}),jg=z(function(b,d){return Pa(b,256,p,p,p,S(d,1))}),E=Array.isArray,zd=Ne?function(b){return b instanceof Ne}:dd(!1),kg=rb(function(b,d){Db(d,ia(d),b)}),Te=rb(function(b,d){Db(d,ta(d),b)}),Ob=rb(function(b,d,e,g){Fc(d,ta(d),b,g)}),lg=rb(function(b,d,e,g){Fc(d,ia(d),b,g)}),mg=z(function(b,d){return qc(b,S(d,
1))}),ng=z(function(b){return b.push(p,Ra),h(Ob,p,b)}),og=z(function(b){return b.push(p,ne),h(Ue,p,b)}),pg=ee(function(b,d,e){b[d]=e},dd(Aa)),qg=ee(function(b,d,e){aa.call(b,d)?b[d].push(e):b[d]=[e]},A),rg=z(Fb),sg=rb(function(b,d,e){Wb(b,d,e)}),Ue=rb(function(b,d,e,g){Wb(b,d,e,g)}),tg=z(function(b,d){return null==b?{}:(d=v(S(d,1),String),Nd(b,cb(ta(b),d)))}),ug=z(function(b,d){return null==b?{}:Nd(b,S(d,1))}),vg=sb(function(b,d,e){return d=d.toLowerCase(),b+(e?$c(d):d)}),wg=sb(function(b,d,e){return b+
(e?"-":"")+d.toLowerCase()}),xg=sb(function(b,d,e){return b+(e?" ":"")+d.toLowerCase()}),yg=$d("toLowerCase"),Le=$d("toUpperCase"),zg=sb(function(b,d,e){return b+(e?"_":"")+d.toLowerCase()}),Ag=sb(function(b,d,e){return b+(e?" ":"")+$c(d)}),Bg=sb(function(b,d,e){return b+(e?" ":"")+d.toUpperCase()}),Ve=z(function(b,d){try{return h(b,p,d)}catch(e){return Vc(e)?e:new yf(e)}}),Cg=z(function(b,d){return l(S(d,1),function(d){b[d]=kd(b[d],b)}),b}),Dg=de(),Eg=de(!0),Fg=z(function(b,d){return function(e){return Fb(e,
b,d)}}),Gg=z(function(b,d){return function(e){return Fb(b,e,d)}}),Hg=Ic(v),Ig=Ic(n),Jg=Ic(I),Kg=ge(),Lg=ge(!0),Mg=Jc("ceil"),Ng=Jc("floor"),Og=Jc("round");return g.prototype=U.prototype,ra.prototype=pb(U.prototype),ra.prototype.constructor=ra,F.prototype=pb(U.prototype),F.prototype.constructor=F,W.prototype=zb?zb(null):nb,Sa.prototype.clear=function(){this.__data__={hash:new W,map:Ja?new Ja:[],string:new W}},Sa.prototype["delete"]=function(b){var d=this.__data__;return mb(b)?(d="string"==typeof b?
d.string:d.hash,(zb?d[b]!==p:aa.call(d,b))&&delete d[b]):Ja?d.map["delete"](b):xa(d.map,b)},Sa.prototype.get=function(b){var d=this.__data__;return mb(b)?(d="string"==typeof b?d.string:d.hash,zb?(b=d[b],b="__lodash_hash_undefined__"===b?p:b):b=aa.call(d,b)?d[b]:p,b):Ja?d.map.get(b):Ta(d.map,b)},Sa.prototype.has=function(b){var d=this.__data__;return mb(b)?(d="string"==typeof b?d.string:d.hash,b=zb?d[b]!==p:aa.call(d,b)):b=Ja?d.map.has(b):-1<ya(d.map,b),b},Sa.prototype.set=function(b,d){var e=this.__data__;
return mb(b)?("string"==typeof b?e.string:e.hash)[b]=zb&&d===p?"__lodash_hash_undefined__":d:Ja?e.map.set(b,d):Ya(e.map,b,d),this},Y.prototype.push=function(b){var d=this.__data__;mb(b)?(d=d.__data__,("string"==typeof b?d.string:d.hash)[b]="__lodash_hash_undefined__"):d.set(b,"__lodash_hash_undefined__")},ba.prototype.clear=function(){this.__data__={array:[],map:null}},ba.prototype["delete"]=function(b){var d=this.__data__,e=d.array;return e?xa(e,b):d.map["delete"](b)},ba.prototype.get=function(b){var d=
this.__data__,e=d.array;return e?Ta(e,b):d.map.get(b)},ba.prototype.has=function(b){var d=this.__data__,e=d.array;return e?-1<ya(e,b):d.map.has(b)},ba.prototype.set=function(b,d){var e=this.__data__,g=e.array;return g&&(199>g.length?Ya(g,b,d):(e.array=null,e.map=new Sa(g))),(e=e.map)&&e.set(b,d),this},Tc.Cache=Sa,g.after=function(b,d){if("function"!=typeof d)throw new sa("Expected a function");return b=G(b),function(){return 1>--b?d.apply(this,arguments):void 0}},g.ary=ye,g.assign=kg,g.assignIn=Te,
g.assignInWith=Ob,g.assignWith=lg,g.at=mg,g.before=ze,g.bind=kd,g.bindAll=Cg,g.bindKey=Re,g.castArray=function(){if(!arguments.length)return[];var b=arguments[0];return E(b)?b:[b]},g.chain=te,g.chunk=function(b,d){d=ga(G(d),0);var e=b?b.length:0;if(!e||1>d)return[];for(var g=0,a=-1,c=Array(ec(e/d));e>g;)c[++a]=Oa(b,g,g+=d);return c},g.compact=function(b){for(var d=-1,e=b?b.length:0,g=-1,a=[];++d<e;){var c=b[d];c&&(a[++g]=c)}return a},g.concat=If,g.cond=function(b){var d=b?b.length:0,e=A();return b=
d?v(b,function(b){if("function"!=typeof b[1])throw new sa("Expected a function");return[e(b[0]),b[1]]}):[],z(function(e){for(var g=-1;++g<d;){var a=b[g];if(h(a[0],this,e))return h(a[1],this,e)}})},g.conforms=function(b){return af(Ba(b,!0))},g.constant=dd,g.countBy=ag,g.create=function(b,d){var e=pb(b);return d?xd(e,d):e},g.curry=Ae,g.curryRight=Be,g.debounce=Ce,g.defaults=ng,g.defaultsDeep=og,g.defer=gg,g.delay=hg,g.difference=Jf,g.differenceBy=Kf,g.differenceWith=Lf,g.drop=oe,g.dropRight=pe,g.dropRightWhile=
function(b,d){return b&&b.length?Zb(b,A(d,3),!0,!0):[]},g.dropWhile=function(b,d){return b&&b.length?Zb(b,A(d,3),!0):[]},g.fill=function(b,d,e,g){var a=b?b.length:0;if(!a)return[];e&&"number"!=typeof e&&Ga(b,d,e)&&(e=0,g=a);a=b.length;e=G(e);0>e&&(e=-e>a?0:a+e);g=g===p||g>a?a:G(g);0>g&&(g+=a);for(g=e>g?0:Je(g);g>e;)b[e++]=d;return b},g.filter=function(b,d){return(E(b)?q:Cd)(b,A(d,3))},g.flatMap=function(b,d){return S(we(b,d),1)},g.flatten=function(b){return b&&b.length?S(b,1):[]},g.flattenDeep=function(b){return b&&
b.length?S(b,wb):[]},g.flattenDepth=function(b,d){return b&&b.length?(d=d===p?1:G(d),S(b,d)):[]},g.flip=function(b){return Pa(b,512)},g.flow=Dg,g.flowRight=Eg,g.fromPairs=function(b){for(var d=-1,e=b?b.length:0,g={};++d<e;){var a=b[d];g[a[0]]=a[1]}return g},g.functions=function(b){return null==b?[]:Ub(b,ia(b))},g.functionsIn=function(b){return null==b?[]:Ub(b,ta(b))},g.groupBy=bg,g.initial=function(b){return pe(b,1)},g.intersection=Mf,g.intersectionBy=Nf,g.intersectionWith=Of,g.invert=pg,g.invertBy=
qg,g.invokeMap=cg,g.iteratee=Lc,g.keyBy=dg,g.keys=ia,g.keysIn=ta,g.map=we,g.mapKeys=function(b,d){var e={};return d=A(d,3),Da(b,function(b,g,a){e[d(b,g,a)]=b}),e},g.mapValues=function(b,d){var e={};return d=A(d,3),Da(b,function(b,g,a){e[g]=d(b,g,a)}),e},g.matches=function(b){return Gd(Ba(b,!0))},g.matchesProperty=function(b,d){return Fd(b,Ba(d,!0))},g.memoize=Tc,g.merge=sg,g.mergeWith=Ue,g.method=Fg,g.methodOf=Gg,g.mixin=ed,g.negate=function(b){if("function"!=typeof b)throw new sa("Expected a function");
return function(){return!b.apply(this,arguments)}},g.nthArg=function(b){return b=G(b),function(){return arguments[b]}},g.omit=tg,g.omitBy=function(b,d){return d=A(d),Od(b,function(b,e){return!d(b,e)})},g.once=function(b){return ze(2,b)},g.orderBy=function(b,d,e,g){return null==b?[]:(E(d)||(d=null==d?[]:[d]),e=g?p:e,E(e)||(e=null==e?[]:[e]),Md(b,d,e))},g.over=Hg,g.overArgs=ig,g.overEvery=Ig,g.overSome=Jg,g.partial=ld,g.partialRight=Se,g.partition=eg,g.pick=ug,g.pickBy=function(b,d){return null==b?
{}:Od(b,A(d))},g.property=Hd,g.propertyOf=function(b){return function(d){return null==b?p:uc(b,d)}},g.pull=Pf,g.pullAll=re,g.pullAllBy=function(b,d,e){return b&&b.length&&d&&d.length?Pd(b,d,A(e)):b},g.pullAt=Qf,g.range=Kg,g.rangeRight=Lg,g.rearg=jg,g.reject=function(b,d){var e=E(b)?q:Cd;return d=A(d,3),e(b,function(b,e,g){return!d(b,e,g)})},g.remove=function(b,d){var e=[];if(!b||!b.length)return e;var g=-1,a=[],c=b.length;for(d=A(d,3);++g<c;){var f=b[g];d(f,g,b)&&(e.push(f),a.push(g))}return Qd(b,
a),e},g.rest=z,g.reverse=Pc,g.sampleSize=xe,g.set=function(b,d,e){return null==b?b:Cc(b,d,e)},g.setWith=function(b,d,e,g){return g="function"==typeof g?g:p,null==b?b:Cc(b,d,e,g)},g.shuffle=function(b){return xe(b,4294967295)},g.slice=function(b,d,e){var g=b?b.length:0;return g?(e&&"number"!=typeof e&&Ga(b,d,e)?(d=0,e=g):(d=null==d?0:G(d),e=e===p?g:G(e)),Oa(b,d,e)):[]},g.sortBy=fg,g.sortedUniq=function(b){return b&&b.length?Sd(b):[]},g.sortedUniqBy=function(b,d){return b&&b.length?Sd(b,A(d)):[]},g.split=
function(b,d,e){return J(b).split(d,e)},g.spread=function(b,d){if("function"!=typeof b)throw new sa("Expected a function");return d=d===p?0:ga(G(d),0),z(function(e){var g=e[d];return e=e.slice(0,d),g&&r(e,g),h(b,this,e)})},g.tail=function(b){return oe(b,1)},g.take=function(b,d,e){return b&&b.length?(d=e||d===p?1:G(d),Oa(b,0,0>d?0:d)):[]},g.takeRight=function(b,d,e){var g=b?b.length:0;return g?(d=e||d===p?1:G(d),d=g-d,Oa(b,0>d?0:d,g)):[]},g.takeRightWhile=function(b,d){return b&&b.length?Zb(b,A(d,
3),!1,!0):[]},g.takeWhile=function(b,d){return b&&b.length?Zb(b,A(d,3)):[]},g.tap=function(b,d){return d(b),b},g.throttle=function(b,d,e){var g=!0,a=!0;if("function"!=typeof b)throw new sa("Expected a function");return V(e)&&(g="leading"in e?!!e.leading:g,a="trailing"in e?!!e.trailing:a),Ce(b,d,{leading:g,maxWait:d,trailing:a})},g.thru=ic,g.toArray=Sc,g.toPairs=je,g.toPairsIn=function(b){return N(b,ta(b))},g.toPath=function(b){return E(b)?v(b,String):yd(b)},g.toPlainObject=Ld,g.transform=function(b,
d,e){var g=E(b)||qb(b);if(d=A(d,4),null==e)if(g||V(b)){var a=b.constructor;e=g?E(b)?new a:[]:ua(a)?pb(Vb(b)):{}}else e={};return(g?l:Da)(b,function(b,g,a){return d(e,b,g,a)}),e},g.unary=function(b){return ye(b,1)},g.union=Rf,g.unionBy=Sf,g.unionWith=Tf,g.uniq=function(b){return b&&b.length?fb(b):[]},g.uniqBy=function(b,d){return b&&b.length?fb(b,A(d)):[]},g.uniqWith=function(b,d){return b&&b.length?fb(b,p,d):[]},g.unset=function(b,d){var e;if(null==b)e=!0;else{e=b;var g=d,g=Na(g,e)?[g+""]:bb(g);e=
Gb(e,g);g=la(g);e=null!=e&&Ke(e,g)?delete e[g]:!0}return e},g.unzip=Qc,g.unzipWith=se,g.values=jc,g.valuesIn=function(b){return null==b?[]:T(b,ta(b))},g.without=Uf,g.words=ae,g.wrap=function(b,d){return d=null==d?Aa:d,ld(d,b)},g.xor=Vf,g.xorBy=Wf,g.xorWith=Xf,g.zip=Yf,g.zipObject=function(b,d){return Ud(b||[],d||[],Sb)},g.zipObjectDeep=function(b,d){return Ud(b||[],d||[],Cc)},g.zipWith=Zf,g.extend=Te,g.extendWith=Ob,ed(g,g),g.add=function(b,d){var e;return b===p&&d===p?0:(b!==p&&(e=b),d!==p&&(e=e===
p?d:e+d),e)},g.attempt=Ve,g.camelCase=vg,g.capitalize=$c,g.ceil=Mg,g.clamp=function(b,d,e){return e===p&&(e=d,d=p),e!==p&&(e=ha(e),e=e===e?e:0),d!==p&&(d=ha(d),d=d===d?d:0),ob(ha(b),d,e)},g.clone=function(b){return Ba(b)},g.cloneDeep=function(b){return Ba(b,!0)},g.cloneDeepWith=function(b,d){return Ba(b,!0,d)},g.cloneWith=function(b,d){return Ba(b,!1,d)},g.deburr=be,g.endsWith=function(b,d,e){b=J(b);d="string"==typeof d?d:d+"";var g=b.length;return e=e===p?g:ob(G(e),0,g),e-=d.length,0<=e&&b.indexOf(d,
e)==e},g.eq=La,g.escape=function(b){return(b=J(b))&&md.test(b)?b.replace(Pb,Ka):b},g.escapeRegExp=function(b){return(b=J(b))&&oc.test(b)?b.replace(Nb,"\\$&"):b},g.every=function(b,d,e){var g=E(b)?n:cf;return e&&Ga(b,d,e)&&(d=p),g(b,A(d,3))},g.find=function(b,d){if(d=A(d,3),E(b)){var e=y(b,d);return-1<e?b[e]:p}return x(b,d,Ma)},g.findIndex=function(b,d){return b&&b.length?y(b,A(d,3)):-1},g.findKey=function(b,d){return x(b,A(d,3),Da,!0)},g.findLast=function(b,d){if(d=A(d,3),E(b)){var e=y(b,d,!0);return-1<
e?b[e]:p}return x(b,d,Rc)},g.findLastIndex=function(b,d){return b&&b.length?y(b,A(d,3),!0):-1},g.findLastKey=function(b,d){return x(b,A(d,3),tc,!0)},g.floor=Ng,g.forEach=ue,g.forEachRight=ve,g.forIn=function(b,d){return null==b?b:sc(b,ab(d),ta)},g.forInRight=function(b,d){return null==b?b:Dd(b,ab(d),ta)},g.forOwn=function(b,d){return b&&Da(b,ab(d))},g.forOwnRight=function(b,d){return b&&tc(b,ab(d))},g.get=Eb,g.gt=Uc,g.gte=function(b,d){return b>=d},g.has=Ke,g.hasIn=Kd,g.head=qe,g.identity=Aa,g.includes=
function(b,d,e,g){return b=va(b)?b:jc(b),e=e&&!g?G(e):0,g=b.length,0>e&&(e=ga(g+e,0)),gb(b)?g>=e&&-1<b.indexOf(d,e):!!g&&-1<B(b,d,e)},g.indexOf=function(b,d,e){var g=b?b.length:0;return g?(e=G(e),0>e&&(e=ga(g+e,0)),B(b,d,e)):-1},g.inRange=function(b,d,e){return d=ha(d)||0,e===p?(e=d,d=0):e=ha(e)||0,b=ha(b),b>=wa(d,e)&&b<ga(d,e)},g.invoke=rg,g.isArguments=db,g.isArray=E,g.isArrayBuffer=function(b){return ca(b)&&"[object ArrayBuffer]"==ma.call(b)},g.isArrayLike=va,g.isArrayLikeObject=da,g.isBoolean=
function(b){return!0===b||!1===b||ca(b)&&"[object Boolean]"==ma.call(b)},g.isBuffer=zd,g.isDate=function(b){return ca(b)&&"[object Date]"==ma.call(b)},g.isElement=function(b){return!!b&&1===b.nodeType&&ca(b)&&!zc(b)},g.isEmpty=function(b){if(va(b)&&(E(b)||gb(b)||ua(b.splice)||db(b)))return!b.length;for(var d in b)if(aa.call(b,d))return!1;return!0},g.isEqual=function(b,d){return eb(b,d)},g.isEqualWith=function(b,d,e){var g=(e="function"==typeof e?e:p)?e(b,d):p;return g===p?eb(b,d,e):!!g},g.isError=
Vc,g.isFinite=function(b){return"number"==typeof b&&Cf(b)},g.isFunction=ua,g.isInteger=Ee,g.isLength=Jb,g.isMap=function(b){return ca(b)&&"[object Map]"==Ca(b)},g.isMatch=function(b,d){return b===d||xc(b,d,yc(d))},g.isMatchWith=function(b,d,e){return e="function"==typeof e?e:p,xc(b,d,yc(d),e)},g.isNaN=function(b){return Ge(b)&&b!=+b},g.isNative=ke,g.isNil=function(b){return null==b},g.isNull=function(b){return null===b},g.isNumber=Ge,g.isObject=V,g.isObjectLike=ca,g.isPlainObject=zc,g.isRegExp=He,
g.isSafeInteger=function(b){return Ee(b)&&-9007199254740991<=b&&9007199254740991>=b},g.isSet=function(b){return ca(b)&&"[object Set]"==Ca(b)},g.isString=gb,g.isSymbol=Ie,g.isTypedArray=qb,g.isUndefined=function(b){return b===p},g.isWeakMap=function(b){return ca(b)&&"[object WeakMap]"==Ca(b)},g.isWeakSet=function(b){return ca(b)&&"[object WeakSet]"==ma.call(b)},g.join=function(b,d){return b?Df.call(b,d):""},g.kebabCase=wg,g.last=la,g.lastIndexOf=function(b,d,e){var g=b?b.length:0;if(!g)return-1;var a=
g;if(e!==p&&(a=G(e),a=(0>a?ga(g+a,0):wa(a,g-1))+1),d!==d)return ja(b,a,!0);for(;a--;)if(b[a]===d)return a;return-1},g.lowerCase=xg,g.lowerFirst=yg,g.lt=Xc,g.lte=function(b,d){return d>=b},g.max=function(b){return b&&b.length?D(b,Aa,Uc):p},g.maxBy=function(b,d){return b&&b.length?D(b,A(d),Uc):p},g.mean=function(b){return Me(b)/(b?b.length:0)},g.min=function(b){return b&&b.length?D(b,Aa,Xc):p},g.minBy=function(b,d){return b&&b.length?D(b,A(d),Xc):p},g.noConflict=function(){return oa._===this&&(oa._=
Af),this},g.noop=fd,g.now=Lb,g.pad=function(b,d,e){b=J(b);d=G(d);var g=$a(b);return d&&d>g?(g=(d-g)/2,d=Xb(g),g=ec(g),dc("",d,e)+b+dc("",g,e)):b},g.padEnd=function(b,d,e){return b=J(b),b+dc(b,d,e)},g.padStart=function(b,d,e){return b=J(b),dc(b,d,e)+b},g.parseInt=function(b,d,e){return e||null==d?d=0:d&&(d=+d),b=J(b).replace(xb,""),Ef(b,d||(nd.test(b)?16:10))},g.random=function(b,d,e){if(e&&"boolean"!=typeof e&&Ga(b,d,e)&&(d=e=p),e===p&&("boolean"==typeof d?(e=d,d=p):"boolean"==typeof b&&(e=b,b=p)),
b===p&&d===p?(b=0,d=1):(b=ha(b)||0,d===p?(d=b,b=0):d=ha(d)||0),b>d){var g=b;b=d;d=g}return e||b%1||d%1?(e=Rd(),wa(b+e*(d-b+jb("1e-"+((e+"").length-1))),d)):Bc(b,d)},g.reduce=function(b,d,e){var g=E(b)?w:M,a=3>arguments.length;return g(b,A(d,4),e,a,Ma)},g.reduceRight=function(b,d,e){var g=E(b)?K:M,a=3>arguments.length;return g(b,A(d,4),e,a,Rc)},g.repeat=fe,g.replace=function(){var b=arguments,d=J(b[0]);return 3>b.length?d:d.replace(b[1],b[2])},g.result=function(b,d,e){if(Na(d,b))g=null==b?p:b[d];else{d=
bb(d);var g=Eb(b,d);b=Gb(b,d)}return g===p&&(g=e),ua(g)?g.call(b):g},g.round=Og,g.runInContext=Cb,g.sample=function(b){b=va(b)?b:jc(b);var d=b.length;return 0<d?b[Bc(0,d-1)]:p},g.size=function(b){if(null==b)return 0;if(va(b)){var d=b.length;return d&&gb(b)?$a(b):d}return ia(b).length},g.snakeCase=zg,g.some=function(b,d,e){var g=E(b)?I:lf;return e&&Ga(b,d,e)&&(d=p),g(b,A(d,3))},g.sortedIndex=function(b,d){return Yb(b,d)},g.sortedIndexBy=function(b,d,e){return Dc(b,d,A(e))},g.sortedIndexOf=function(b,
d){var e=b?b.length:0;if(e){var g=Yb(b,d);if(e>g&&La(b[g],d))return g}return-1},g.sortedLastIndex=function(b,d){return Yb(b,d,!0)},g.sortedLastIndexBy=function(b,d,e){return Dc(b,d,A(e),!0)},g.sortedLastIndexOf=function(b,d){if(b&&b.length){var e=Yb(b,d,!0)-1;if(La(b[e],d))return e}return-1},g.startCase=Ag,g.startsWith=function(b,d,e){return b=J(b),e=ob(G(e),0,b.length),b.lastIndexOf(d,e)==e},g.subtract=function(b,d){var e;return b===p&&d===p?0:(b!==p&&(e=b),d!==p&&(e=e===p?d:e-d),e)},g.sum=Me,g.sumBy=
function(b,d){return b&&b.length?X(b,A(d)):0},g.template=function(b,d,a){var c=g.templateSettings;a&&Ga(b,d,a)&&(d=p);b=J(b);d=Ob({},d,c,Ra);a=Ob({},d.imports,c.imports,Ra);var f,m,h=ia(a),l=T(a,h),n=0;a=d.interpolate||Ab;var u="__p+='";a=hd((d.escape||Ab).source+"|"+a.source+"|"+(a===nc?od:Ab).source+"|"+(d.evaluate||Ab).source+"|$","g");var q="sourceURL"in d?"//# sourceURL="+d.sourceURL+"\n":"";if(b.replace(a,function(d,g,a,c,k,h){return a||(a=c),u+=b.slice(n,h).replace(pd,e),g&&(f=!0,u+="'+__e("+
g+")+'"),k&&(m=!0,u+="';"+k+";\n__p+='"),a&&(u+="'+((__t=("+a+"))==null?'':__t)+'"),n=h+d.length,d}),u+="';",(d=d.variable)||(u="with(obj){"+u+"}"),u=(m?u.replace(qd,""):u).replace(rd,"$1").replace(sd,"$1;"),u="function("+(d||"obj")+"){"+(d?"":"obj||(obj={});")+"var __t,__p=''"+(f?",__e=_.escape":"")+(m?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+u+"return __p}",d=Ve(function(){return Function(h,q+"return "+u).apply(p,l)}),d.source=u,Vc(d))throw d;return d},g.times=
function(b,d){if(b=G(b),1>b||9007199254740991<b)return[];var e=4294967295,g=wa(b,4294967295);d=ab(d);b-=4294967295;for(g=P(g,d);++e<b;)d(e);return g},g.toInteger=G,g.toLength=Je,g.toLower=function(b){return J(b).toLowerCase()},g.toNumber=ha,g.toSafeInteger=function(b){return ob(G(b),-9007199254740991,9007199254740991)},g.toString=J,g.toUpper=function(b){return J(b).toUpperCase()},g.trim=function(b,d,e){return(b=J(b))?e||d===p?b.replace(xb,""):(d+="")?(b=b.match(na),d=d.match(na),b.slice(R(b,d),H(b,
d)+1).join("")):b:b},g.trimEnd=function(b,d,e){return(b=J(b))?e||d===p?b.replace(td,""):(d+="")?(b=b.match(na),b.slice(0,H(b,d.match(na))+1).join("")):b:b},g.trimStart=function(b,d,e){return(b=J(b))?e||d===p?b.replace(ud,""):(d+="")?(b=b.match(na),b.slice(R(b,d.match(na))).join("")):b:b},g.truncate=function(b,d){var e=30,g="...";if(V(d))var a="separator"in d?d.separator:a,e="length"in d?G(d.length):e,g="omission"in d?J(d.omission):g;b=J(b);var c=b.length;if(Va.test(b))var f=b.match(na),c=f.length;
if(e>=c)return b;if(c=e-$a(g),1>c)return g;if(e=f?f.slice(0,c).join(""):b.slice(0,c),a===p)return e+g;if(f&&(c+=e.length-c),He(a)){if(b.slice(c).search(a)){var m=e;a.global||(a=hd(a.source,J(gc.exec(a))+"g"));for(a.lastIndex=0;f=a.exec(m);)var h=f.index;e=e.slice(0,h===p?c:h)}}else b.indexOf(a,c)!=c&&(a=e.lastIndexOf(a),-1<a&&(e=e.slice(0,a)));return e+g},g.unescape=function(b){return(b=J(b))&&vd.test(b)?b.replace(Qb,pc):b},g.uniqueId=function(b){var d=++zf;return J(b)+d},g.upperCase=Bg,g.upperFirst=
Le,g.each=ue,g.eachRight=ve,g.first=qe,ed(g,function(){var b={};return Da(g,function(d,e){aa.call(g.prototype,e)||(b[e]=d)}),b}(),{chain:!1}),g.VERSION="4.5.1",l("bind bindKey curry curryRight partial partialRight".split(" "),function(b){g[b].placeholder=g}),l(["drop","take"],function(b,d){F.prototype[b]=function(e){var g=this.__filtered__;if(g&&!d)return new F(this);e=e===p?1:ga(G(e),0);var a=this.clone();return g?a.__takeCount__=wa(e,a.__takeCount__):a.__views__.push({size:wa(e,4294967295),type:b+
(0>a.__dir__?"Right":"")}),a};F.prototype[b+"Right"]=function(d){return this.reverse()[b](d).reverse()}}),l(["filter","map","takeWhile"],function(b,d){var e=d+1,g=1==e||3==e;F.prototype[b]=function(b){var d=this.clone();return d.__iteratees__.push({iteratee:A(b,3),type:e}),d.__filtered__=d.__filtered__||g,d}}),l(["head","last"],function(b,d){var e="take"+(d?"Right":"");F.prototype[b]=function(){return this[e](1).value()[0]}}),l(["initial","tail"],function(b,d){var e="drop"+(d?"":"Right");F.prototype[b]=
function(){return this.__filtered__?new F(this):this[e](1)}}),F.prototype.compact=function(){return this.filter(Aa)},F.prototype.find=function(b){return this.filter(b).head()},F.prototype.findLast=function(b){return this.reverse().find(b)},F.prototype.invokeMap=z(function(b,d){return"function"==typeof b?new F(this):this.map(function(e){return Fb(e,b,d)})}),F.prototype.reject=function(b){return b=A(b,3),this.filter(function(d){return!b(d)})},F.prototype.slice=function(b,d){b=G(b);var e=this;return e.__filtered__&&
(0<b||0>d)?new F(e):(0>b?e=e.takeRight(-b):b&&(e=e.drop(b)),d!==p&&(d=G(d),e=0>d?e.dropRight(-d):e.take(d-b)),e)},F.prototype.takeRightWhile=function(b){return this.reverse().takeWhile(b).reverse()},F.prototype.toArray=function(){return this.take(4294967295)},Da(F.prototype,function(b,d){var e=/^(?:filter|find|map|reject)|While$/.test(d),a=/^(?:head|last)$/.test(d),c=g[a?"take"+("last"==d?"Right":""):d],f=a||/^find/.test(d);c&&(g.prototype[d]=function(){var d=this.__wrapped__,m=a?[1]:arguments,h=
d instanceof F,l=m[0],u=h||E(d),n=function(b){return b=c.apply(g,r([b],m)),a&&q?b[0]:b};u&&e&&"function"==typeof l&&1!=l.length&&(h=u=!1);var q=this.__chain__,v=!!this.__actions__.length,l=f&&!q,h=h&&!v;return!f&&u?(d=h?d:new F(this),d=b.apply(d,m),d.__actions__.push({func:ic,args:[n],thisArg:p}),new ra(d,q)):l&&h?b.apply(this,m):(d=this.thru(n),l?a?d.value()[0]:d.value():d)})}),l("pop push shift sort splice unshift".split(" "),function(b){var d=lc[b],e=/^(?:push|sort|unshift)$/.test(b)?"tap":"thru",
a=/^(?:pop|shift)$/.test(b);g.prototype[b]=function(){var b=arguments;return a&&!this.__chain__?d.apply(this.value(),b):this[e](function(e){return d.apply(e,b)})}}),Da(F.prototype,function(b,d){var e=g[d];if(e){var a=e.name+"";(Ib[a]||(Ib[a]=[])).push({name:d,func:e})}}),Ib[bc(p,2).name]=[{name:"wrapper",func:p}],F.prototype.clone=function(){var b=new F(this.__wrapped__);return b.__actions__=ka(this.__actions__),b.__dir__=this.__dir__,b.__filtered__=this.__filtered__,b.__iteratees__=ka(this.__iteratees__),
b.__takeCount__=this.__takeCount__,b.__views__=ka(this.__views__),b},F.prototype.reverse=function(){if(this.__filtered__){var b=new F(this);b.__dir__=-1;b.__filtered__=!0}else b=this.clone(),b.__dir__*=-1;return b},F.prototype.value=function(){var b,d=this.__wrapped__.value(),e=this.__dir__,g=E(d),a=0>e,c=g?d.length:0;b=0;for(var f=c,m=this.__views__,h=-1,l=m.length;++h<l;){var u=m[h],n=u.size;switch(u.type){case "drop":b+=n;break;case "dropRight":f-=n;break;case "take":f=wa(f,b+n);break;case "takeRight":b=
ga(b,f-n)}}if(b={start:b,end:f},f=b.start,m=b.end,b=m-f,a=a?m:f-1,f=this.__iteratees__,m=f.length,h=0,l=wa(b,this.__takeCount__),!g||200>c||c==b&&l==b)return Td(d,this.__actions__);g=[];a:for(;b--&&l>h;){a+=e;c=-1;for(u=d[a];++c<m;){var q=f[c],n=q.type,q=(0,q.iteratee)(u);if(2==n)u=q;else if(!q){if(1==n)continue a;break a}}g[h++]=u}return g},g.prototype.at=$f,g.prototype.chain=function(){return te(this)},g.prototype.commit=function(){return new ra(this.value(),this.__chain__)},g.prototype.flatMap=
function(b){return this.map(b).flatten()},g.prototype.next=function(){this.__values__===p&&(this.__values__=Sc(this.value()));var b=this.__index__>=this.__values__.length,d=b?p:this.__values__[this.__index__++];return{done:b,value:d}},g.prototype.plant=function(b){for(var d,e=this;e instanceof U;){var g=wd(e);g.__index__=0;g.__values__=p;d?a.__wrapped__=g:d=g;var a=g,e=e.__wrapped__}return a.__wrapped__=b,d},g.prototype.reverse=function(){var b=this.__wrapped__;return b instanceof F?(this.__actions__.length&&
(b=new F(this)),b=b.reverse(),b.__actions__.push({func:ic,args:[Pc],thisArg:p}),new ra(b,this.__chain__)):this.thru(Pc)},g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=function(){return Td(this.__wrapped__,this.__actions__)},hb&&(g.prototype[hb]=sf),g}var p,wb=1/0,Zc=NaN,qd=/\b__p\+='';/g,rd=/\b(__p\+=)''\+/g,sd=/(__e\(.*?\)|\b__t\))\+'';/g,Qb=/&(?:amp|lt|gt|quot|#39|#96);/g,Pb=/[&<>"'`]/g,vd=RegExp(Qb.source),md=RegExp(Pb.source),id=/<%-([\s\S]+?)%>/g,jd=/<%([\s\S]+?)%>/g,nc=/<%=([\s\S]+?)%>/g,
vb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Nc=/^\w*$/,hc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,Nb=/[\\^$.*+?()[\]{}|]/g,oc=RegExp(Nb.source),xb=/^\s+|\s+$/g,ud=/^\s+/,td=/\s+$/,Oc=/\\(\\)?/g,od=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gc=/\w*$/,nd=/^0x/i,Yc=/^[-+]0x[0-9a-f]+$/i,Ha=/^0b[01]+$/i,Wc=/^\[object .+?Constructor\]$/,Ea=/^0o[0-7]+$/i,Bb=/^(?:0|[1-9]\d*)$/,Mb=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Ab=/($^)/,pd=/['\n\r\u2028\u2029\\]/g,ad=/[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]/g,
na=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g,Va=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ufe0e\ufe0f]/,
cd=/[a-zA-Z0-9]+/g,bd=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+|[A-Z\xc0-\xd6\xd8-\xde]+|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g,
kc=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,gd="Array Buffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),C={};C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=
C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0;C["[object Arguments]"]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Error]"]=C["[object Function]"]=C["[object Map]"]=C["[object Number]"]=C["[object Object]"]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object WeakMap]"]=!1;var O={};O["[object Arguments]"]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=
O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O["[object Object]"]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0;O["[object Error]"]=O["[object Function]"]=O["[object WeakMap]"]=!1;var Ta={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A",
"\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00c7":"C","\u00e7":"c","\u00d0":"D","\u00f0":"d","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00d1":"N","\u00f1":"n","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o",
"\u00f8":"o","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00dd":"Y","\u00fd":"y","\u00ff":"y","\u00c6":"Ae","\u00e6":"ae","\u00de":"Th","\u00fe":"th","\u00df":"ss"},ya={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},ba={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},ea={"function":!0,object:!0},Za={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},jb=parseFloat,Ia=parseInt,
W=ea[typeof exports]&&exports&&!exports.nodeType?exports:p,xa=ea[typeof module]&&module&&!module.nodeType?module:p,Xa=xa&&xa.exports===W?W:p,Ya=U(W&&xa&&"object"==typeof global&&global),Ra=U(ea[typeof self]&&self),Y=U(ea[typeof window]&&window),ea=U(ea[typeof this]&&this),oa=Ya||Y!==(ea&&ea.window)&&Y||Ra||ea||Function("return this")(),u=Cb();(Y||Ra||{})._=u;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("third_party/lo-dash/lo-dash.min",[],function(){return u}):W&&xa?(Xa&&
((xa.exports=u)._=u),W._=u):oa._=u}).call(this);
define("qowtRoot/utils/typeUtils",[],function(){function f(a,c,f){if(f.types.every(function(a){var c=h[a];if(!c)throw Error("Bad config to checkArgTypes: unknown type: "+a);return!c(f.value)})){var q=1===f.types.length?f.types[0]:"["+f.types.join(",")+"]";throw Error("Argument "+c+" passed to function "+a+" was supposed to be of type "+q+" but had value "+f.value);}}var c={checkArgTypes:function(a,c){for(var h in c){var q={value:c[h][0],types:c[h].slice(1)};f(a,h,q)}},isObject:function(a){return"object"===
typeof a&&null!==a},isPromise:function(a){return a instanceof Promise},isPromiseLike:function(a){return!(!a||!c.isFunction(a.then))},isList:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isNumber:function(a){return"number"===typeof a&&!isNaN(a)},isInteger:function(a){return"number"===typeof a&&parseInt(a,10)===a},isFunction:function(a){return"function"===typeof a},isString:function(a){return"[object String]"===Object.prototype.toString.call(a)},isRegex:function(a){return"[object RegExp]"===
Object.prototype.toString.call(a)},isNode:function(a){return a instanceof Node},isNull:function(a){return null===a},isUndefined:function(a){return void 0===a},isBoolean:function(a){return"boolean"===typeof a},getType:function(a){var c;Object.keys(h).forEach(function(f){h[f](a)&&(c=f)});return c},isArgumentsObjectOrList:function(a){return a instanceof Object&&a.hasOwnProperty("length")},extend:function(a,c){for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f])},createNewType:function(a){var c=function(){},
f={isOfType:function(a){return void 0!==a&&null!==a&&a.constructor===c},markAsType:function(a){Object.defineProperty(a,"constructor",{value:c,configurable:!1,writable:!1,enumerable:!1});return a}};if(a){if(h[a])throw Error("Already registered type "+a);h[a]=f.isOfType}return f}},h={string:c.isString,object:c.isObject,promise:c.isPromise,promiseLike:c.isPromiseLike,node:c.isNode,regex:c.isRegex,"function":c.isFunction,number:c.isNumber,list:c.isList,boolean:c.isBoolean,"null":c.isNull,undefined:c.isUndefined};
return c});
define("qowtRoot/configs/common",[],function(){var f={SUPPORTED_IMAGE_FORMATS:{jpg:!0,jpeg:!0,gif:!0,png:!0,pic:!1,pict:!1,bmp:!0,tif:!0,tiff:!0},ZOOM:{current:void 0,next:void 0,levels:void 0},LAYOUT_DEFAULT_MAXZOOM:void 0,LAYOUT_DEFAULT_MINZOOM:void 0,LAYOUT_DEFAULT_ZOOM_LEVEL:void 0,DOC_VERIFY_DEBOUNCE:50,DEFAULT_COLORS:"#6B9CD4 #DE7872 #B7D37C #A48CC2 #6CC7E1 #F3AB63 #AEC8EE".split(" "),TEXT_STYLE:{defaultHighlightColor:"rgb(255, 255, 255)",defaultTxtColor:"rgb(0, 0, 0)",shadowText:{setValue:"#000000 0.07em 0.07em 0.07em",getValue:"rgb(0, 0, 0) 0.07em 0.07em 0.07em"},
outlineText:{webkitTextFillColor:"transparent",webkitTextStroke:".05em #000000",webkitTextStrokeWidth:"0.05em",webkitTextStrokeColor:"rgb(0, 0, 0)"},embossedText:{setColor:"#ffffff",getColor:"rgb(255, 255, 255)",setShadow:"#000000 1px 1px 2px",getShadow:"rgb(0, 0, 0) 1px 1px 2px"},engravedText:{setColor:"#999999",getColor:"rgb(153, 153, 153)",setShadow:"#000000 -1px -1px 2px",getShadow:"rgb(0, 0, 0) -1px -1px 2px"}},DEFAULT_BLIP_FILL_PROPERTIES:{tileProps:{Sx:100,Sy:100,Tx:0,Ty:0,align:"TL"},type:"tileFill"},
kMESSAGE_BUS_CONNECTION_RETRY:10,kMESSAGE_BUS_CONNECTION_TIMEOUT:3E4,kMESSAGE_BUS_CONNECTION_TIMEOUT_MSG:"MessageBus: Connection timeout",create:function(){return{SUPPORTED_IMAGE_FORMATS:f.SUPPORTED_IMAGE_FORMATS,DIALOGUE_CONFIG:f.DIALOGUE_CONFIG,DEFAULT_COLORS:f.DEFAULT_COLORS,ZOOM:f.ZOOM,LAYOUT_DEFAULT_MAXZOOM:f.LAYOUT_DEFAULT_MAXZOOM,LAYOUT_DEFAULT_MINZOOM:f.LAYOUT_DEFAULT_MINZOOM,LAYOUT_DEFAULT_ZOOM_LEVEL:f.LAYOUT_DEFAULT_ZOOM_LEVEL}}};return f});
(function(f){f("qowtRoot/third_party/when/lib/timer",["require"],function(c){return{set:setTimeout,clear:clearTimeout}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});
(function(f){f("qowtRoot/third_party/when/lib/timed",[],function(){return function(c,f,a){a.prototype.delay=function(a){var f=this;return new this.constructor(function(h,t,m){f.then(function(f){c(function(){h(f)},a)},t,m)})};a.prototype.timeout=function(a,n){var q=this,t=1<arguments.length;return new this.constructor(function(m,v,r){var w=c(function(){v(t?n:Error("timed out after "+a+"ms"))},a);q.then(function(a){f(w);m(a)},function(a){f(w);v(a)},r)})};return a}})})("function"===typeof define&&define.amd?
define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/array",[],function(){return function(c){var f=Array.prototype.map,a=Array.prototype.reduce,l=Array.prototype.reduceRight,n=Array.prototype.forEach,q=c.resolve,t=c.all;c.any=function(a){return new c(function(c,f){function h(a){t.push(a);0===--l&&f(t)}var l=0,t=[];n.call(a,function(a){++l;q(a).then(c,h)});0===l&&c()})};c.some=function(a,f){return new c(function(c,h,l){function t(a){0<x&&(--x,B.push(a),0===x&&c(B))}function D(a){0<y&&(--y,M.push(a),0===y&&
h(M))}var x=0,y,B=[],M=[];n.call(a,function(a){++x;q(a).then(t,D,l)});f=Math.max(f,0);y=x-f+1;x=Math.min(f,x);0===x&&c(B)})};c.settle=function(a){return t(f.call(a,function(a){function c(){return a.inspect()}a=q(a);return a.then(c,c)}))};c.map=function(a,c,l){return t(f.call(a,function(a){return q(a).then(c,l)}))};c.reduce=function(c,f){function h(a,c,m){return q(a).then(function(a){return q(c).then(function(c){return f(a,c,m)})})}return 2<arguments.length?a.call(c,h,arguments[2]):a.call(c,h)};c.reduceRight=
function(a,c){function f(a,h,m){return q(a).then(function(a){return q(h).then(function(f){return c(a,f,m)})})}return 2<arguments.length?l.call(a,f,arguments[2]):l.call(a,f)};c.prototype.spread=function(a){return this.then(t).then(function(c){return a.apply(void 0,c)})};return c}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/fatal",["require","./timer"],function(c){var f=c("./timer").set;return function(a){f(function(){throw a;},0)}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});
(function(f){f("qowtRoot/third_party/when/lib/flow",["require","./fatal"],function(c){function f(){throw new TypeError("catch predicate must be a function");}function a(a,c){return function(){a.call(this);return c}}function l(){}var n=c("./fatal");return function(c){function t(a,c){return function(f){return(c===Error||null!=c&&c.prototype instanceof Error?f instanceof c:c(f))?a.call(this,f):v(f)}}var m=c.resolve,v=c.reject,r=c.prototype["catch"];c.prototype.done=function(a,c){var f=this._handler;
f.when(this._maybeFatal,l,this,f.receiver,a,c)};c.prototype._maybeFatal=function(a){if(Object(a)===a)m(a)["catch"](this._fatal)};c.prototype._fatal=n;c.prototype["catch"]=c.prototype.otherwise=function(a){return 1===arguments.length?r.call(this,a):"function"!==typeof a?this.ensure(f):r.call(this,t(arguments[1],a))};c.prototype["finally"]=c.prototype.ensure=function(c){if("function"!==typeof c)return this;c=a(c,this);return this.then(c,c)};c.prototype["else"]=c.prototype.orElse=function(a){return this.then(void 0,
function(){return a})};c.prototype.yield=function(a){return this.then(function(){return a})};c.prototype.tap=function(a){return this.then(a).yield(this)};return c}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});(function(f){f("qowtRoot/third_party/when/lib/inspect",[],function(){return function(c){c.prototype.inspect=function(){return this._handler.inspect()};return c}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/iterate",[],function(){return function(c){function f(a,c,t,m){function v(m){return l(t(m)).then(function(){return f(a,c,t,a(m))})}return l(m).then(function(a){return l(c(a)).then(function(c){return c?a:v(a)})})}function a(c,f,h,m){function v(m,v){return l(h(m)).then(function(){return a(c,f,h,v)})}return l(m).then(function(a){return l(f(a)).then(function(f){return f?a:l(c(a)).spread(v)})})}var l=c.resolve;c.iterate=f;c.unfold=a;return c}})})("function"===
typeof define&&define.amd?define:function(f){module.exports=f()});(function(f){f("qowtRoot/third_party/when/lib/progress",[],function(){return function(c){c.prototype.progress=function(c){return this.then(void 0,void 0,c)};return c}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/with",[],function(){return function(c){c.prototype["with"]=c.prototype.withThis=c.prototype._bindContext;return c}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/makePromise",[],function(){return function(c){function f(c){var m=this;this._handler=new w;a(c,function(a){m._handler.resolve(a)},function(a){m._handler.reject(a)},function(a){m._handler.notify(a)})}function a(a,c,f,m){try{a(c,f,m)}catch(h){f(h)}}function l(a){return new n(new K(new y(a)))}function n(a){this._handler=a}function q(a,c){if(a instanceof f){var l=a._handler.join();return c===l?new y(new TypeError("Promise cycle")):l}return X(a)?m(a):new x(a)}
function t(a){return a instanceof f?a._handler.join():m(a)}function m(a){try{var c=a.then;return"function"===typeof c?new D(c,a):new x(a)}catch(f){return new y(f)}}function v(){}function r(a){this.handler=a;if(this._isMonitored()){var c=this._env.promiseMonitor.captureStack();this.trace=a._addTrace(c)}}function w(a){this.consumers=[];this.receiver=a;this.handler=void 0;this.resolved=!1;this._isMonitored()&&(this.trace=this._env.promiseMonitor.captureStack())}function K(a){r.call(this,a)}function I(a,
c){r.call(this,a);this.receiver=c}function D(a,c){w.call(this);this.assimilated=!1;this.untrustedThen=a;this.thenable=c}function x(a){this.value=a}function y(a){this.value=a;this.observed=!1;this._isMonitored()&&(this.key=this._env.promiseMonitor.startTrace(a))}function B(){return{state:"pending"}}function M(a,c,f,m,h,e,l,n){this.a=a;this.b=c;this.c=f;this.d=m;this.e=h;this.f=e;this.g=l;this.handler=n}function fa(a,c){this.q=a;this.value=c}function X(a){return("object"===typeof a||"function"===typeof a)&&
null!==a}function P(a,c,f){try{return a.call(f,c)}catch(m){return l(m)}}function N(){}var Z,T=c.scheduler,R=Object.create||function(a){function c(){}c.prototype=a;return new c};f.resolve=function(a){return a instanceof f?a:new n(new K(q(a)))};f.reject=l;f.never=function(){return Z};f._defer=function(){return new n(new w)};f.prototype.then=function(a,c,f){var m=this._handler,h=new w(m.receiver);m.when(h.resolve,h.notify,h,m.receiver,a,c,f);return new n(h)};f.prototype["catch"]=f.prototype.otherwise=
function(a){return this.then(void 0,a)};f.prototype._bindContext=function(a){return new n(new I(this._handler,a))};f.all=function(a){function c(e,a,f,m){f.when(N,N,void 0,e,function(e){a[m]=e;0===--h&&this.resolve(a)},e.reject,e.notify)}var f=new w,m=a.length>>>0,h=m,e=[],l,q;for(l=0;l<m;++l)l in a?(q=a[l],X(q)?c(f,e,t(q),l):(e[l]=q,--h)):--h;0===h&&f.resolve(e);return new n(f)};f.race=function(a){if(Object(a)===a&&0===a.length)return Z;for(var c=new w,f=0;f<a.length;++f)q(a[f]).when(N,N,void 0,c,
c.resolve,c.reject);return new n(c)};n.prototype=R(f.prototype);v.prototype.inspect=B;v.prototype.when=N;v.prototype.resolve=N;v.prototype.reject=N;v.prototype.notify=N;v.prototype.join=function(){return this};v.prototype._env=c.monitor||f;v.prototype._addTrace=N;v.prototype._isMonitored=function(){return"undefined"!==typeof this._env.promiseMonitor};r.prototype=R(v.prototype);r.prototype.join=function(){return this.handler.join()};r.prototype.inspect=function(){return this.handler.inspect()};r.prototype._addTrace=
function(a){return this.handler._addTrace(a)};w.prototype=R(v.prototype);w.prototype.inspect=function(){return this.resolved?this.handler.join().inspect():B()};w.prototype.resolve=function(a){this._join(q(a,this))};w.prototype.reject=function(a){this._join(new y(a))};w.prototype.join=function(){return this.resolved?this.handler.join():this};w.prototype.run=function(){var a=this.consumers,c=this.handler=this.handler.join();this.consumers=void 0;for(var f=0;f<a.length;f+=7)c.when(a[f],a[f+1],a[f+2],
a[f+3],a[f+4],a[f+5],a[f+6])};w.prototype._join=function(a){this.resolved||(this.resolved=!0,this.handler=a,T.enqueue(this),this._isMonitored()&&(this.trace=a._addTrace(this.trace)))};w.prototype.when=function(a,c,f,m,h,e,l){this.resolved?T.enqueue(new M(a,c,f,m,h,e,l,this.handler.join())):this.consumers.push(a,c,f,m,h,e,l)};w.prototype.notify=function(a){this.resolved||T.enqueue(new fa(this.consumers,a))};w.prototype._addTrace=function(a){return this.resolved?this.handler._addTrace(a):a};K.prototype=
R(r.prototype);K.prototype.when=function(a,c,f,m,h,e,l){T.enqueue(new M(a,c,f,m,h,e,l,this.join()))};I.prototype=R(r.prototype);I.prototype.when=function(a,c,f,m,h,e,l){void 0!==this.receiver&&(m=this.receiver);this.join().when(a,c,f,m,h,e,l)};D.prototype=R(w.prototype);D.prototype.when=function(a,c,f,m,h,e,l){this.assimilated||(this.assimilated=!0,this._assimilate());w.prototype.when.call(this,a,c,f,m,h,e,l)};D.prototype._assimilate=function(){var a=this;this._try(this.untrustedThen,this.thenable,
function(c){a.resolve(c)},function(c){a.reject(c)},function(c){a.notify(c)})};D.prototype._try=function(a,c,f,m,h){try{a.call(c,f,m,h)}catch(e){m(e)}};x.prototype=R(v.prototype);x.prototype.inspect=function(){return{state:"fulfilled",value:this.value}};x.prototype.when=function(a,c,f,m,h){c="function"===typeof h?P(h,this.value,m):this.value;a.call(f,c)};y.prototype=R(v.prototype);y.prototype.inspect=function(){return{state:"rejected",reason:this.value}};y.prototype.when=function(a,c,f,m,h,e){this._isMonitored()&&
!this.observed&&this._env.promiseMonitor.removeTrace(this.key);this.observed=!0;c="function"===typeof e?P(e,this.value,m):l(this.value);a.call(f,c)};y.prototype._addTrace=function(a){this.observed||this._env.promiseMonitor.updateTrace(this.key,a)};Z=new n(new v);M.prototype.run=function(){this.handler.when(this.a,this.b,this.c,this.d,this.e,this.f,this.g)};fa.prototype.run=function(){for(var a=this.q,c=1;c<a.length;c+=7)this._notify(a[c],a[c+1],a[c+2],a[c+5])};fa.prototype._notify=function(a,c,f,
m){var h;if("function"===typeof m)try{h=m.call(f,this.value)}catch(e){h=e}else h=this.value;a.call(c,h)};return f}})})("function"===typeof define&&define.amd?define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/Queue",[],function(){function c(c){this.head=this.tail=this.length=0;this.buffer=Array(1<<c)}c.prototype.push=function(c){this.length===this.buffer.length&&this._ensureCapacity(2*this.length);this.buffer[this.tail]=c;this.tail=this.tail+1&this.buffer.length-1;++this.length;return this.length};c.prototype.shift=function(){var c=this.buffer[this.head];this.buffer[this.head]=void 0;this.head=this.head+1&this.buffer.length-1;--this.length;return c};c.prototype._ensureCapacity=
function(c){var a=this.head,f=this.buffer,n=Array(c),q=0,t;if(0===a)for(t=this.length;q<t;++q)n[q]=f[q];else{c=f.length;for(t=this.tail;a<c;++q,++a)n[q]=f[a];for(a=0;a<t;++q,++a)n[q]=f[a]}this.buffer=n;this.head=0;this.tail=this.length};return c})})("function"===typeof define&&define.amd?define:function(f){module.exports=f()});
(function(f){f("qowtRoot/third_party/when/lib/scheduler",["require","./Queue"],function(c){function f(c){this._enqueue=c;this._handlerQueue=new a(15);var h=this;this.drainQueue=function(){h._drainQueue()}}var a=c("./Queue");f.prototype.enqueue=function(a){1===this._handlerQueue.push(a)&&this._enqueue(this.drainQueue)};f.prototype._drainQueue=function(){for(var a=this._handlerQueue;0<a.length;)a.shift().run()};return f})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});
(function(f){f("qowtRoot/third_party/when/lib/async",["require"],function(c){var f;return"undefined"!==typeof process&&null!==process&&"function"===typeof process.nextTick?function(a){process.nextTick(a)}:(f="function"===typeof MutationObserver&&MutationObserver||"function"===typeof WebKitMutationObserver&&WebKitMutationObserver)?function(a,c){var f,h=a.createElement("div");(new c(function(){var a=f;f=void 0;a()})).observe(h,{attributes:!0});return function(a){f=a;h.setAttribute("class","x")}}(document,
f):function(a){var c=setTimeout;return function(a){c(a,0)}}(c)})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});(function(f){f("qowtRoot/third_party/when/lib/Promise",["require","./makePromise","./scheduler","./async"],function(c){var f=c("./makePromise"),a=c("./scheduler");c=c("./async");return f({scheduler:new a(c),monitor:"undefined"!==typeof console?console:void 0})})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});
(function(f){f("qowtRoot/third_party/when/when","require ./lib/timer ./lib/timed ./lib/array ./lib/flow ./lib/inspect ./lib/iterate ./lib/progress ./lib/with ./lib/Promise".split(" "),function(c){function f(a,c,m,h){var l=y(a);return 2>arguments.length?l:l.then(c,m,h)}function a(a){return function(){return n(a,this,B.call(arguments))}}function l(a){return n(a,this,B.call(arguments,1))}function n(a,c,f){return x.all(f).then(function(f){return a.apply(c,f)})}function q(){function a(c){m._handler.resolve(c)}
function c(a){m._handler.reject(a)}function f(a){m._handler.notify(a)}var m=x._defer();this.promise=m;this.resolve=a;this.reject=c;this.notify=f;this.resolver={resolve:a,reject:c,notify:f}}var t=c("./lib/timer"),m=c("./lib/timed"),v=c("./lib/array"),r=c("./lib/flow"),w=c("./lib/inspect"),K=c("./lib/iterate"),I=c("./lib/progress"),D=c("./lib/with"),x=c("./lib/Promise"),x=[v,r,K,I,w,D].reduceRight(function(a,c){return c(a)},m(t.set,t.clear,x)),y=x.resolve,B=Array.prototype.slice;f.promise=function(a){return new x(a)};
f.resolve=x.resolve;f.reject=x.reject;f.lift=a;f["try"]=l;f.attempt=l;f.iterate=x.iterate;f.unfold=x.unfold;f.join=function(){return x.all(arguments)};f.all=function(a){return f(a,x.all)};f.settle=function(a){return f(a,x.settle)};f.any=a(x.any);f.some=a(x.some);f.map=function(a,c){return f(a,function(a){return x.map(a,c)})};f.reduce=function(a,c){var m=B.call(arguments,1);return f(a,function(a){m.unshift(a);return x.reduce.apply(x,m)})};f.reduceRight=function(a,c){var m=B.call(arguments,1);return f(a,
function(a){m.unshift(a);return x.reduceRight.apply(x,m)})};f.isPromiseLike=function(a){return a&&"function"===typeof a.then};f.Promise=x;f.defer=function(){return new q};return f})})("function"===typeof define&&define.amd?define:function(f){module.exports=f(require)});
define("qowtRoot/messageBus/messageBusImpl",["qowtRoot/utils/typeUtils","qowtRoot/configs/common","qowtRoot/third_party/when/when"],function(f,c,h){var a=function(a){this.myWin_=a||window;this.pendingConnections_=[];this.acceptedConnections_=[];this.completedConnections_=[];this.acknowledgements_=[];this.listeners_=[];this.msgQueue_=[];this.pendingMsgs_=[];this.myWin_.addEventListener("message",this.handleIncomingMessage_.bind(this),!1)};a.prototype=Object.create(Object.prototype);a.prototype.constructor=
a;a.prototype.connect=function(a,c){if(!a||null===a||!f.isObject(a)||!a.postMessage)throw Error("MessageBus: A valid HTML window object has not been provided to connect()");if(a===this.myWin_)throw Error("MessageBus: Trying to connect to its own window");if(c&&!f.isFunction(c))throw Error("MessageBus: The provided callback function is not of the correct type");for(var l=this.pendingConnections_.length,n=0;n<l;n++)if(this.pendingConnections_[n].win===a)throw Error("MessageBus: Trying to connect to a window that we are already trying to connect to");
l=this.acceptedConnections_.length;for(n=0;n<l;n++)if(this.acceptedConnections_[n].win===a)throw Error("MessageBus: Trying to connect to a window that we are already trying to connect to");l=this.completedConnections_.length;for(n=0;n<l;n++)if(this.completedConnections_[n].win===a)throw Error("MessageBus: Trying to connect to a window that has already been connected");l={win:a,callback:c,currentWaitTime:0,deferred:h.defer()};this.pendingConnections_.push(l);this.tryToConnect_(l);return l.deferred.promise};
a.prototype.pushMessage=function(a){if(!f.isObject(a))throw Error("MessageBus: A valid message object has not been provided to pushMessage()");var c=this.completedConnections_.length;if(0===c)this.pendingMsgs_.push(a);else{if(!f.isObject(a))throw Error("Cannot mark non-object value as quickoffice message");a.qoMessageBus=!0;this.msgQueue_.length>=l&&this.msgQueue_.shift();this.msgQueue_.push(a);for(var h=0;h<c;h++)this.completedConnections_[h].win.postMessage(a,"*")}};a.prototype.listen=function(a,
c){if(!f.isFunction(a))throw Error("MessageBus: A valid listener function has not been provided to listen()");if(c&&!f.isFunction(c))throw Error("MessageBus: The provided filter function is not of the correct type");this.listeners_.push({listener:a,filter:c})};a.prototype.stopListening=function(a){if(!f.isFunction(a))throw Error("MessageBus: A valid listener function has not been provided to stopListening()");for(var c=this.listeners_.length,h=0;h<c;h++)if(this.listeners_[h].listener===a){this.listeners_.splice(h,
1);break}};a.prototype.isConnectedTo=function(a){for(var c=!1,f=this.completedConnections_.length,h=0;h<f;h++)if(a===this.completedConnections_[h].win){c=!0;break}return c};a.prototype.tryToConnect_=function(a){a.currentWaitTime>c.kMESSAGE_BUS_CONNECTION_TIMEOUT?this.handleTimeOut_(a):(a.currentWaitTime+=c.kMESSAGE_BUS_CONNECTION_RETRY,-1!==this.pendingConnections_.indexOf(a)&&a.win.postMessage(n,"*"),a.timeoutId=setTimeout(this.tryToConnect_.bind(this,a),c.kMESSAGE_BUS_CONNECTION_RETRY))};a.prototype.handleTimeOut_=
function(a){var f=c.kMESSAGE_BUS_CONNECTION_TIMEOUT_MSG;window.connectFromAppToQowt&&(f=window.connectFromQowtToApp?Math.abs(Math.round(window.connectFromQowtToApp-window.connectFromAppToQowt)/1E3)>Math.round(c.kMESSAGE_BUS_CONNECTION_TIMEOUT/1E3*.8)?f+":qowt too late to connect":f+":qowt and app connected:handshake failed?":f+":qowt failed to connect");a.deferred.reject(Error(f))};a.prototype.handleIncomingMessage_=function(a){if(a){if(-1!==this.msgQueue_.indexOf(a.data))throw Error("MessageBus: A message that was pushed onto thisbus has arrived back on it - we have a circular dependancy!");
a.data===n?this.handleConnectionRequestMsg_(a):a.data===q?this.handleConnectionAcceptedMsg_(a):a.data===t?this.handleConnectionAckMsg_(a):a&&a.data&&!0===a.data.qoMessageBus&&("chrome-extension://gbkeegbaiigmenfmjfclcdgdpimamgkj"===a.origin||"chrome-extension://bpmcpldpdmajfigpchkicefoigmkfalc"===a.origin||"chrome-extension://ehibbfinohgbchlgdbfpikodjaojhccn"===a.origin)&&this.handleClientMsg_(a)}};a.prototype.handleConnectionRequestMsg_=function(a){if(!a.source)throw Error("MessageBus: Unknown source of qoConnectionRequest message");
a.source.postMessage(q,"*")};a.prototype.handleConnectionAcceptedMsg_=function(a){if(!a.source)throw Error("MessageBus: Unknown source of qoConnectionAccepted message");for(var c=this.pendingConnections_.length,f=0;f<c;f++)if(this.pendingConnections_[f].win===a.source){c=this.pendingConnections_.splice(f,1)[0];a=this.acknowledgements_.indexOf(a.source);-1===a?this.acceptedConnections_.push(c):(this.acknowledgements_.splice(a,1),this.connectionCompleted_(c));c.win.postMessage(t,"*");break}};a.prototype.handleConnectionAckMsg_=
function(a){if(!a.source)throw Error("MessageBus: Unknown source of qoConnectionAck message");for(var c=this.acceptedConnections_.length,f=0;f<c;f++)if(this.acceptedConnections_[f].win===a.source){a=this.acceptedConnections_.splice(f,1)[0];this.connectionCompleted_(a);return}this.acknowledgements_.push(a.source)};a.prototype.handleClientMsg_=function(a){if(a.source){for(var c=this.listeners_.slice(),f=c.length,h=0;h<f;h++){var l=c[h];!l||l.filter&&!l.filter.call(this,a)||l.listener.call(this,a)}f=
this.completedConnections_.length;for(h=0;h<f;h++)this.completedConnections_[h].win!==a.source&&this.completedConnections_[h].win.postMessage(a.data,"*")}};a.prototype.connectionCompleted_=function(a){this.completedConnections_.push(a);clearTimeout(a.timeoutId);for(a.callback&&a.callback.call(this);0<this.pendingMsgs_.length;)this.pushMessage(this.pendingMsgs_.shift());a.deferred.resolve()};var l=10,n="qoConnectionRequest",q="qoConnectionAccepted",t="qoConnectionAck";return a});
define("qowtRoot/messageBus/messageBus",["qowtRoot/messageBus/messageBusImpl"],function(f){return new f});
define("qowtRoot/pubsub/pubsub",["third_party/lo-dash/lo-dash.min"],function(){function f(a,f){var h=[],l=[],q=[],I=[];n[a]&&n[a].length&&(t++,n[a].forEach(function(a){a.config.after?l.push(a):h.push(a);a.config.once&&I.push(a)}),h.concat(l).forEach(function(c){q.push(c.callback(a,f))}),I.forEach(function(a){c(a.token)}));return Promise.all(q)}function c(a){var c;_.values(n).some(function(f){return f.some(function(h,l){return h.token===a?(c=f.splice(l,1)[0],!0):!1})});return c}function h(a){var c=
0;return c=a?n[a]?n[a].length:0:_.values(n).reduce(function(a,c){return a+c.length},0)}function a(){n={}}var l=Object.create(Object.prototype,{subscriberCount:{get:function(){return h()}},registeredSignals:{get:function(){return _.keys(n)}},publishCount:{get:function(){return t}}});l.subscribe=function(a,c,f){if(!_.isString(a)||!a)throw new TypeError("invalid signal");if(!_.isFunction(c))throw new TypeError("invalid callback");f=f||{};f.once=!!f.once;f.after=!!f.after;var h=(++q).toString();n[a]=
n[a]||[];n[a].push({token:h,callback:c,config:f});return h};l.publish=function(a,c){if(!_.isString(a)||!a)throw new TypeError("invalid signal");c=c||{};return f(a,c)};l.doAction=function(a,c){if(!_.isString(a)||!a)throw new TypeError("invalid action");c=c||{};c=_.isString(c)?{contentType:c}:c;return f("qowt:doAction",{action:a,context:c})};l.unsubscribe=function(a){if(void 0!==a){if(!_.isString(a)||!a)throw new TypeError("invalid token");return c(a)}};l.subscriberCountForSignal=function(a){if(!_.isString(a)||
!a)throw new TypeError("invalid signal");return h(a)};l.clear=a;l.reset=function(){a();t=q=0};var n={},q=0,t=0;return l});(function(){var f={},c=window.sessionStorage.getItem("featureOverrides");c&&(f=JSON.parse(c));f.isRelease=!0;f.edit=!1;window.sessionStorage.setItem("featureOverrides",JSON.stringify(f));window.localStorage.removeItem("testsToInclude");window.localStorage.removeItem("builtInTests")})();define("configs/releaseFeatures",function(){});
(function(){var f={},c=window.sessionStorage.getItem("featureOverrides");c&&(f=JSON.parse(c));f.save=!!(window.chrome&&window.chrome.fileSystem&&window.chrome.fileSystem.chooseEntry);window.sessionStorage.setItem("featureOverrides",JSON.stringify(f))})();define("configs/chromeFeatures",function(){});define("qowtRoot/features/pack",[],function(){return{edit:!0,save:!1,pointEdit:!1,hats:!0}});
define("qowtRoot/features/utils",["qowtRoot/features/pack"],function(f){var c={isEnabled:function(a){a=f[a];return void 0===a?!1:a},enable:function(a){f[a]=!0},disable:function(a){f[a]=!1},setOverrides:function(a){for(var c in a)a.hasOwnProperty(c)&&(f[c]=a[c])},isDebug:function(){return void 0!==h?h:!c.isEnabled("isRelease")},setDebugOverride:function(a){h=a},clearDebugOverride:function(){h=void 0}},h;return c});
define("qowtRoot/utils/promiseUtils",["qowtRoot/utils/typeUtils","qowtRoot/third_party/when/when"],function(f,c){var h={cast:function(a){return a instanceof Promise?a:Promise.resolve(a)},delay:function(a,c){a=a||0;return new Promise(function(f){setTimeout(f.bind(void 0,c),a)})},delayThenReject:function(a,c){a=a||0;return new Promise(function(f,h){setTimeout(h.bind(f,c),a)})},throwAndEscapeChain:function(a){a instanceof Error||(console.error("throwAndEscapeChain wrapping value in new Error: ",a),a=
Error(a));c.reject(a).done();throw a;},pipeline:function(a){function c(){for(var q=Array.prototype.slice.call(arguments,0);0<a.length;){var m=a.shift();if(f.isPromiseLike(m))return h.cast(m).then(function(f){a.unshift(f);return c.apply(n,q)});f.checkArgTypes("PromiseUtils.pipeline",{task:[m,"function"]});m=m.apply(n,q);if(f.isPromiseLike(m))return h.cast(m).then(function(a){return c(a)});q=[m]}return q[0]}var n=this,q=Array.prototype.slice.call(arguments,0);if(q.some(f.isPromiseLike))return Promise.all(q).then(function(a){return h.pipeline.apply(n,
a)});f.checkArgTypes("PromiseUtils.pipeline",{tasks:[a,"list"]});a=a.slice(0);return c.apply(n,q.slice(1))},finally:function(a,c){function f(){return h.cast(c()).then(function(){return a})}return h.cast(a).then(f,f)},waitForNextMacroTurn:function(a){return new Promise(function(c){window.setTimeout(c.bind(null,a),0)})}};return h});
define("qowtRoot/utils/platform",[],function(){var f=Object.create(Object.prototype,{name:{get:function(){return c}},locale:{get:function(){return h}},isOther:{get:function(){return"OTHER"===c}},isUnix:{get:function(){return"UNIX"===c}},isWindows:{get:function(){return"WINDOWS"===c}},isOsx:{get:function(){return"OSX"===c}},isLinux:{get:function(){return"LINUX"===c}},isCros:{get:function(){return"CROS"===c}}}),c,h;(function(){c="OTHER";var a=navigator.appVersion.toLowerCase();-1!==a.indexOf("x11")&&
(c="UNIX");-1!==a.indexOf("win")&&(c="WINDOWS");-1!==a.indexOf("mac")&&(c="OSX");-1!==a.indexOf("linux")&&(c="LINUX");-1!==a.indexOf("cros")&&(c="CROS");h=navigator.language.toUpperCase()})();return f});
define("utils/analytics/googleAnalytics",["qowtRoot/features/utils","qowtRoot/utils/promiseUtils","qowtRoot/utils/platform"],function(f,c,h){function a(e,a){var c;void 0!==T?c=T?Promise.resolve():Promise.reject(Error("ga permission cached (not permitted)")):(chrome&&chrome.metricsPrivate&&chrome.metricsPrivate.getIsCrashReportingEnabled&&(!f.isDebug()||void 0!==window.__gaMock)?c=Promise.resolve():(console.warn("GA not supported on this platform"),c=Promise.reject(Error("GA not supported on this platform"))),
c=c.then(l).catch(t));return c.then(m).then(e.bind(null,a)).catch(function(){})}function l(){var e=Error("Crash reporting setting timed out");return Promise.race([n(),c.delayThenReject(1E3,e)]).then(q)}function n(){return new Promise(function(e){chrome.metricsPrivate.getIsCrashReportingEnabled(e)})}function q(e){return new Promise(function(a,c){window.__gaMock&&(R=window.__gaMock.ga4TestUpdate(N));(T=e)?a():(console.warn("Crash reporting not allowed"),c())})}function t(){T=!1;return Promise.reject()}
function m(){void 0===U&&v("QO");return Promise.resolve()}function v(e){if(U=e)pa=e,r(pa);window.__gaMock&&R.setTracker(X[e]);return Promise.resolve()}function r(e){Z!==e&&(pa=Z=e,window.__gaMock&&R.sendState(e),D({name:"page_view"}));return Promise.resolve()}function w(e){var a={name:"exception",parameters:{}};a.parameters.description=e.msg;a.parameters.fatal=e.fatal;window.__gaMock&&R.sendException(e.msg,e.fatal);D(a);return Promise.resolve()}function K(e){if(6E4>=e.value)return"Percentile99th";
if(6E4<e.value&&12E5>=e.value)return"Percentile99.90th";if(12E5<e.value)return"Percentile99.99th"}function I(e){window.__gaMock&&(y(),R.sendEvent(e.category,e.action,Q));D(e);return Promise.resolve()}function D(e){var a=X[U],c=P[U];e.name=e.name?e.name:e.action;M().then(function(f){try{fetch(fa+"?measurement_id="+a+"&api_secret="+c,{method:"POST",body:JSON.stringify({client_id:f,timestamp_micros:1E3*(new Date).getTime(),events:[B(e)]})})}catch(h){console.error("Google Analytics request failed with an exception",
h)}})}function x(e){if("10.0"===e)return"10";if("6.2"===e)return"8";if("6.1"===e)return"7";if("6.0"===e)return"Vista";if("5.1"===e)return"XP";if("5.0"===e)return"2000";e}function y(){if(!Q){Q={engagement_time_msec:100};Q.session_id=window.__gaMock?"":H;Q.app_version=window.__gaMock?"":chrome.runtime.getManifest().version;Q.user_language=h.locale;Q.operating_system="LINUX"===h.name?"Linux":"WINDOWS"===h.name?"Windows":"CROS"===h.name?"Chrome OS":"OSX"===h.name?"Macintosh":h.name;Q.screen_resolution=
window.screen.width+"x"+window.screen.height;Q.viewport=window.innerWidth+"x"+window.innerHeight;var e=Q,a,c=/\(([^)]+)\)/.exec(navigator.userAgent)[1];h.isCros&&-1!==c.indexOf("CrOS")?a=c.match(/CrOS.*\d+(?:\.\d+)+/)[0].replace("CrOS ",""):h.isLinux&&-1!==c.indexOf("Linux")?a=/[^ ]*$/.exec(c)[0]:h.isOsx&&-1!==c.indexOf("Mac OS X")?(a=c.match(/\d+[._]\d+(?:[._]\d+)?/)[0].replaceAll("_","."),1<a.match(/\./g).length&&(a=a.match(/^(\d+\.\d+)/)[0])):h.isWindows&&-1!==c.indexOf("Windows")&&(a=c.match(/\d+(?:\.\d+)+/)[0],
a=x(a));e.operating_system_version=a;Q.app_name=N}}function B(e){var a=e.name.replaceAll("-","_");y();Q.page_title=pa;"CC"===e.action&&"performance-metrics"===e.category?Q.percentile_type=K(e):"CR"===e.action&&"performance-metrics"===e.category&&(Q.percentile_type=K(e));if(!e.parameters||"exception"!==e.name&&"page_view"!==e.name)Q.event_category=e.category,e.label&&(Q.event_label=e.label),e.value&&(Q.value=e.value);else for(var c=Object.keys(e.parameters),f=0;f<c.length;f++)Q[c[f]]=e.parameters[c[f]];
return{name:a,params:Q}}function M(){Ka||(Ka=new Promise(function(e,a){chrome.storage.sync.get("clientId",function(c){if(chrome.runtime.lastError)a(chrome.runtime.lastError);else if("undefined"===typeof c.clientId){var f=self.crypto.randomUUID();c={};c.clientId=f;chrome.storage.sync.set(c,function(){e(f)})}else e(c.clientId)})}));return Ka}var fa="https://www.google-analytics.com/mp/collect",X={word:"G-2EHQ55R09Q",sheet:"G-429ETHTJYR",point:"G-5VSRBT2L9W",QO:"G-11BCJ4LWCJ"},P={word:"esgLzn1kRb6eHxjysYicgQ",
sheet:"v9vcbIqZSe6pTYEryGsfUQ",point:"5uHsbBE-Q3-tHRTfVqEEXg",QO:"k2-sQUVpTZWoDAUgoGUwog"},N="Quickoffice",Z,T,R,H,U,pa,Q,Ka;return{setFileExt:function(e){},setSessionGroup:function(e){H=e},setTracker:function(e){return a(v,e)},sendState:function(e){return a(r,e)},sendException:function(e){return a(w,e)},sendEvent:function(e){return a(I,e)},getMeasurementId:function(e){return X[e]},reset:function(){pa=U=R=T=Z=void 0}}});
define("qowtRoot/utils/i18n",["qowtRoot/utils/typeUtils","utils/analytics/googleAnalytics"],function(f,c){var h={getMessage:function(a,c){var n="????";if(!chrome||!chrome.i18n)return a;f.isString(a)?(n=chrome.i18n.getMessage(a,c),n||(n=a,h.logError_("Missing translation",a))):h.logError_("Invalid string translation Id",a);return n},logError_:function(a,f){console.error(a+" "+f);c.sendException({msg:a,fatal:!1})}};return h});
define("qowtRoot/errors/localisedError",["qowtRoot/utils/typeUtils","qowtRoot/utils/i18n","third_party/lo-dash/lo-dash.min"],function(f,c){var h=function(a){a=a||"";this.name="LocalisedError";f.isObject(a)&&_.extend(this,a);this.message=(this.code?this.code+": ":"")+(this.message||JSON.stringify(a)||this.title||this.details||this.additionalInfo);a.localised||this instanceof QOWTSilentError||(this.title=c.getMessage(this.title),this.details=a.fileName?c.getMessage(this.details,a.fileName):c.getMessage(this.details),
this.linkData&&this.linkData.msg&&(this.linkData.msg=c.getMessage(this.linkData.msg)||this.linkData.msg));Error.captureStackTrace(this,h)};h.prototype=Object.create(Error.prototype);return h.prototype.constructor=h});define("qowtRoot/errors/qowtError",["qowtRoot/errors/localisedError"],function(f){var c=function(){f.apply(this,arguments);this.name="QOWTError";Error.captureStackTrace(this,c);this.fatal=!1};c.prototype=Object.create(f.prototype);c.prototype.constructor=c;return window.QOWTError=c});
define("qowtRoot/errors/qowtSilentError",["qowtRoot/errors/localisedError"],function(f){var c=function(){f.apply(this,arguments);this.name="QOWTSilentError";Error.captureStackTrace(this,c);this.fatal=!1;this.silent=!0};c.prototype=Object.create(f.prototype);c.prototype.constructor=c;return window.QOWTSilentError=c});
define("qowtRoot/errors/qowtException",["qowtRoot/errors/localisedError"],function(f){var c=function(){f.apply(this,arguments);this.name="QOWTException";Error.captureStackTrace(this,c);this.fatal=!0};c.prototype=Object.create(f.prototype);c.prototype.constructor=c;return window.QOWTException=c});
define("qowtRoot/errors/errorCatcher","qowtRoot/utils/typeUtils qowtRoot/messageBus/messageBus qowtRoot/pubsub/pubsub qowtRoot/errors/qowtError qowtRoot/errors/qowtSilentError qowtRoot/errors/qowtException".split(" "),function(f,c,h,a,l,n){function q(a){a.error?(console.error("%s caught js exception: %s",D,a.error.name||a.error.message?a.error.name+": "+a.error.message:a.error),console.error(a.error.stack),void 0===a.error.fatal&&(a.error.fatal=!0),m(a.error)):console.error(a)}function t(a,c){console.log("%s caught deprecated error",
D);console.log(c);c.isDeprecatedError=!0;m(c)}function m(h){if(h instanceof Error)void 0===h.fatal&&(h.fatal=!0);else{console.log("%s converting deprecated/bad error",D);switch(!0){case f.isObject(h)&&h.isDeprecatedError:var m={title:h.errorId?h.errorId+"_short_msg":void 0,details:h.errorId?h.errorId+"_msg":void 0,linkData:h.linkData,message:h.additionalInfo};h=h.fatal?new n(m):h.silent?new l(m):new a(m);break;case f.isNumber(h):h=new n({code:h});break;case f.isString(h):h=new n(h);break;default:h=
new n(h.toString())}h.stack=void 0}y.push(h);v(h);if(!h.isSynced){console.log("%s pushing error to msg bus",D);m=_.extend({},h);m.name=h.name;m.message=h.message;m.stack=h.stack;try{c.pushMessage({id:K,error:JSON.stringify(m)})}catch(q){}}}function v(a){console.log("%s dispatching error to observers",D);I.forEach(function(c){try{c.call(c,a)}catch(f){console.warn("Error observer %s threw an exception; ignored",c.name||""),console.warn(f.stack)}})}function r(a){if(a&&a.data&&a.data.error){console.log("%s receiving error from msg bus",
D);a=JSON.parse(a.data.error);var c={},c=["QOWTError","QOWTSilentError","QOWTException"];-1!=="Error EvalError RangeError ReferenceError SyntaxError TypeError URIError QOWTError QOWTSilentError QOWTException".split(" ").indexOf(a.name)?(console.log("cast to %s",a.name),-1!==c.indexOf(a.name)&&(a.localised=!0),c=new window[a.name](a)):(console.log("cast fallback to Error"),c=Error());_.extend(c,a);void 0===a.stack&&(c.stack=void 0);a=c;a.isSynced=!0;m(a)}}function w(a){return a&&a.data&&a.data.id===
K}var K="errorSync",I=[],D="sandbox"===window.name?"QOWT":"App",x,y=[];return{init:function(){x=h.subscribe("qowt:error",t);window.addEventListener("error",q);c.listen(r,w);Error.stackTraceLimit=Infinity},reset:function(){h.unsubscribe(x);window.removeEventListener("error",q);c.stopListening(r);I=[]},handleError:function(a){m(a)},addObserver:function(a){f.isFunction(a)?I.push(a):console.warn("Error observer must be a function")},observers:function(){return I},lastError:function(){return y[y.length-
1]}}});define("qowtRoot/errors/unique/fileDoesNotExistError",["qowtRoot/errors/qowtException"],function(f){var c=function(){this.title="file_does_not_exist_error_title";this.details="file_does_not_exist_error_details";this.gaState="FileDoesNotExistError";f.apply(this,arguments);this.name="FileDoesNotExistError";Error.captureStackTrace(this,c)};c.prototype=Object.create(f.prototype);return c.prototype.constructor=c});
define("qowtRoot/utils/tryUtils",["qowtRoot/utils/typeUtils"],function(f){var c=function(c){this.rethrowOnException=!1;this.optMsg=c};c.prototype={__proto__:Object.prototype,ignore:function(){return this.run.apply(this,arguments)},rethrow:function(){this.rethrowOnException=!0;return this.run.apply(this,arguments)},run:function(){var c=arguments[0],a=[].splice.call(arguments,1);try{return c.apply(null,a)}catch(l){this.optMsg&&(f.isString(this.optMsg)?console.warn(this.optMsg):console.dir(this.optMsg));
if(this.rethrowOnException){if(l instanceof Error)throw l;throw Error(l);}console.warn("Ignoring exception: ",l)}}};return{withWarning:function(f){return new c(f)},ignore:function(){if(!f.isFunction(arguments[0]))throw Error("ignore must be passed a function as first argument");var h=new c;return h.ignore.apply(h,arguments)},rethrow:function(){var f=new c;return f.rethrow.apply(f,arguments)}}});
define("controllers/appState",["qowtRoot/errors/errorCatcher","utils/analytics/googleAnalytics"],function(f,c){function h(c){a.updateState(c.gaState?c.gaState:c.fatal?"FatalCrash":"NonFatalError",{data_reason:c.message,data_fatal:c.fatal})}var a={init:function(){f.addObserver(h);a.updateState("Init")},setApp:function(a,f){c.setFileExt(f);c.setTracker(a)},updateState:function(a,f){l!==a&&(l=a,window.qowtState={state:l,context:f},c.sendState(l))}},l;return a});
define("utils/converter",[],function(){var f={app2Icon:function(c){return{word:"../img/doc.ico",sheet:"../img/xls.ico",point:"../img/ppt.ico"}[(c||"").toLowerCase()]},extension2Format:function(c){return{doc:"CBF",docx:"OOXML",docm:"OOXML",dot:"CBF",dotx:"OOXML",xls:"CBF",xlsx:"OOXML",xlsm:"OOXML",xlt:"CBF",xltx:"OOXML",csv:"CSV",ppt:"CBF",pptx:"OOXML",pptm:"OOXML",pot:"CBF",potx:"OOXML"}[(c||"").toLowerCase()]},extension2App:function(c){return{doc:"word",docx:"word",docm:"word",dot:"word",dotx:"word",
xls:"sheet",xlsx:"sheet",xlsm:"sheet",xlt:"sheet",xltx:"sheet",csv:"sheet",ppt:"point",pptx:"point",pptm:"point",pot:"point",potx:"point"}[(c||"").toLowerCase()]},extension2Mime:function(c){return{doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",docm:"application/vnd.ms-word.document.macroenabled.12",dot:"application/msword-template",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xls:"application/vnd.ms-excel",
xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlt:"application/vnd.ms-excel",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",csv:"text/csv",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pptm:"application/vnd.ms-powerpoint.presentation.macroenabled.12",pot:"application/vnd.ms-powerpoint",potx:"application/vnd.openxmlformats-officedocument.presentationml.template"}[(c||
"").toLowerCase()]},app2FileName:function(c){return{word:"Document",point:"Presentation",sheet:"Spreadsheet"}[(c||"").toLowerCase()]},url2App:function(c){var a,f="";(c=(c||"").match(/.*\/([^\/?]*)/))&&(c=c[1].match(/.*\.([^\.]*)$/))&&(f=c[1]);switch(f.toLowerCase()){case "doc":case "docx":case "docm":a="word";break;case "xls":case "xlsx":case "xlsm":case "csv":a="sheet";break;case "ppt":case "pptx":case "pptm":a="point"}return a},mime2Extension:function(f){return c[(f||"").toLowerCase()]},mime2App:function(c){return f.extension2App(f.mime2Extension(c))},
mime2Icon:function(c){return f.app2Icon(f.mime2App(c))},mime2Format:function(c){return f.extension2Format(f.mime2Extension(c))},name2ext:function(c){var a="";(c=(c||"").match(/.*\.([^\.]*)$/))&&(a=c[1]);return a}},c={"application/msword":"doc","application/vnd.ms-word":"doc","application/vnd.msword":"doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.wordprocessing-openxml":"docx","application/vnd.ms-word.document.macroenabled.12":"docm","application/vnd.ms-word.document.12":"docm",
"application/vnd.openxmlformats":"docx","application/msword-template":"dot","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","application/mspowerpoint":"ppt","application/vnd.ms-powerpoint":"ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","application/vnd.presentation-openxml":"pptx","application/vnd.presentation-openxmlm":"pptx","application/vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","application/vnd.openxmlformats-officedocument.presentationml.template":"potx",
"application/msexcel":"xls","application/vnd.ms-excel":"xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.spreadsheet-openxml":"xlsx","application/vnd.ms-excel.sheet.macroenabled.12":"xlsm","application/vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","text/csv":"csv"};return f});
define("qowtRoot/errors/unique/httpErrorFileNotFound",["qowtRoot/errors/qowtException"],function(f){var c=function(){this.title="temporary_unable_to_open_error_short_msg";this.details="temporary_unable_to_open_error_msg";this.gaState="HTTPErrorFileNotFound";f.apply(this,arguments);this.name="HTTPErrorFileNotFound";this.message="HTTP ERROR: 404";Error.captureStackTrace(this,c)};c.prototype=Object.create(f.prototype);return c.prototype.constructor=c});
define("qowtRoot/errors/unique/httpErrorZero",["qowtRoot/errors/qowtException"],function(f){var c=function(){this.title="http_error_zero_short_msg";this.details="http_error_zero_msg";this.gaState="HTTPErrorZero";f.apply(this,arguments);this.name="HTTPErrorZero";this.message="HTTP ERROR: 0";Error.captureStackTrace(this,c)};c.prototype=Object.create(f.prototype);return c.prototype.constructor=c});
define("qowtRoot/errors/unique/timeoutError",["qowtRoot/errors/qowtException"],function(f){var c=function(){this.gaState="TimeoutError";f.apply(this,arguments);this.name="TimeoutError";Error.captureStackTrace(this,c)};c.prototype=Object.create(f.prototype);return c.prototype.constructor=c});
define("utils/retryHandler",[],function(){var f=function(){this.interval=1E3;this.maxInterval=6E4};f.prototype={__proto__:Object.prototype,maxedOut:function(){return this.interval>this.maxInterval},retry:function(c){setTimeout(c,this.interval);this.interval=this.nextInterval_()},reset:function(){this.interval=1E3},nextInterval_:function(){var c=2*this.interval+this.getRandomInt_(0,1E3);return Math.min(c,this.maxInterval)},getRandomInt_:function(c,f){return Math.floor(Math.random()*(f-c+1)+c)}};return f});
define("utils/xhr","qowtRoot/errors/qowtException qowtRoot/errors/unique/httpErrorFileNotFound qowtRoot/errors/unique/httpErrorZero qowtRoot/errors/unique/timeoutError qowtRoot/utils/typeUtils qowtRoot/third_party/when/when utils/retryHandler".split(" "),function(f,c,h,a,l,n,q){var t=function(a){this.method_=a.method||"GET";this.responseType_=a.responseType||"blob";this.url_=this.buildUrl_(a.baseUrl,a.params);this.authToken_=a.authToken;this.contentType_=a.contentType;this.deferred_=n.defer();this.kEstimatedDownloadChunks_=
20;this.timeoutLength_=6E5;this.remainingChunks_=this.kEstimatedDownloadChunks_;this.progress_=0;this.retryHandler_=new q;a.abortPromise&&(a.abortPromise=a.abortPromise.catch(function(){this.xhr_&&this.xhr_.abort&&this.xhr_.abort();this.deferred_.reject(Error("XHR canceled"))}))};t.prototype={__proto__:Object.prototype,send:function(a){this.xhr_=this.createXMLHttpRequest_();this.xhr_.send(a);this.startConnectionTimeout_();return this.deferred_.promise},createXMLHttpRequest_:function(){var a=new XMLHttpRequest;
"GET"===this.method_?a.onprogress=this.onProgress_.bind(this):a.upload.onprogress=this.onProgress_.bind(this);a.onload=this.onSuccess_.bind(this);a.onerror=this.onError_.bind(this);a.open(this.method_,this.url_,!0);a.responseType=this.responseType_;this.authToken_&&a.setRequestHeader("Authorization","Bearer "+this.authToken_);this.contentType_&&a.setRequestHeader("Content-Type",this.contentType_);return a},onSuccess_:function(a){this.clearConnectionTimeout_();if(4===a.target.readyState){var c=a.target.response||
a.target.responseText;if(200!==a.target.status&&0!==a.target.status||!c)if(0!==a.target.status&&200!==a.target.status||c)this.onError_(a);else this.deferred_.reject("HTTP ERROR: ABORTED");else{if("json"===a.target.responseType&&"string"===typeof c)try{c=JSON.parse(c)}catch(f){return this.deferred_.reject(Error("XHR response not valid JSON"))}this.deferred_.notify(1);this.deferred_.resolve(c)}}},onProgress_:function(a){this.resetConnectionTimeout_();a&&a.lengthComputable?this.progress_=(a.position||
a.loaded)/(a.totalSize||a.total):(a=this.remainingChunks_/this.kEstimatedDownloadChunks_,this.remainingChunks_-=a,this.progress_+=a/this.kEstimatedDownloadChunks_);this.deferred_.notify(this.progress_)},onError_:function(a){a.target.status&&(500<=a.target.status||429===a.target.status)?this.retry_(a):this.deferred_.reject(this.getErrorFromXhrStatus_(a.target.status))},retry_:function(a){this.retryHandler_.maxedOut()?this.deferred_.reject(this.getErrorFromXhrStatus_(a.target.status)):this.retryHandler_.retry(this.send.bind(this))},
getErrorFromXhrStatus_:function(a){return 0===a?new h:404===a?new c:new f("HTTP ERROR: "+a)},buildUrl_:function(a,c){var f=this.parseUrl_(a),h=this.buildQuery_(c);h&&(f+="?"+h);return f},buildQuery_:function(a){a=a||{};return Object.keys(a).map(function(c){return encodeURIComponent(c)+"="+encodeURIComponent(a[c])}).join("&")},parseUrl_:function(a){if(l.isString(a)){var c=a;c.match(/^http[s]?:\/\//)||c.match(/^blob:/)||c.match(new RegExp("^"+window.location.origin))||(a="http://"+a)}else throw Error("URL for XHR should be a string");
return a},startConnectionTimeout_:function(){this.timeout_=window.setTimeout(function(){var c=new a("XHR timed out");this.deferred_.reject(c)}.bind(this),this.timeoutLength_)},clearConnectionTimeout_:function(){window.clearTimeout(this.timeout_);delete this.timeout_},resetConnectionTimeout_:function(){this.clearConnectionTimeout_();this.startConnectionTimeout_()}};return t});
define("utils/fileEntry",[],function(){var f=function(c){this.writer=c};f.prototype={__proto__:Object.prototype,truncate:function(c){this.readyState=2;this.writer.truncate(c).then(this.onwrite,this.onerror)},write:function(c){var a=this;this.writer.write(c).then(function(){a.writer.close();a.onwrite()},this.onerror)}};var c=function(c,a){this.entry=c;this.uuid=a;this.isFile=!0};c.prototype={__proto__:Object.prototype,file:function(c){if(this.entry.file)this.entry.file(c);else if(this.entry.getFile)this.entry.getFile().then(c);
else throw Error("File not found.");},createWriter:function(c,a){if(this.entry.createWriter)this.entry.createWriter(c,a);else if(this.entry.createWritable)this.entry.createWritable().then(function(a){c(new f(a))},a);else throw Error("Writer not found.");}};return c});
define("utils/fileSystem",["utils/fileEntry"],function(f){var c={".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},h=function(){};h.prototype={__proto__:Object.prototype,chrome:{chooseEntry:function(a,c,f){console.log("FileSystem","chrome","chooseEntry");return window.chrome.fileSystem.chooseEntry({type:"saveFile",
suggestedName:a,accepts:[{extensions:c}]},function(a){return window.chrome.runtime.lastError&&"User cancelled"===window.chrome.runtime.lastError.message?f(Error(window.chrome.runtime.lastError.message)):f(null,a)})},getDisplayPath:function(a,c){console.log("FileSystem","chrome","getDisplayPath");return window.chrome.fileSystem.getDisplayPath(a,c)}},native:{chooseEntry:function(a,h,n){console.log("FileSystem","native","chooseEntry");try{var q={};q[c["."+h[0]]]=h;return window.showSaveFilePicker({suggestedName:a,
accept:q}).then(function(a){return n(null,new f(a))},function(a){return n(Error(a.message))})}catch(t){return console.warn(t),n("Something went wrong.")}},getDisplayPath:function(a,c){console.log("FileSystem","native","getDisplayPath");return a.file(function(a){return c(a.name)})}}};return new h});
define("utils/fileWriter",["qowtRoot/third_party/when/when","utils/analytics/googleAnalytics"],function(f,c){var h=function(a){this.entry=a;this.state=0};h.prototype={__proto__:Object.prototype,writeData:function(a){return this.createWriter_().then(this.truncateAndWrite_.bind(this,a)).then(function(){return this.entry}.bind(this))},createWriter_:function(){var a=f.defer();f(0===this.state).then(function(){this.entry.createWriter(a.resolve,a.reject)}.bind(this));return a.promise},writeOrResolve_:function(a,
f,h){if(2===f.readyState)switch(this.state){case 3:try{this.state=1,f.write(a)}catch(q){h.reject(Error(q))}break;case 1:this.state=0,h.resolve()}else c.sendException({msg:"Callback for write/ writeend called when FileWriter.readyState !== DONE",fatal:!1})},truncateAndWrite_:function(a,c){return f.promise(function(f,h){1===c.readyState&&h(Error("INVALID_STATE_ERR : Cannot write when the previous write is still in progress"));c.onwrite=this.writeOrResolve_.bind(this,a,c,{reject:h,resolve:f});c.onerror=
function(a){h(Error(a.currentTarget.error.message))};try{this.state=3,c.truncate(0)}catch(t){throw Error(t);}}.bind(this))}};return h});
define("utils/metrics",["qowtRoot/features/utils","qowtRoot/utils/typeUtils"],function(f,c){var h,a="doc docx docm xls xlsx xlsm ppt pptx pptm pps ppsx ppsm csv".split(" "),l="csvNonEmptyCellCount csvSheetCount csvFormattedCellCount docPageCount docSectionCount docParagraphCount docxPageCount docxSectionCount docxParagraphCount pptSlideCount pptMasterCount pptxSlideCount pptxMasterCount xlsNonEmptyCellCount xlsSheetCount xlsFormattedCellCount xlsxNonEmptyCellCount xlsxSheetCount xlsxFormattedCellCount".split(" ");return{recordFileType:function(c){if(c){var l=
h=c.toLowerCase();if(chrome&&chrome.metricsPrivate&&chrome.metricsPrivate.recordValue){var t;"Array"===a.constructor.name?(c=a.indexOf(l),t=a.length):(c=l,t=a);0>c||c>t?console.warn("Ignoring metrics record for unknown value: "+l):(l={metricName:"Quickoffice.FileFormat",type:"histogram-linear",min:1,max:t,buckets:t+1},f.isDebug()&&void 0===window.__umaMock?console.log("UMA not supported in debug mode"):chrome.metricsPrivate.recordValue(l,c))}}},recordCount:function(a){a=a||{};var q=h+(a.dataPoint||
"");a=a.value||0;if(c.isString(name)&&c.isNumber(a)&&c.isList(l)){var t,m;c.isList(l)?(m=l.indexOf(q),t=l.length):(m=q,t=l);if(!(0<=m&&m<=t))console.warn("Ignoring unknown metrics record "+q+" with value: "+a);else if(!f.isDebug()&&chrome&&chrome.metricsPrivate&&chrome.metricsPrivate)switch(t="Quickoffice."+q,q){case "docPageCount":case "docxPageCount":chrome.metricsPrivate.recordValue&&chrome.metricsPrivate.recordValue({metricName:t,type:"histogram-log",min:1,max:1E3,buckets:50},a);break;case "docParagraphCount":case "docxParagraphCount":chrome.metricsPrivate.recordMediumCount&&
chrome.metricsPrivate.recordMediumCount(t,a);break;case "csvSheetCount":case "docSectionCount":case "docxSectionCount":case "xlsSheetCount":case "xlsxSheetCount":case "pptSlideCount":case "pptxSlideCount":case "pptMasterCount":case "pptxMasterCount":chrome.metricsPrivate.recordSmallCount&&chrome.metricsPrivate.recordSmallCount(t,a);break;case "csvNonEmptyCellCount":case "xlsNonEmptyCellCount":case "xlsxNonEmptyCellCount":case "csvFormattedCellCount":case "xlsFormattedCellCount":case "xlsxFormattedCellCount":chrome.metricsPrivate.recordCount&&
chrome.metricsPrivate.recordCount(t,a);break;default:console.warn("Record count ignored unknown metric "+t)}}else console.warn("Metrics cannot record count - invalid parameters")}}});define("qowtRoot/utils/driveErrors",[],function(){return{OFFLINE:-1,AUTHENTICATION_TOKEN_NOT_ISSUED:400,INVALID_CREDENTIALS:401,FORBIDDEN:403,FILE_NOT_FOUND:404,CONVERT_FAILURE:413,INTERNAL_SERVER_ERROR:500,TIMEOUT:503}});
define("utils/gdrive/firstPartyAuth",["qowtRoot/third_party/when/when","qowtRoot/utils/driveErrors"],function(f,c){function h(){window[w]=void 0;window[t]=void 0;return f.resolve()}function a(){return l(q,v).then(function(){return l(q,m)}).then(function(){return l(q,r)}).then(function(){return Promise.reject({status:c.INVALID_CREDENTIALS})}).catch(function(a){return a?Promise.reject(a):Promise.resolve()})}function l(a,c){return new Promise(function(f,h){chrome.cookies.get({url:a,name:c},function(a){a&&
void 0!==a.value?(window[w]=a.value,h()):f()})})}function n(a,h,l,m){return f.promise(function(f,n){chrome.cookies.get({url:a,name:h},function(a){a&&void 0!==a.value?(window[l]=m?a.value:!!a.value,f()):n({status:c.INVALID_CREDENTIALS})})})}var q="https://*.google.com/",t="__OVERRIDE_SID",m="SAPISID",v="__Secure-1PAPISID",r="__Secure-3PAPISID",w="__SAPISID";return{setCookies:function(){return f.all([h(),a()])},setCookiesOlderWay:function(){return f.all([h(),n("http://*.google.com/","SID",t),n(q,m,
w,!0)])}}});define("utils/gdrive/driveUtils",[],function(){return{getErrorCode:function(f){return f&&f.result&&f.result.error&&f.result.error.code||f&&f.status},getErrorReason:function(f){return f&&f.result&&f.result.error&&f.result.error.errors&&f.result.error.errors[0]&&f.result.error.errors[0].reason},getErrorMessage:function(f){return f&&f.result&&f.result.error&&f.result.error.message||f&&f.statusText},isValidDriveId:function(f){return f&&/^[a-zA-Z0-9_-]+$/.test(f)}}});
define("utils/gdrive/authHeader",[],function(){function f(f,h,q){return c(f,h,q).then(function(c){return[a,c].join(" ")})}function c(a,c,f){var t=[],m=[],v=[];f.forEach(function(a){v.push(a.key);m.push(a.value)});var r=Math.floor((new Date).getTime()/1E3),t=0===m.length?[r,c,a]:[m.join(":"),r,c,a];return h(t.join(" ")).then(function(a){a=[r,a];0<v.length&&a.push(v.join(""));return a.join("_")})}function h(a){a=(new TextEncoder).encode(a);return crypto.subtle.digest("SHA-1",a).then(function(a){return Array.from(new Uint8Array(a)).map(function(a){return("00"+
a.toString(16)).slice(-2)}).join("").toLowerCase()})}var a="SAPISIDHASH";return{getAuthHeaderValueForFirstParty:function(a,c,h){var t=[];h&&t.push({key:"u",value:h});if(c)return f(a,c,t);throw Error("Invalid SessionCookie");}}});
define("utils/gdrive/gapiRequest",["utils/gdrive/authHeader"],function(f){function c(a){a.key=m;return Object.keys(a).map(function(c){return encodeURIComponent(c)+"="+encodeURIComponent(a[c])}).join("&")}function h(a,f){var h=c(f),h=/\?/.test(a)?h.length?"&"+h:"":h.length?"?"+h:"";return t+a+h}function a(a,c,h){a["x-clientdetails"]=l();"POST"===c&&(a["x-goog-authuser"]=0);a["x-goog-encode-response-if-executable"]="base64";"GET"===c&&(a["x-origin"]=v,a["x-referer"]=v);a["x-javascript-user-agent"]=
"google-api-javascript-client/1.1.0";a["x-requested-with"]="XMLHttpRequest";c=window.__SAPISID?f.getAuthHeaderValueForFirstParty(window.location.origin,window.__SAPISID,h):Promise.resolve();return c.then(function(c){c&&(a.authorization=c)})}function l(){return["appVersion","platform","userAgent"].map(function(a){var c=window.navigator[a];return encodeURIComponent(a)+"="+encodeURIComponent(c)}).join("&")}function n(a){r={headers:Object.fromEntries(a.headers.entries())||null,status:a.status||null,statusText:a.statusText||
null,ok:a.ok};return a.text()}function q(a){var c=[];a=a.replace(/(([\r\n]{0,2}[A-Za-z0-9+\/]){4,4}){0,1024}([\r\n]{0,2}[A-Za-z0-9+\/][\r\n]{0,2}[AQgw]([\r\n]{0,2}=){2,2}|([\r\n]{0,2}[A-Za-z0-9+\/]){2,2}[\r\n]{0,2}[AEIMQUYcgkosw048][\r\n]{0,2}=|([\r\n]{0,2}[A-Za-z0-9+\/]){4,4})[\r\n]{0,2}/g,function(a){c.push(window.atob(a));return""});return c.join("")}var t="https://clients6.google.com",m="AIzaSyD-qQA49y2Lv7b0KJCQghmHKe0iMHFnIts",v=chrome.runtime.getURL(""),r={},v=v.substring(0,v.lastIndexOf("/"));
return{sendGapiRequest:function(c,f){var l=c.path,m=Object.assign(c.params),t=c.headers?Object.assign(c.headers):{},v="GET"===c.method?!0:!1,B=h(l,m);return a(t,c.method,f).then(function(){var a={method:c.method,credentials:"include",headers:t};v||(a.body=c.body);return a}).then(function(a){return fetch(B,a)}).then(n).then(function(a){r.body=a;a=r;var c=a.headers;if(c&&"base64"===c["x-goog-safety-encoding"]){var f=q(a.body);c["Content-Type"]=c["x-goog-safety-content-type"];delete c["x-goog-safety-encoding"];
delete c["x-goog-safety-content-type"];a.body=f}a=r;if(c=204!==r.status)try{c=JSON.parse.call(JSON,r.body)}catch(h){c=!1}a.result=c;return r.ok?r:Promise.reject(r)})}}});
define("utils/gdrive/drive","qowtRoot/errors/errorCatcher qowtRoot/errors/qowtSilentError qowtRoot/utils/driveErrors utils/gdrive/firstPartyAuth utils/gdrive/driveUtils utils/gdrive/gapiRequest qowtRoot/third_party/when/when".split(" "),function(f,c,h,a,l,n,q){function t(){return M?q.resolve():a.setCookies().then(function(){M=!0})}function m(a,c){var f;fa?f=q.resolve(fa):(f={path:"/drive/v2/files/"+a,method:"GET",params:{updateViewedDate:!0,supportsTeamDrives:!0}},c&&(f.headers={"X-Goog-Drive-Resource-Keys":a+
"/"+c}),f=K(f,"Drive.getMetaData_").then(function(a){return fa=a&&a.result}).catch(B));return f}function v(a,c){var f={path:"/drive/v2/files/"+a+"?alt=media",method:"GET",params:{supportsTeamDrives:!0}};c&&(f.headers={"X-Goog-Drive-Resource-Keys":a+"/"+c});return K(f,"Drive.download_").then(y).catch(B)}function r(a,c,f){a={path:"/drive/v2/files/"+a+"/copy",method:"POST",params:{convert:c,supportsTeamDrives:!0,alt:"json"},headers:{"content-type":"application/json"}};f.title&&(a.body=JSON.stringify({title:f.title}));
return K(a,"Drive.createFileFromDriveFile_")}function w(a,h,l){l&&l.mimeType||f.handleError(new c("Drive upload called with no mime type."));var m=q.defer(),n=new FileReader;n.readAsBinaryString(a);n.onload=function(){var a=l.mimeType,c=btoa(n.result),a="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify(l)+"\r\n---------314159265358979323846\r\nContent-Type: "+a+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+c+"\r\n---------314159265358979323846--";h.headers=
h.headers?h.headers:{};h.headers["Content-Type"]='multipart/mixed; boundary="-------314159265358979323846"';h.body=a;K(h,"Drive.upload_").then(m.resolve,m.reject)};return m.promise}function K(c,f){var h=q.defer();n.sendGapiRequest(c,X,f).then(h.resolve,function(c,l){D(l)?q.all([a.setCookies()]).done(function(){n.sendGapiRequest(c,X,f).then(h.resolve,function(l){D(l)?q.all([a.setCookiesOlderWay()]).done(function(){n.sendGapiRequest(c,X,f).then(h.resolve,x.bind(null,h,f))},function(a){h.reject(a)}):
x(h,f,l)})},function(a){h.reject(a)}):I(l)?n.sendGapiRequest(c,X,f).then(h.resolve,x.bind(null,h,f)):x(h,f,l)}.bind(null,c));return h.promise}function I(a){var c=l.getErrorCode(a);a=l.getErrorReason(a);return c===h.INTERNAL_SERVER_ERROR||c===h.TIMEOUT||c===h.FORBIDDEN&&("rateLimitExceeded"===a||"userRateLimitExceeded"===a)}function D(a){a=l.getErrorCode(a);return a===h.INVALID_CREDENTIALS||a===h.AUTHENTICATION_TOKEN_NOT_ISSUED}function x(a,h,m){h+=" error:";var n=l.getErrorCode(m),q=l.getErrorMessage(m);
console.error([h,n,q].join(" "));f.handleError(new c([h,n].join(" ")));a.reject(m)}function y(a){a=a.body;for(var c=a.length,f=new ArrayBuffer(c),f=new Uint8Array(f),h=0;h<c;h++)f[h]=a.charCodeAt(h);return new Blob([f])}function B(a){throw a;}var M=!1,fa,X;return{getMetaData:function(a,c){return t().then(m.bind(null,a,c))},download:function(a,c){return t().then(v.bind(null,a,c))},upload:function(a,c,f,h){f={path:"/upload/drive/v2/files/"+a,method:"PUT",params:{newRevision:f?"true":"false",uploadType:"multipart",
alt:"json",supportsTeamDrives:!0}};h&&(f.headers={"X-Goog-Drive-Resource-Keys":a+"/"+h});return t().then(m.bind(null,a)).then(w.bind(null,c,f))},createFileFromDriveFile:function(a,c,f){return t().then(r.bind(null,a,c,f))},createFileFromNonDriveFile:function(a,c,f){c={path:"/upload/drive/v2/files/",method:"POST",params:{uploadType:"multipart",convert:c,supportsTeamDrives:!0}};"application/msword-template"===f.mimeType&&(f.mimeType="application/msword");return t().then(w.bind(null,a,c,f))},clearCachedMetaData:function(){fa=
void 0},setUserId:function(a){X=a}}});
define("ui/progressSpinner",["qowtRoot/features/utils"],function(f){function c(){v&&(v=!1,q.style.opacity="0")}function h(c,f){w[c].progress=1<f?1:0>f||void 0===f?0:f;var h=0,l=0,m=0,n;for(n in w)if(w.hasOwnProperty(n)&&void 0!==w[n].weight&&void 0!==w[n].progress){var q=w[n];"*"===q.weight?m=q.progress:(l+=q.weight,h+=q.progress*q.weight)}0<m&&(h+=m*(1-l));a(h)}function a(a){a=1<a?1:0>a||void 0===a?0:a;var f=parseInt(8*a,10);m&&m.getElementById("circular-progress").setAttribute("class",("editor"===
t?"dark":"light")+" p"+f);1===a&&setTimeout(c,100)}function l(){t=f.isEnabled("edit")?"editor":"viewer";q=document.createElement("div");q.style.display="none";q.classList.add(t);q.classList.add("progress-spinner-container");q.classList.add("fader");q.addEventListener("webkitTransitionEnd",function(){v||(a(0),q.style.display="none")},!1);n=document.createElement("embed");n.classList.add(t);n.classList.add("progress-spinner");n.src="../img/progressSpinner.svg";n.onload=function(){m=n.getSVGDocument()};
q.appendChild(n);var c=document.createElement("div");c.classList.add(t);c.classList.add("progress-spinner-label");c.textContent=chrome.i18n.getMessage("file_loading_spinner_label");q.appendChild(c);document.body.appendChild(q);K=!0}var n,q,t,m,v=!1,r=0,w={},K=!1;return{show:function(c){K||l();v||(v=!0,q.style.display="block",q.style.opacity="1");c&&a(c)},hide:function(){c()},setProgress:function(c){a(c)},addContributor:function(a){r++;var c="contrib"+r;w[c]={weight:a,progress:0};return h.bind(this,
c)},resetContributors:function(){w={};r=0}}});
define("qowtRoot/utils/pathUtils",["qowtRoot/utils/typeUtils"],function(f){return{create:function(c){return function(){var h={extension:function(){return l},dirName:function(){return q},baseName:function(){return n},fileName:function(){return a},smartBaseName:function(){var a=h.baseName();if(a)var c=/(-[0-9]+)$/g,f=a.match(c),a=f?a.replace(c,--f):a+"-1";return a}},a,l,n,q;(function(){if(c&&f.isString(c)){var h=c.lastIndexOf("/");q=-1!==h?c.substr(0,h+1):void 0;a=-1!==h?c.substr(h+1):c;h=a.lastIndexOf(".");
n=-1!==h?a.substr(0,h):a;var m=a.length;l=-1!==h?a.substr(h+1,m):void 0}})();return h}()}}});define("qowtRoot/errors/unique/scriptLoadingTimeout",["qowtRoot/errors/qowtException"],function(f){var c=function(){this.title="drive_open_timeout_error_short_msg";this.details="drive_open_timeout_error_msg";this.gaState="ScriptLoadingTimeout";f.apply(this,arguments);this.name="ScriptLoadingTimeout";Error.captureStackTrace(this,c)};c.prototype=Object.create(f.prototype);return c.prototype.constructor=c});
define("qowtRoot/utils/uuid",[],function(){return{generateUUID:function(){var f=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var h=(f+16*Math.random())%16|0;f=Math.floor(f/16);return("x"===c?h:h&7|8).toString(16)})}}});
define("qowtRoot/utils/localStorageManager",["qowtRoot/errors/qowtException"],function(f){return{setItem:function(c,h){try{window.localStorage.setItem(c,h)}catch(a){throw new f({title:"storage_quota_exceed_error_short_msg",details:"storage_quota_exceed_error_msg",message:a.message});}},getItem:function(c){return window.localStorage.getItem(c)}}});
define("controllers/fileManager","qowtRoot/third_party/when/when utils/converter utils/xhr utils/fileEntry utils/fileSystem utils/fileWriter utils/metrics utils/gdrive/drive utils/gdrive/driveUtils ui/progressSpinner controllers/appState qowtRoot/utils/i18n qowtRoot/utils/tryUtils qowtRoot/utils/pathUtils qowtRoot/errors/qowtException qowtRoot/errors/unique/httpErrorFileNotFound qowtRoot/errors/unique/httpErrorZero qowtRoot/errors/unique/timeoutError qowtRoot/errors/unique/scriptLoadingTimeout qowtRoot/utils/typeUtils qowtRoot/utils/driveErrors qowtRoot/utils/uuid qowtRoot/utils/localStorageManager utils/analytics/googleAnalytics third_party/lo-dash/lo-dash.min".split(" "),function(f,
c,h,a,l,n,q,t,m,v,r,w,K,I,D,x,y,B,M,fa,X,P,N,Z){var T,R={},H={},U=0,pa,Q=function(){};Q.prototype={__proto__:Object.prototype,sendMessageToWorker:function(a){var c=++U;a.msgId=c;return new Promise(function(f,h){R[c]=f;H[c]=h;T.postMessage(a)})},handleMessageFromWorker:function(a){a=a.data;if(6===a.type)_handleWASMMessage(a.message);else if(5===a.type)copyToPrivateFile();else if(3===a.type)R[a.msgId](a.fileContent);else if(a.error)H[a.msgId](a.error);else R[a.msgId]();delete R[a.msgId];delete H[a.msgId]},
init:function(a,c,h){this.config_=a;this.uuid_=c;this.srcFile_=h;this.isReady=!1;T=new Worker(chrome.runtime.getURL("scripts/controllers/wasmModuleUtilityWorker.js"));T.onerror=function(a){console.log(a)};T.onmessage=this.handleMessageFromWorker;return f.resolve().then(this.tryToRestoreOrDeleteFromCache_.bind(this)).catch(this.openOriginalFile_.bind(this)).then(this.whenDone_.bind(this))},getUUID:function(){return this.getCache().uuid},copyToPrivateFile:function(){var a=new n(this.config_.privateFile);
this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(c){a.writeData(new Blob([c]))})},updateConfigAndCache:function(a){a&&(this.config_.preferredFilename=this.config_.userFile.name,this.config_.userFile=void 0);this.config_.isDownloaded=!0;this.config_.isRenamed=a;this.cacheInfo_()},getCache:function(){var a=window.sessionStorage.getItem("__fileManagerCache");return K.ignore(JSON.parse.bind(JSON,a))||{}},getEntryPoint:function(){return pa},originalURL:function(){return _.get(this,
"config_.originalURL")},privateFilePath:function(){return this.returnFilePath_(_.get(this,"config_.privateFile",{}))},downloadFilePath:function(){return this.returnFilePath_(_.get(this,"config_.downloadFile",{}))},userFilePath:function(){return this.returnFilePath_(_.get(this,"config_.userFile",{}))},getWorker:function(){return T},mimeTypeFromFileName:function(a){return c.extension2Mime(c.name2ext(a))},mimeType:function(){var a=this.config_.mimeType;c.mime2App(a)||(a=this.userFilePath()||this.privateFilePath()||
this.originalURL(),a=I.create(a).extension()||this.config_.extension,a=c.extension2Mime(a));return a},displayName:function(){var a=_.get(this,"config_.preferredFilename",{});if(0<a.length)return a;var c;if(a=this.userFilePath()||this.originalURL()){a=I.create(a).fileName();try{c=window.decodeURIComponent(a)}catch(f){try{c=window.unescape(a)}catch(h){c=a}}}else c=this.config_.title;return c},driveDocId:function(){return _.get(this,"config_.driveDocId")},driveFileRole:function(){return _.get(this,"config_.driveFileRole")},
isNewDocument:function(){return _.get(this,"config_.newDocument")},isEmbedded:function(){return _.get(this,"config_.embedded")},createPrivateFile:function(a){this.config_.mimeType=c.extension2Mime(a);return this.createPrivateFile_(a).then(this.cacheInfo_.bind(this))},overwriteUserFile:function(e){if(this.config_.privateFile)if(this.config_.driveDocId||this.config_.userFile)if(this.config_.driveDocId)e=this.uploadDriveFile_(e);else{e=this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(a){return new File([a],
"temp")});var c=this;e=f.resolve(e).then(function(e){var f=c.srcFile_;c.config_.userFile instanceof a&&(f=c.config_.userFile);return c.copyFile_(e,f)})}else e=f.reject(Error("Cannot overwrite user file: No user or drive file"));else e=f.reject(Error("Cannot overwrite user file: private is file missing"));return e},newUserFile:function(a,c){function h(a){return t.createFileFromNonDriveFile(a,!1,m).catch(function(){return this.saveAsLocal_()}.bind(this))}var l,m;this.config_.privateFile?!this.config_.driveDocId||
c?l=this.saveAsLocal_(a):a?(m={title:this.nameForCopiedFile_()},l=t.createFileFromDriveFile(this.config_.driveDocId,!1,m)):(m={title:this.nameForSaveAsFile_(),mimeType:this.mimeType(),parents:[_.get(this,"config_.parents[0]")]},l=this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(a){return new Blob([a])}),l=f.resolve(l).then(h.bind(this))):l=f.reject(Error("Cannot create new user file: Private file missing"));return l},downloadToLocalFile:function(){this.getFileFromEntry_(this.config_.downloadFile).then(function(a){a=
new File([a],a.name,{type:this.mimeTypeFromFileName(a.name)});a=window.URL.createObjectURL(a);var c=this.tryAndGetDownloadFileName();chrome.downloads.download({url:a,filename:c,conflictAction:"uniquify",saveAs:!1})}.bind(this))},tryAndGetDownloadFileName:function(){var a=_.get(this,"config_.downloadFileName","downloadedFile"),f="."+(this.config_.extension?this.config_.extension:c.mime2Extension(this.mimeType()));try{a=a.replace(/[<>:"/\\|?*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()}),
/(\.do[ct][xm]?|\.p[po]t[xm]?|\.xl[st][xm]?|\.csv)$/i.exec(a)||(a+=f)}catch(h){a="downloadedFile"+f}return a},convertToDocs:function(){var a={title:this.nameForConvertedFile_(),mimeType:this.mimeType()};return this.config_.driveDocId?t.createFileFromDriveFile(this.config_.driveDocId,!0,a):this.getFileFromEntry_(this.config_.privateFile).then(function(c){return t.createFileFromNonDriveFile(c,!0,a)})},cacheFileDetails:function(a){window.sessionStorage.setItem("__fileManagerCache",JSON.stringify(a))},
returnFilePath_:function(a){return a.fullPath||a.name},getFileType_:function(){var a;this.config_.driveDocId?a="driveDoc":this.config_.streamURL?a="stream":this.config_.userFile?a="userFile":this.config_.newDocument&&(a="newdocument");return a},getDriveDoc_:function(){return t.getMetaData(this.config_.driveDocId,this.config_.driveDocResourceKey).then(function(a){void 0===a.mimeType||void 0===a.title||void 0===a.id?a=void 0===c.mime2App(a.mimeType)?f.reject(Error("Drive mimeType not an MS Office mimeType")):
f.reject(Error("Drive document missing crucial information")):(this.config_.mimeType=a.mimeType,this.config_.extension=a.fileExtension,this.config_.title=a.title,this.config_.driveDocId=a.id,this.config_.parents=a.parents,this.config_.driveFileRole=_.get(a,"userPermission.role"),a=this.createPrivateFile_().then(this.updateInfoAndDownload_.bind(this,"DownloadingDriveDoc")));return a}.bind(this)).yield(!0)},getStream_:function(){return this.createPrivateFile_().then(this.updateInfoAndDownload_.bind(this,
"DownloadingStream")).yield(!0)},getUserFile_:function(){return this.createPrivateFile_().then(function(){this.updateAppStateAndCache_("LocalFile");return this.getFileFromEntry_(this.srcFile_||this.config_.userFile).then(function(a){return this.getArrayBuffer_(a)}.bind(this)).then(function(a){return this.sendMessageToWorker({type:2,fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this)).then(function(){return this.copyFile_(this.srcFile_||this.config_.userFile,this.config_.privateFile)}.bind(this))}.bind(this))},
getArrayBuffer_:function(a){return a.arrayBuffer()},getNewDocument_:function(a){"word"===a?(this.config_.mimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document",this.config_.title="Untitled document.docx"):"point"===a?(this.config_.mimeType="application/vnd.openxmlformats-officedocument.presentationml.presentation",this.config_.title="Untitled presentation.pptx"):"sheet"===a&&(this.config_.mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",this.config_.title=
"Untitled spreadsheet.xlsx");return this.createPrivateFile_().then(this.updateInfoAndLoadNewDocument_.bind(this,"LoadingNewDocument",a)).yield(!0)},updateInfoAndLoadNewDocument_:function(a,c){this.updateAppStateAndCache_(a);return this.loadNewDocument_(c)},getTemplateUrl_:function(a){if("word"===a)return"templates/blank.docx";if("point"===a)return"templates/blank.pptx";if("sheet"===a)return"templates/blank.xlsx"},loadNewDocument_:function(a){v.show();var c=v.addContributor(.9);a=this.getTemplateUrl_(a);
return(new h({baseUrl:chrome.runtime.getURL(a)})).send().then(function(a){(new n(this.config_.privateFile)).writeData(a);return a.arrayBuffer()}.bind(this)).then(function(a){return this.sendMessageToWorker({type:2,fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this),void 0,c).then(function(){this.config_.isDownloaded=!0;this.cacheInfo_();c(1);v.hide()}.bind(this))},updateInfoAndDownload_:function(a){this.updateAppStateAndCache_(a);return this.download_()},updateAppStateAndCache_:function(a){this.initAppState_(a);
this.cacheInfo_()},restoreConfigFromCache_:function(a){this.config_.isDownloaded=a.isDownloaded;this.config_.isRenamed=a.isRenamed;this.config_.mimeType=a.mimeType||this.config_.mimeType;this.config_.extension=a.extension||this.config_.extension;this.config_.driveDocId=a.driveDocId||this.config_.driveDocId;this.config_.driveFileRole=a.driveFileRole||this.config_.driveFileRole;this.config_.newDocument=a.newDocument||this.config_.newDocument;this.config_.title=a.title||this.config_.title;this.config_.parents=
a.parents||this.config_.parents;this.config_.originalURL=a.originalURL||this.config_.originalURL},deleteFromCache_:function(a){return this.deletePrivateFile_(a).then(this.cacheFileDetails.bind(this,{}))},tryDeletingPrivateFile_:function(a){function c(){return f.reject(Error("IncompleteDownload"))}function h(){return f.reject(Error("CacheDeleteFailed"))}return a.privateFilePath?this.deleteFromCache_(a.privateFilePath).then(c,h):f.reject(Error("NoPrivateFile"))},tryToRestoreOrDeleteFromCache_:function(){var a;
(a=this.getCache())&&a.uuid===this.uuid_?a.isDownloaded?(pa="restore",this.restoreConfigFromCache_(a),a=this.tryToRestoreFiles_(a)):a=this.tryDeletingPrivateFile_(a):a=f.reject(Error("NoCache"));return a},saveFileEntryAndUpdateCache_:function(a){this.config_.userFile=a;this.cacheInfo_()},tryToRestoreFiles_:function(a){function h(){this.config_.downloadFileName=a.downloadFileName;this.updateAppStateAndCache_("BrowserRefresh");return a.userFileId?this.restoreFileById_(a.userFileId).then(this.saveFileEntryAndUpdateCache_.bind(this)).yield(!0):
!0}var l;a.privateFilePath?(l=c.mime2App(this.mimeType()),l=this.sendMessageToWorker({type:1,app:l,url:chrome.runtime.getURL("wasm/"+l+".js")}).then(this.restorePrivateFile_.bind(this,a.privateFilePath)).then(this.restoreDownloadFile_.bind(this,a.downloadFilePath)).then(this.restoreMEMFSFile_.bind(this)).then(h.bind(this))):l=f.reject(Error("There is no cached private file path"));return l},restoreMEMFSFile_:function(){return this.getFileFromEntry_(this.config_.privateFile).then(function(a){return a.arrayBuffer()}).then(function(a){return this.sendMessageToWorker({type:2,
fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this))},nameForCopiedFile_:function(){return"Copy of "+this.displayName()},nameForSaveAsFile_:function(){return"Copy of "+I.create(this.displayName()).baseName()+"."+c.mime2Extension(this.mimeType())},nameForConvertedFile_:function(){return I.create(this.displayName()).baseName()},saveAsLocal_:function(a){var h=I.create(this.displayName()),l=this.config_.userFile&&!this.config_.isRenamed?h.smartBaseName():h.baseName(),m=c.mime2App(this.mimeType());
a=a?[h.extension()]:Ka[m];l+="."+(-1===a.indexOf(h.extension())?a[0]:h.extension());return this.selectFile_(l,a).then(function(a){this.config_.mimeType=void 0;this.config_.extension=void 0;this.config_.driveDocId=void 0;this.config_.driveFileRole=void 0;this.config_.preferredFilename=void 0;this.config_.newDocument=void 0;this.saveFileEntryAndUpdateCache_(a);return this.copyFile_(this.config_.privateFile,this.config_.userFile)}.bind(this),function(){return f.reject({userCancelled:!0})})},initAppState_:function(a){var f=
this.mimeType();if(f&&0!==f.length){var h=c.mime2App(f),l=window.navigator.onLine?"online":"offline",m="non-local-user-"+l;if(/^file:\/\/\//.test(this.originalURL())||this.userFilePath())m="local-user-"+l;this.sendCachableGAEvent_({category:"file-source",action:m,label:h});f=c.mime2Extension(f);q.recordFileType(f);r.setApp(h,f);r.updateState(a)}else throw Error("Unknown mimeType; unable to know which app to load");},sendCachableGAEvent_:function(a){if(window.navigator.onLine)Z.sendEvent(a);else{var c=
this.getGAPendingStore_();c.push(a);N.setItem("pending_ga",JSON.stringify(c))}},getGAPendingStore_:function(){var a;try{a=N.getItem("pending_ga"),a=JSON.parse(a),Array.isArray(a)||(a=[])}catch(c){a=[],console.warn("Failed to initialize file store so resetting it to be empty: "+c)}return a},whenDone_:function(){this.isReady=!0;return f.resolve(!0)},handleDriveError_:function(a){switch(m.getErrorCode(a)){case X.FILE_NOT_FOUND:this.throwFileNotFoundException_();break;case X.INTERNAL_SERVER_ERROR:case X.OFFLINE:this.throwTemporaryUnableToOpenException_(a);
break;default:this.handleGenericFileError_(a)}},throwTemporaryUnableToOpenException_:function(a){throw new D({title:"temporary_unable_to_open_error_short_msg",details:"temporary_unable_to_open_error_msg",message:fa.isString(a)&&a||a.message||m.getErrorCode(a)});},handleGenericFileError_:function(a){if("SecurityError"===a.name)this.throwSecurityException_();else if(a instanceof B)this.throwTimeoutException_(a);else{if(a instanceof y)throw a;if(a instanceof x)throw a;if(a instanceof M)throw a;this.throwFileOpenCrashException_(a)}},
throwEntryPointException_:function(){throw new D({title:"entry_point_error_short_msg",details:"entry_point_error_msg"});},throwSecurityException_:function(){throw new D({title:"file_opened_in_incognito_mode_error_title",details:"file_opened_in_incognito_mode_error_details"});},throwTimeoutException_:function(a){a.title=w.getMessage("download_file_timeout_error_short_msg");a.details=w.getMessage("download_file_timeout_error_msg");throw a;},throwFileNotFoundException_:function(){throw new D({title:"file_not_found_error_short_msg",
details:"file_not_found_error_msg"});},throwFileOpenCrashException_:function(a){var c=new D({title:"file_open_crash_error_short_msg",details:"file_open_crash_error_msg",message:fa.isString(a)&&a||a.message||m.getErrorCode(a)});c.stack=a.stack;throw c;},cacheInfo_:function(){var a={originalURL:this.config_.originalURL,isDownloaded:this.config_.isDownloaded,streamURL:this.config_.streamURL,mimeType:this.config_.mimeType,extension:this.config_.extension,privateFilePath:this.privateFilePath(),downloadFilePath:this.downloadFilePath(),
downloadFileName:this.config_.downloadFileName,userFileId:this.config_.userFile&&window.RequestFileSystem&&l.chrome.retainEntry(this.config_.userFile),driveDocId:this.config_.driveDocId,newdocument:this.config_.newdocument,driveFileRole:this.config_.driveFileRole,title:this.config_.title,parents:this.config_.parents,isRenamed:this.config_.isRenamed,uuid:this.uuid_};this.cacheFileDetails(a)},restoreFileById_:function(a){return f.promise(function(c,f){window.RequestFileSystem?l.chrome.restoreEntry(a,
c):f(Error("NoAccessToFileSystem"))})},restorePrivateFile_:function(a){return this.getTempFs_().then(function(c){return a?this.openFileAndSaveEntry_(c,a,"privateFile"):this.createPrivateFile_()}.bind(this))},createDownloadableFile_:function(){return this.getTempFs_().then(function(a){return this.createDownloadableFileFromPrivateFile_(a)}.bind(this)).then(function(a){this.config_.downloadFile=a;this.config_.downloadFileName=this.displayName()}.bind(this))},restoreDownloadFile_:function(a){return this.getTempFs_().then(function(c){return a?
this.openFileAndSaveEntry_(c,a,"downloadFile"):this.createDownloadableFile_()}.bind(this))},download_:function(){v.show();var a=v.addContributor(.9);return(this.config_.driveDocId?t.download(this.config_.driveDocId,this.config_.driveDocResourceKey):void 0===this.config_.streamURL?f.reject(Error("FileManager needs URL to download")):(new h({baseUrl:this.config_.streamURL})).send()).then(function(a){return(new n(this.config_.privateFile)).writeData(a).then(function(){return a.arrayBuffer()})}.bind(this)).then(function(a){return this.sendMessageToWorker({type:2,
fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this),void 0,a).then(function(){this.config_.isDownloaded=!0;this.cacheInfo_();a(1);v.hide()}.bind(this))},selectFile_:function(a,c){return f.promise(function(f,h){l.native.chooseEntry(a,c,function(a,c){a?h(a):l.native.getDisplayPath(c,function(a){c.localFilePath=a;c.fullPath=a;f(c)})}.bind(this))}.bind(this))},getTempFs_:function(){return f.promise(function(a,c){window.webkitRequestFileSystem(window.TEMPORARY,1048576,a,c)})},getFileFromFs_:function(a,
c,h){return f.promise(function(f,l){a.root.getFile(c,h,f,l)})},createFile_:function(a,c){return this.getFileFromFs_(a,c,{create:!0,exclusive:!1})},openFile_:function(a,c){return this.getFileFromFs_(a,c,{create:!1})},createDownloadableFileFromPrivateFile_:function(a){return f.promise(function(c,f){var h=this.config_.privateFile,l=h.name.split("."),l=[l[0],l[1]].join("_downloadable.");h.copyTo(a.root,l,c,f)}.bind(this))},deletePrivateFile_:function(a){return this.getTempFs_().then(function(c){return f.promise(function(f,
h){c.root.getFile(a,{create:!1},function(a){a.remove(f,h)})})})},createPrivateFile_:function(a){var f=a||c.mime2Extension(this.mimeType()),h=[P.generateUUID(),f].join(".");return this.getTempFs_().then(function(a,c,e){return this.createFile_(e,c)}.bind(this,a,h)).then(function(a,e){this.config_.privateFile=e;if(a)return Promise.resolve();var h=c.extension2App(f);return this.sendMessageToWorker({type:1,app:h,url:chrome.runtime.getURL("wasm/"+h+".js")})}.bind(this,a)).then(function(a,c){a&&this.sendMessageToWorker({type:2,
fileName:this.privateFilePath(),fileContent:new Uint8Array(0)});return this.config_.privateFile}.bind(this,a,h))},openFileAndSaveEntry_:function(a,c,f){return this.openFile_(a,c).then(function(a){return this.config_[f]=a}.bind(this))},copyFile_:function(a,c){function h(a,c){var e=new n(a);return"File"===c.constructor.name?e.writeData(c):f.reject("Cannot copy file: Source is not a File")}return void 0===c?f.reject(Error("Cannot copy file: Missing destination file")):c.isFile?void 0===a?f.reject(Error("Cannot copy file: Missing source file")):
a.file?this.getFileFromEntry_(a).then(h.bind(null,c)):h(c,a):f.reject("Cannot copy file: Destination is not a FileEntry/ a File")},uploadDriveFile_:function(a){var c=this.config_.driveDocId,f=this.config_.driveDocResourceKey;return this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(h){h=new Blob([h]);return t.upload(c,h,a,f)})},getFileFromEntry_:function(a){return f.promise(function(c,f){a.file?a.file(c):f(Error("Entry missing file function"))})},getPrivateFileFromEntry:function(){return this.getFileFromEntry_(this.config_.privateFile)},
openOriginalFile_:function(a){var f,h=this.getFileType_(),l=this.mimeType();l&&0!==l.length?(l=c.mime2App(l),Z.sendEvent({category:"file-type",action:h,label:l})):Z.sendEvent({category:"file-type",action:h,label:"QO"});switch(h){case "driveDoc":m.isValidDriveId(this.config_.driveDocId_)?f=this.getDriveDoc_().catch(this.handleDriveError_.bind(this)):this.throwFileNotFoundException_();break;case "stream":f=this.getStream_().catch(this.handleGenericFileError_.bind(this));break;case "userFile":f=this.getUserFile_().catch(this.handleGenericFileError_.bind(this));
break;case "newdocument":f=this.getNewDocument_(this.config_.newDocument).catch(this.handleGenericFileError_.bind(this));break;default:this.throwEntryPointException_(a)}return f.then(this.createDownloadableFile_.bind(this)).then(this.cacheInfo_.bind(this))}};var Ka={word:["docx"],sheet:["xlsx"],point:["pptx"]};return new Q});
define("qowtRoot/utils/errorUtils",[],function(){return{stripStack:function(f){var c="";if(f=f.stack?f.stack.split("\n"):void 0)for(var c=c+(f[0]+";"),h=1;h<f.length;h++){var a=f[h].match(/\s*at\s*(\S*)\s*(\S*):(\d+):(\d+)\)/);if(a){a.shift();var l=a[1].lastIndexOf("/");a[1]=-1!==l?a[1].substr(l+1):a[1];c+=a.join(":")+";"}}return c},errorInfo:function(f){var c;f&&(c=f.e,f.e_info&&f.e_info.category&&(c+="; Category: "+f.e_info.category));return c},errorCode:function(f){return f&&f.split(";",1)[0]},
category:function(f){a:{f=f.split(";");for(var c=1;c<f.length;c++){var h=f[c].split(":");if("Category"===h[0].trim()){f=h[1].trim();break a}}f=""}return f}}});
define("errorObservers/gaExceptionLogger",["qowtRoot/pubsub/pubsub","qowtRoot/utils/errorUtils","utils/analytics/googleAnalytics"],function(f,c,h){var a="idle";f.subscribe("qowt:init",function(){a="idle"});return function(f){if("idle"===a){var n={msg:c.stripStack(f)||f.message||f.name||"unknown error",fatal:f.fatal};console.log("GA logging as:",n);h.sendException(n);a=f.fatal?"fatal exception logged":a}}});define("errorObservers/hideUI",["ui/progressSpinner"],function(f){return function(){f.hide()}});
define("errorObservers/showQOWT",[],function(){return function(f){f.silent||(document.getElementById("sandbox").style.display="block")}});
define("utils/analytics/performanceMetrics",["utils/analytics/googleAnalytics"],function(f){function c(a){var c=0,h=function(){c<a.length&&(f.sendEvent(a[c]),c++,h())};h()}function h(){var c=[],f=a.state.FF;a.actions.forEach(function(h){var t=a.logs.find(function(a){return a.action===h});t&&c.push({id:"recordEvent",category:"performance-metrics",action:t.action,label:f,value:t.value})});return c}var a={logs:[],state:{DCPSize:0,FF:""},lastLog:{CR:null,CC:null},actions:["CR","CC"]};return{log:function(f){a.logs.push(f);
a.lastLog.hasOwnProperty(f.action)&&(a.lastLog[f.action]=f);Object.keys(f.label).forEach(function(c){a.state[c]+=f.label[c]});if("CC"===f.action){var n=h();c(n)}}}});
define("utils/fileHandleStore",[],function(){var f=null,c={addFile:function(c,f){return new Promise(function(h,t){var m={uuid:c,fileHandle:f,timestamp:Date.now()},m=a("readwrite").add(m);m.onsuccess=function(a){console.log("addFile","File added successfully.");h()};m.onerror=function(a){console.error("addFile","Error adding file: "+a.target.error);t()}})},queryPromiseResults:function(a,c,f){a&&(a.onsuccess=function(a){(a=a.target.result)?c(a):c()},a.onerror=function(a){f()})},getFile:function(l){return new Promise(function(n,
q){var t=a("readonly"),m;t?(m=t.index("uuidIndex").get(l),c.queryPromiseResults(m,n,q)):f||h().then(function(h){h?(f=h,t=a("readonly"),m=t.index("uuidIndex").get(l),c.queryPromiseResults(m,n,q)):n()})})},editFile:function(c){return new Promise(function(f,h){var t=a("readwrite"),m=t.index("uuidIndex").get(c);m.onsuccess=function(a){(a=a.target.result)?(a.timestamp=Date.now(),a=t.put(a),a.onsuccess=function(a){console.log("editFile","Data updated successfully:",a.target.result);f()},a.onerror=function(a){console.error("editFile",
"Error updating data:",a.target.error);h()}):(console.log("editFile","Data not found."),f())};m.onerror=function(a){console.error("editFile","Error querying data:",a.target.error);h()}})},cleanUp:function(){var c=a("readwrite"),f=Date.now();c.openCursor().onsuccess=function(a){if(a=a.target.result)console.log("cleanUp",a.value),a.value.timestamp<f-1E4&&(console.log("cleanUp","Data cleaned up"),a.delete()),a.continue()}}},h=function(){return new Promise(function(a,c){var f=indexedDB.open("qoDB",1);
f.onerror=function(a){console.log("createDB","onerror");console.error("Database error: "+a.target.errorCode);c()};f.onsuccess=function(c){console.log("createDB","onsuccess");a(c.target.result)};f.onupgradeneeded=function(a){console.log("createDB","onupgradeneeded");a.target.result.createObjectStore("fileHandleStore",{keyPath:"id",autoIncrement:!0}).createIndex("uuidIndex","uuid",{unique:!0})}})},a=function(a){if(f)var c=f.transaction(["fileHandleStore"],a).objectStore("fileHandleStore");return c};
h().then(function(a){f=a});return c});define("utils/sendUserFeedback",["qowtRoot/errors/errorCatcher","qowtRoot/utils/errorUtils"],function(f,c){var h=[];f.addObserver(function(a){var f=a.fatal?"FATAL: ":"NonFatal: ",f=f+(c.stripStack(a)||a.message||a.name||"unknown error");h.push(f)});return{openFeedbackUI:function(){chrome.feedbackPrivate&&chrome.feedbackPrivate.openFeedback(chrome.feedbackPrivate.FeedbackSource.QUICKOFFICE)}}});
define("utils/urlUtils",["qowtRoot/utils/typeUtils"],function(f){return{parseURL:function(c){if(!f.isString(c))throw Error("Invalid URI");var h=c.split("?");c=h[0];var h=1<h.length?h[1]:"",a=this.parseQueryString(h);return{baseURL:c,queryString:h,queryObject:a}},parseQueryString:function(c){if(!f.isString(c))throw Error("Invalid QueryString");var h;if(c){h={};c=c.split(/[&;]/g);for(var a=0;a<c.length;a++)if(c[a]){var l=c[a].split("="),n=decodeURIComponent(l[0]).toLowerCase(),l=1<l.length?decodeURIComponent(l[1]):
void 0;h[n]=l}}return h},stripQueryString:function(){var c=this.parseURL(window.location.href);window.history.replaceState({},"",c.baseURL)}}});
define("qowtRoot/utils/chromeStorageManager",["qowtRoot/utils/localStorageManager"],function(f){return{setItem:function(c,f){return new Promise(function(a,l){var n={};n[c]=f;chrome.storage.local.set(n,function(){chrome.runtime.lastError?l(chrome.runtime.lastError):a()})})},getItem:function(c){return new Promise(function(h,a){chrome.storage.local.get(c,function(l){if(chrome.runtime.lastError)a(chrome.runtime.lastError);else if("undefined"===typeof l[c]){l=f.getItem(c);if("undefined"!==typeof l){var n=
{};n[c]=l;chrome.storage.local.set(n,function(){})}h(l)}else h(l[c])})})},isOfficeEditingModeSet:function(){return new Promise(function(c,f){this.getItem("always_use_office_editing_mode").then(function(a){c(a?!0:!1)}).catch(function(a){console.warn(a);c(!1)})}.bind(this))},setOfficeEditingModeSetting:function(c){this.setItem("always_use_office_editing_mode",c)}}});
!function(f,c){function h(h,r,v){var P=[];r=1==r?{entropy:!0}:r||{};h=q(n(r.entropy?[h,m(f)]:null==h?t():h,3),P);var N=new a(P),P=function(){for(var a=N.g(K),c=D,f=0;a<x;)a=(a+f)*w,c*=w,f=N.g(1);for(;a>=y;)a/=2,c/=2,f>>>=1;return(a+f)/c};return P.int32=function(){return 0|N.g(4)},P.quick=function(){return N.g(4)/4294967296},P.double=P,q(m(N.S),f),(r.pass||v||function(a,f,h,m){return m&&(m.S&&l(m,N),a.state=function(){return l(N,{})}),h?(c[I]=a,f):a})(P,h,"global"in r?r.global:this==c,r.state)}function a(a){var c,
f=a.length,h=this,l=0,m=h.i=h.j=0,n=h.S=[];for(f||(a=[f++]);l<w;)n[l]=l++;for(l=0;l<w;l++)n[l]=n[m=B&m+a[l%f]+(c=n[l])],n[m]=c;(h.g=function(a){for(var c,f=0,l=h.i,m=h.j,n=h.S;a--;)c=n[l=B&l+1],f=f*w+n[B&(n[l]=n[m=B&m+c])+(n[m]=c)];return h.i=l,h.j=m,f})(w)}function l(a,c){return c.i=a.i,c.j=a.j,c.S=a.S.slice(),c}function n(a,c){var f,h=[],l=typeof a;if(c&&"object"==l)for(f in a)try{h.push(n(a[f],c-1))}catch(m){}return h.length?h:"string"==l?a:a+"\x00"}function q(a,c){for(var f,h=a+"",l=0;l<h.length;)c[B&
l]=B&(f^=19*c[B&l])+h.charCodeAt(l++);return m(c)}function t(){try{var a;return v&&(a=v.randomBytes)?a=a(w):(a=new Uint8Array(w),(r.crypto||r.msCrypto).getRandomValues(a)),m(a)}catch(c){return a=r.navigator,[+new Date,r,a&&a.plugins,r.screen,m(f)]}}function m(a){return String.fromCharCode.apply(0,a)}var v,r=this,w=256,K=6,I="random",D=c.pow(w,K),x=c.pow(2,52),y=2*x,B=w-1;if(c["seed"+I]=h,q(c.random(),f),"object"==typeof module&&module.exports){module.exports=h;try{v=require("crypto")}catch(M){}}else"function"==
typeof define&&define.amd&&define("third_party/seedrandom/seedrandom.min",[],function(){return h})}([],Math);define("utils/timeUtils",[],function(){return{DAY_IN_MS:864E5,WEEK_IN_MS:6048E5,weekSinceEpoch:function(){var f=Date.now()/this.WEEK_IN_MS;return Math.ceil(f)}}});
define("common/elements/google-consumer-survey/google-consumer-survey",["qowtRoot/utils/localStorageManager","qowtRoot/utils/uuid","third_party/seedrandom/seedrandom.min","utils/timeUtils"],function(f,c,h,a){var l=90*a.DAY_IN_MS;window.GoogleConsumerSurvey=Polymer({is:"google-consumer-survey",properties:{siteId:{reflect:!1,value:""},targetPercentage:{reflect:!1,value:void 0},bucketing:{reflect:!1,value:void 0}},created:function(){this.UUID=f.getItem("__GCS_uuid")||c.generateUUID();f.setItem("__GCS_uuid",
this.UUID);window._402=window._402||{};window._402.promptHandlerUrl="https://www.google.com/insights/consumersurveys/gk/prompt"},attached:function(){this.shouldLaunchSurvey_()&&this.launchSurvey_()},shouldLaunchSurvey_:function(){var c=!1;this.targetPercentage||this.bucketing?this.surveyResultsStale_(a.WEEK_IN_MS)&&(c=this.sampleUser_()):c=this.surveyResultsStale_(l);return c},sampleUser_:function(){var c=!1,f=parseInt(this.UUID.split("-")[1],16),l=this.bucketing?65535/this.bucketing:65535,m=a.weekSinceEpoch(),
v=m%(this.bucketing||1)*l;f>=v&&f<v+l&&(this.fire("user-considered-for-sampling"),h(f*m)()<(void 0===this.targetPercentage?1:this.targetPercentage/100)&&(this.fire("user-sampled-for-survey"),c=!0));return c},surveyResultsStale_:function(a){var c=!0,h=f.getItem("__GCS_site_"+this.siteId);h&&(c=Date.now()-h>a);return c},launchSurvey_:function(){this.siteId&&0!==this.siteId.length&&this.parentNode?fetch("https://www.google.com/insights/consumersurveys/async_survey?force_http=1&site="+this.siteId).then(function(a){if(!a.ok)throw Error("Network response was not ok");
return a.json()}).then(function(a){this.userSurveyed=!0;f.setItem("__GCS_site_"+this.siteId,Date.now())}.bind(this)).catch(function(a){console.error("Error fetching survey data:",a)}):console.warn("<google-consumer-survey>: missing siteId!")}});return{}});
define("monkeyLoader",["qowtRoot/features/utils"],function(f){function c(a,c,f){c([a],function(a){h++;f(a)},function(c){0===h?(console.warn("Failed to load "+a+". The monkey server is likely not running."),f()):(console.error("Monkey _is_ running, but we failed to laod module "+a+"."),console.error(c),console.error(c.stack))})}var h=0;return{load:function(a,h,n){h=h||"";f.isDebug()?(console.log("Loading "+a),c.apply(this,arguments)):n()}}});
define("controllers/application","qowtRoot/errors/errorCatcher qowtRoot/errors/qowtException qowtRoot/errors/unique/fileDoesNotExistError qowtRoot/utils/typeUtils qowtRoot/utils/tryUtils qowtRoot/utils/promiseUtils qowtRoot/utils/platform qowtRoot/messageBus/messageBus qowtRoot/features/utils controllers/appState controllers/fileManager errorObservers/gaExceptionLogger errorObservers/hideUI errorObservers/showQOWT utils/analytics/performanceMetrics utils/analytics/googleAnalytics utils/converter utils/fileEntry utils/fileHandleStore utils/metrics utils/sendUserFeedback utils/gdrive/driveUtils utils/urlUtils qowtRoot/third_party/when/when utils/gdrive/drive qowtRoot/utils/uuid qowtRoot/pubsub/pubsub qowtRoot/utils/localStorageManager qowtRoot/utils/chromeStorageManager common/elements/google-consumer-survey/google-consumer-survey".split(" "),function(f,
c,h,a,l,n,q,t,m,v,r,w,K,I,D,x,y,B,M,fa,X,P,N,Z,T,R,H,U,pa){function Q(){Ta.app=y.mime2App(r.mimeType());var a=y.mime2Extension(r.mimeType()),c=!("docm"!==a&&"pptm"!==a&&"xlsm"!==a);r.getPrivateFileFromEntry().then(function(e){t.pushMessage({id:"openFile",displayName:r.displayName(),originalURL:r.originalURL(),userFileType:Ea(),entryPoint:r.getEntryPoint(),driveFileReadOnly:"reader"===r.driveFileRole(),format:y.mime2Format(r.mimeType()),isRenamed:r.getCache().isRenamed,environment:Ta,isMacroEnabledFile:c,
newDocument:r.isNewDocument(),embedded:r.isEmbedded(),isIncognito:xa,extension:a,fileSize:e.size})})}function Ka(c){if(!a.isString(c)&&!a.isObject(c))throw Error("Invlid content from Core");if(a.isString(c))c=l.withWarning("JSON Syntax error in content from Core").rethrow(JSON.parse.bind(JSON,c)),"NaClCrash"===c.name&&(ya=!0);else if(ya){var e=c;console.error("reporting minidump to local server");var f=new FormData;f.append("prod","Quickoffice");f.append("ver",chrome.runtime.getManifest().version);
f.append("upload_file_minidump",new Blob([e]));e=new XMLHttpRequest;e.open("POST",chrome.runtime.getManifest().crash_dump_server,!0);e.send(f);H.publish("app:naclCrash")}ya||t.pushMessage({id:"dcp",content:c})}function e(a){if(a.keyCode&&(a.metaKey||a.ctrlKey))switch(a.keyCode){case 80:a.preventDefault();t.pushMessage({id:"print"});break;case 83:a.preventDefault()}}function ja(){kb(Za);qa({category:"network-status",action:window.navigator.onLine?"online":"offline"});return Z.promise(function(a){chrome.identity.getProfileUserInfo(function(c){c=
""!==c.email;var e=window.navigator.onLine;qa({category:"account-status",action:c?"signed-in":"signed-out"});qa({category:"account-network",action:c?e?"signedin-online":"signedin-offline":e?"signedout-online":"signedout-offline"});a()}.bind(this))}.bind(this)).timeout(3E3,"Timed-out waiting for identity info").catch(function(){})}function qa(a){window.navigator.onLine?x.sendEvent(a):"file-open"===a.category?za(jb,a):za(Za,a)}function za(a,c){var e=Ua(a);e.push(c);U.setItem(a,JSON.stringify(e))}function kb(a){if(window.navigator.onLine){var c=
Ua(a);if(0<c.length)for(var e=0;e<c.length;e++)c[e]&&"object"===typeof c[e]&&x.sendEvent({category:c[e].category,action:c[e].action,label:c[e].label});U.setItem(a,JSON.stringify([]))}}function Ua(a){var c;try{c=U.getItem(a),c=JSON.parse(c),Array.isArray(c)||(c=[])}catch(e){c=[],console.warn("Failed to initialize file store so resetting it to be empty: "+e)}return c}function Fa(){window.navigator.connection.onchange=function(a){window.navigator.onLine&&0<Ua(jb).length&&"opening"!==qowtState&&kb(jb)}}
function lb(){return new Promise(function(a,c){chrome&&chrome.tabs&&chrome.tabs.get?chrome.tabs.get(Ia,function(e){e?(xa=e.incognito,a()):c(Error("Missing tab for tabId "+Ia))}):c(Error("Missing chrome.tabs API"))})}function $a(){var a=Z.defer();Cb().then(function(c){Ia=c.tabId;a.resolve()},function(){chrome&&chrome.tabs&&chrome.tabs.getCurrent?chrome.tabs.getCurrent(function(c){c&&c.id?(Ia=c.id,a.resolve()):a.reject(Error("Missing tab id"))}):a.reject(Error("Missing chrome.tabs API"))});return Promise.race([a.promise,
n.delayThenReject(3E4,Error("Requesting current tab id timed out"))])}function pc(){t.listen(jd,Pb);t.listen(Bb,vd);return Promise.resolve()}function Cb(){null===oa&&(oa=new Promise(function(a,c){chrome.mimeHandlerPrivate.getStreamInfo(function(e){chrome.runtime.lastError?c(chrome.runtime.lastError):a(e)})}));return oa}function p(a,e){return Zc().then(function(f){return f?a(f):e(new c("File not found."))},function(a){return e(new c("File not found."))})}function wb(){return new Promise(function(a,
c){return qd().then(function(e){e&&M&&M.getFile(e).then(function(c){if(c)Y=new B(c.fileHandle,e),c.fileHandle.getFile().then(function(c){return a(e)},function(f){chrome.runtime.sendMessage({type:"getFileDetails",uuid:e},function(a){var c;a.driveDocId?c="double-tap":a.streamURL?c="stream":a.userFile?c="drag-n-drop":a.newDocument&&(c="new-document");x.sendEvent({category:"file-reopen",action:c})});var h=document.getElementById("reloadBlock");h&&(h.style.display="block",document.getElementById("reload-button").onclick=
function(){var f={};c.fileHandle&&(f.mode="readwrite");c.fileHandle.requestPermission(f).then(function(c){if("granted"===c)return h.style.display="none",a(e);window.close()},function(a){return!1})})});else return a(e)});if(!e)return p(a,c)},function(e){return p(a,c)})})}function Zc(){return gd().then(function(){if(Y&&Y.uuid)return r.cacheFileDetails({uuid:Y.uuid}),Y.uuid})}function qd(){return Promise.all([Cb()]).then(function(a){var c=r.getCache(),e=a[0];if(c&&c.originalURL===e.originalUrl)throw chrome.mimeHandlerPrivate.abortStream(),
Error("Load from cache");return new Promise(function(c,e){chrome.runtime.sendMessage({type:"registerMimeHandlerStream",streamInfo:JSON.stringify(a[0])},function(a){a&&a.uuid?c(a.uuid):e()})})}).catch(function(){var a=N.parseURL(window.location.href);a.queryObject?(r.cacheFileDetails(a.queryObject),N.stripQueryString()):a.queryObject=r.getCache();if(a.queryObject.state)return rd(a.queryObject.state);if(a.queryObject.uuid)return a.queryObject.uuid})}function rd(a){return new Promise(function(e,f){var h=
JSON.parse(a);chrome.runtime.sendMessage({type:"handleDriveDoc",docIds:h.ids,resourceKeys:h.resourceKeys},function(a){try{T.setUserId(h.userId),e(a.uuid)}catch(l){f(new c({title:"something_not_right",details:"file_not_found_error_msg"}))}})})}function sd(e){return new Promise(function(f,g){W=e[1];a.isString(W)||g(Error("Failed to get a valid UUID"));chrome.runtime.sendMessage({type:"getFileDetails",uuid:W},function(a){a||g(new c("Missing FileDetails object"));return!a.userFile&&!a.userFile&&Y&&Y.entry.name&&
W&&q.isCros?(a=[{entry:{name:Y.entry.name,fullPath:null,isDirectory:!1,isFile:!0,filesystem:null},type:kc(Y.entry.name)}],chrome.runtime.sendMessage({type:"addfileStoreMissingEntry",fileEntries:JSON.stringify(a),uuid:W},function(a){chrome.runtime.sendMessage({type:"getFileDetails",uuid:W},function(a){return Qb(f,g,W,Y,a)})})):Qb(f,g,W,Y,a)})})}function Qb(a,c,e,f,h){h=Object.create(h);window.copyToPrivateFile=r.copyToPrivateFile.bind(r);r.init(h,e,f).then(Ab).then(function(){return a()}).catch(function(a){return c(a)})}
function Pb(a){var c=!1;a&&a.data&&"dcpRequest"===a.data.id&&(c=!0);return c}function vd(a){return!Pb(a)}function md(){pa.getItem("onboardingComplete").then(function(a){var c=chrome.i18n.getMessage("@@ui_locale");a&&c.match(/en[-_]us/i)&&!m.isDebug()&&m.isEnabled("hats")&&window.setTimeout(function(){var a={word:{siteId:"wtkwz5qvgh3olklj43wihw3lhi",rate:3},sheet:{siteId:"renjicjirwkihjol6bv5k5q7hm",rate:8},point:{siteId:"4jgyc2mhqmpdwpatxatmggghiq",rate:4}},c=y.mime2App(r.mimeType());if(a[c]){var e=
id();e.siteId=a[c].siteId;e.targetPercentage=a[c].rate;e.bucketing=12;document.body.appendChild(e)}},3E3)}).catch(function(a){console.warn("Error occurred while fetching the item `onboardingComplete` from the Chrome storage"+a)})}function id(){var a=document.createElement("google-consumer-survey");a.addEventListener("user-considered-for-sampling",function(){x.sendEvent({category:"user-survey",action:"sampling",label:"user-consired"})});a.addEventListener("user-sampled-for-survey",function(){x.sendEvent({category:"user-survey",
action:"sampling",label:"user-sampled"})});return a}function jd(a){if(a&&a.data&&a.data.content)if(a=a.data.content,-1!=="writeToExisting writeToNew writeToExistingDriveFile convertToDocs makeACopy download".split(" ").indexOf(a.name))Nc(a);else{var c=Wc;switch(a.name){case "oPT":case "oDC":case "owb":a.pa=r.privateFilePath();c(a);break;case "sDC":"OOXML"===y.mime2Format(r.mimeType())?c(a):r.createPrivateFile("docx").done(nc.bind(C,a,c));break;case "saveWkbk":"OOXML"===y.mime2Format(r.mimeType())?
vb(a,c):r.createPrivateFile("xlsx").done(vb.bind(C,a,c));break;case "sPT":"OOXML"===y.mime2Format(r.mimeType())?vb(a,c):r.createPrivateFile("pptx").done(vb.bind(C,a,c));break;default:c(a)}}else throw Error("DCP Requests must have content");}function nc(a,c){a.name="saveAs";a.dst=r.privateFilePath();c(a)}function vb(a,c){a.dst=r.privateFilePath();c(a)}function Nc(a){switch(a.name){case "writeToExisting":r.overwriteUserFile().then(xb.bind(C,a.name,r.userFilePath()),Ha.bind(C,a.name));break;case "writeToNew":r.newUserFile(!1,
a.context&&a.context.toLocal).then(xb.bind(C,a.name,r.userFilePath()),ud.bind(C,a.name)).done(function(){},Ha.bind(C,a.name));break;case "makeACopy":Ha(a.name);r.newUserFile(!0).done(nd.bind(C,r.userFilePath()),Yc);break;case "writeToExistingDriveFile":Ha(a.name);r.overwriteUserFile(a.newRevision).finally(td.bind(C,a.token),Oc.bind(C,a.token));break;case "convertToDocs":Ha(a.name);r.convertToDocs().done(od,gc);break;case "download":Ya&&(chrome.downloads.onDeterminingFilename.addListener(function g(a,
c){c({filename:r.tryAndGetDownloadFileName(),conflictAction:"uniquify"});chrome.downloads.onDeterminingFilename.removeListener(g);Ya=!0}),Ya=!1,r.downloadToLocalFile());Ha(a.name);break;default:console.log("#!#! Unexpected processAppRequest "+a.name)}}function hc(a){return Z.promise(function(c){Mb(oc(a),c)})}function Nb(a){return Z.promise(function(c){var e=oc(a);chrome&&chrome.tabs&&e&&chrome.tabs.update(Ia,{url:e},c)})}function oc(a){var c,e=a.result?a.result.alternateLink:void 0,f=y.extension2Format(a.result?
a.result.fileExtension:void 0);if(e&&!e.match(/.*\/file\/.*/)&&!f)c=e,c=(a=c.match(/(.*)\?(.*)/))?a[2]&&0<a[2].length?c+"&nativeconvert=1":c+"nativeconvert=1":c+"?nativeconvert=1";else if(!e||e.match(/.*\/file\/.*/)||f)c="chrome-extension://"+chrome.runtime.id+'/views/app.html?state={"ids":["'+a.result.id+'"],"action":"open"}';return c}function xb(a,c,e){r.userFilePath()!==c&&Va();"writeToNew"===a&&"drive"===Ea()?Nb(e).then(Ha.bind(C,a)):Ha(a);t.pushMessage({id:"userFileNotification",context:{type:"saveSuccess",
format:y.mime2Format(r.mimeType()),userFileType:Ea(),isRenamed:void 0,localFilePath:"local"===Ea()?e.localFilePath:"",driveFileReadOnly:"reader"===r.driveFileRole()}})}function ud(a){t.pushMessage({id:"dcp",content:{name:a,userCancelled:!0,format:y.mime2Format(r.mimeType()),userFileType:Ea(),driveFileReadOnly:"reader"===r.driveFileRole()}});t.pushMessage({id:"userFileNotification",context:{type:"saveCancel"}})}function td(a){t.pushMessage({id:"driveFileNotification",context:{type:"saveSuccess",saveToken:a}})}
function Oc(a,c){t.pushMessage({id:"driveFileNotification",context:{type:"saveFailure",saveToken:a,errorCode:P.getErrorCode(c)}})}function od(a){var c=Xa;t.pushMessage({id:"driveFileNotification",context:{type:"convertSuccess"}});Xa=!1;if(!c)return hc(a)}function gc(a){var c=Xa;Xa=!1;c||t.pushMessage({id:"recordEvent",category:"menu",action:"convertToDocsFailed"});t.pushMessage({id:"driveFileNotification",context:{type:"convertFailure",errorCode:P.getErrorCode(a)}})}function nd(a,c){"drive"===Ea()?
hc(c):(document.title=r.displayName(),r.userFilePath()!==a&&Va(),t.pushMessage({id:"localFileNotification",context:{type:"copySuccess",displayName:r.displayName(),format:y.mime2Format(r.mimeType()),userFileType:Ea(),driveFileReadOnly:!1}}))}function Yc(a){"drive"===Ea()&&(t.pushMessage({id:"recordEvent",category:"menu",action:"makeCopyFailed"}),t.pushMessage({id:"driveFileNotification",context:{type:"copyFailure",errorCode:P.getErrorCode(a)}}))}function Ha(a,c){document.title=r.displayName();t.pushMessage({id:"dcp",
content:{name:a,displayName:r.displayName(),format:y.mime2Format(r.mimeType()),userFileType:Ea(),driveFileReadOnly:"reader"===r.driveFileRole(),e:c&&c.message||c}})}function Wc(a){Ra=a.name;a=a instanceof ArrayBuffer?a:l.withWarning("Msg to Core must be JSON").rethrow(JSON.stringify.bind(JSON,a));r.getWorker().postMessage({type:4,buffer:a,command:Ra})}function Ea(){var a;r.userFilePath()?a="local":r.driveDocId()&&(a="drive");return a}function Bb(a){if(a&&a.data)switch(a.data.id){case "closeApp":window.close();
break;case "reportAnIssue":X.openFeedbackUI();break;case "showHelp":case "signIntoDrive":Mb(a.data.link);break;case "recordCount":fa.recordCount(a.data.context);break;case "stateChange":a=a.data.data;v.updateState(a.state,a.context);break;case "recordEvent":x.sendEvent(a.data);break;case "recordCachableEvent":qa(a.data);break;case "createNewTab":Mb(a.data.link);break;case "conversionCancelled":Xa=!0;break;case "reloadTab":if(Ia&&chrome&&chrome.tabs){chrome.tabs.reload(Ia);break}window.location.reload();
break;case "setBlockUnload":chrome.mimeHandlerPrivate&&chrome.mimeHandlerPrivate.setShowBeforeUnloadDialog&&chrome.mimeHandlerPrivate.setShowBeforeUnloadDialog(!!a.data.blockUnload);break;case "fileNotFound":r.updateConfigAndCache(!0);break;case "fileSaveSuccess":r.updateConfigAndCache();t.pushMessage({id:"updateFileInfo"});break;case "performanceMetrics":D.log(a.data)}}function Mb(a,c){chrome&&chrome.tabs&&a&&a.match(/^https?:\/\/|^file:\/\/|^mailto:/i)&&chrome.tabs.create({url:a},c)}function Ab(){ad();
na();Va();cd();bd();lb().then(function(){C.openFile()}).catch(function(){xa=!1;C.openFile()})}function pd(a){var c={"2K3":"doc ppt xls dot pot xlt".split(" "),"2K7":"docx pptx xlsx dotx potx xltx docm pptm xlsm".split(" "),CSV:["csv"]},e;Object.keys(c).every(function(f){return c[f].includes(a)?(e=f,!1):!0});return e}function ad(){r.getPrivateFileFromEntry().then(function(a){var c=y.mime2Extension(r.mimeType());D.log({category:"PERF_LOG",action:"SC",label:{FF:pd(c)},value:window.performance.now()});
x.sendEvent({id:"recordEvent",category:"raw-data",action:"ViewingFullContent",label:"fileSize_bytes",value:a.size});x.sendEvent({id:"recordEvent",category:"raw-data",action:"file-ready",label:c})})}function na(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cacheTabId",uuid:W,tabId:Ia},function(){a()})})}function Va(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cachePrivateFilePath",uuid:W,privatePath:r.privateFilePath()},function(){a()})})}function cd(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cacheDownloadFile",
uuid:W,downloadFilePath:r.downloadFilePath()},function(){a()})})}function bd(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cacheTimestamp",uuid:W},function(){a()})})}function kc(a){var c={csv:["text/csv"],doc:["application/msword","application/vnd.ms-word","application/vnd.msword","application/vnd.ces-quickword"],docm:["application/vnd.ms-word.document.macroenabled.12","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.document.12"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document",
"application/vnd.wordprocessing-openxml"],dot:["application/msword","application/msword-template"],dotm:["application/vnd.ms-word.template.macroenabled.12"],dotx:["application/vnd.openxmlformats-officedocument.wordprocessingml.template"],pot:["application/mspowerpoint","application/mspowerpoint-template"],potm:["application/vnd.ms-powerpoint.template.macroenabled.12"],potx:["application/vnd.openxmlformats-officedocument.presentationml.template"],ppt:["application/mspowerpoint","application/vnd.ms-powerpoint",
"application/vnd.ces-quickpoint"],pptm:["application/vnd.ms-powerpoint.presentation.macroenabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],pptx:["application/vnd.presentation-openxml","application/vnd.presentation-openxmlm","application/vnd.openxmlformats-officedocument.presentationml.presentation"],xls:["application/msexcel","application/vnd.ms-excel","application/vnd.ces-quicksheet"],xlsm:["application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.ms-excel.sheet.macroEnabled.12"],
xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.spreadsheet-openxml"],xlt:["application/msexcel","application/msexcel-template"],xltm:["application/vnd.ms-excel.template.macroenabled.12"],xltx:["application/vnd.openxmlformats-officedocument.spreadsheetml.template"]};a=a.split(".")[1].toLowerCase();if(c[a]&&c[a].length)return c[a][0];throw Error("ext not supported");}function gd(){return new Promise(function(a,c){var e=!1;if("launchQueue"in window){var f=
window.performance.now();launchQueue.setConsumer(function(h){e=!0;var l=window.performance.now()-f;if(h.files.length){var m=h.files[0];return m.getFile().then(function(c){x.sendEvent({category:"setConsumer-callback",action:"setConsumer-success",label:l+"ms",value:l});c=[{entry:{name:c.name,fullPath:null,isDirectory:!1,isFile:!0,filesystem:null},type:c.type?c.type:kc(c.name)}];return chrome.runtime.sendMessage({type:"fileHandler",fileEntries:JSON.stringify(c)},function(c){M.addFile(c.uuid,m);Y=new B(m,
c.uuid);return a()})})}console.error("application","files not available in launchParams");x.sendEvent({category:"setConsumer-callback",action:"setConsumer-reject",label:l+"ms",value:l});return c("File not found")})}else return e=!0,a();setTimeout(function(){e||x.sendEvent({category:"timeout-error",action:"fileNotFoundAfter10Seconds"})},1E4);setTimeout(function(){e||x.sendEvent({category:"timeout-error",action:"fileNotFoundAfter60Seconds"})},6E4)})}var C={openFile:function(){if(!r.isReady)throw Error("Error: app not ready to open file yet");
v.updateState("Opening");if(q.isCros){var a=window.navigator.onLine,c=a?"online":"offline",e=y.mime2Extension(r.mimeType()),f=Ua(jb);a&&0<f.length&&kb(jb);qa({category:"file-open",action:c,label:e})}document.title=r.displayName();if(a=y.mime2Icon(r.mimeType()))c=document.createElement("link"),c.type="image/x-icon",c.rel="shortcut icon",c.href=a,document.getElementsByTagName("head")[0].appendChild(c);ba&&t.pushMessage({id:ea,overrides:ba});Q()}},O,Ta,ya,ba,ea="featureOverrides",Za="pending_ga",jb=
"pending_app_ga",Ia,W,xa=!1,Xa=!1,Ya=!0,Ra="Invalid";new Worker("../scripts/controllers/fileReaperWorker.js");var Y,oa=null;(function(){chrome.runtime.onMessage.addListener(function(a,c,e){"reaperCheck"===a&&e({uuid:r.getUUID()})})})();(function(){try{ba={};var c=window.sessionStorage.getItem(ea),e=U.getItem(ea);e||(e='{"edit":true,"pointEdit":true}');a.extend(ba,JSON.parse(c));a.extend(ba,JSON.parse(e));0<Object.keys(ba).length&&m.setOverrides(ba)}catch(f){}})();require(["monkeyLoader!monkeyAppClient"],
function(){H.publish("qowt:doAction","START_PERFORMANCE_TEST");document.title="";O=document.getElementById("sandbox");window.connectFromAppToQowt=new Date;t.connect(O.contentWindow);window._handleWASMMessage=Ka;var a=R.generateUUID();x.setSessionGroup(a);Fa();v.init();Ta={locale:chrome.i18n.getMessage("@@ui_locale"),defaultLocale:"en"};window.addEventListener("keydown",e);f.addObserver(w);f.addObserver(K);f.addObserver(I);f.init();Z.all([ja(),wb(),$a(),pc()]).then(sd).then(md).done()});return C});
require(["third_party/domready/domReady!"],function(){require(["controllers/application"])});define("mainApp",function(){});
